
(function(){my={};my.Class=function(){var len=arguments.length;var body=arguments[len-1];var SuperClass=len>1?arguments[0]:null;var hasImplementClasses=len>2;var Class,SuperClassEmpty;if(body.constructor===Object){Class=function(){};}else{Class=body.constructor;delete body.constructor;}
if(SuperClass){SuperClassEmpty=function(){};SuperClassEmpty.prototype=SuperClass.prototype;Class.prototype=new SuperClassEmpty();Class.prototype.constructor=Class;Class.Super=SuperClass;extend(Class,SuperClass,false);}
if(hasImplementClasses)
for(var i=1;i<len-1;i++)
extend(Class.prototype,arguments[i].prototype,false);extendClass(Class,body);return Class;};var extendClass=my.extendClass=function(Class,extension,override){if(extension.STATIC){extend(Class,extension.STATIC,override);delete extension.STATIC;}
extend(Class.prototype,extension,override)};var extend=function(obj,extension,override){var prop;if(override===false){for(prop in extension)
if(!(prop in obj))
obj[prop]=extension[prop];}else{for(prop in extension)
obj[prop]=extension[prop];if(extension.toString!==Object.prototype.toString)
obj.toString=extension.toString;}};})();;(function(){if(window.define){define('querystring',querystring);}else{if(!window.Wikia)window.Wikia={};window.Wikia.Querystring=querystring();}
function isEmpty(o){for(var k in o)return false;return true;}
function querystring(){var l=window.location,p=Querystring.prototype,u;function Querystring(url){var srh,link,tmp,protocol,path='',hash,pos,cache={};if(url){tmp=url.split('//',2);protocol=tmp[1]?tmp[0]:'';tmp=(tmp[1]||tmp[0]).split('#');hash=tmp[1]||'';tmp=tmp[0].split('?');link=tmp[0];pos=link.indexOf('/');if(pos>-1){path=link.slice(pos);link=link.slice(0,pos);}
srh=tmp[1];}else{protocol=l.protocol;link=l.host;path=l.pathname;srh=l.search.substr(1);hash=l.hash.substr(1)}
if(srh){var tmpQuery=srh.split('&').filter(function(elm){if(elm)return true;});for(var i=0;i<tmpQuery.length;i++){tmp=tmpQuery[i].split('=');cache[tmp[0]]=decodeURIComponent(tmp[1])||'';}}
this.cache=cache;this.protocol=protocol;this.link=link;this.path=path;this.hash=hash;}
p.toString=function(){var ret=(this.protocol?this.protocol+'//':'')+this.link+this.path+(!isEmpty(this.cache)?'?':''),attr,val,tmpArr=[];for(attr in this.cache){val=this.cache[attr];tmpArr.push(attr+(val!=u?'='+val:''));}
return ret+tmpArr.join('&')+(this.hash?'#'+this.hash:'');};p.getVal=function(name,defVal){return this.cache[name]||defVal;};p.setVal=function(name,val){if(val!=u){this.cache[name]=encodeURIComponent(val);}else{delete this.cache[name];}};p.getHash=function(){return this.hash;};p.setHash=function(h){this.hash=h;};p.getPath=function(){return this.path;};p.setPath=function(p){this.path=p;};p.addCb=function(){this.setVal('cb',Math.ceil(Math.random()*10001));};p.goTo=function(){if(this.hash=='topbar'||this.hash=='Modal'){this.hash='';}
l.href=this.toString();};return Querystring;}})();;(function(){if(!window.Wikia)window.Wikia={};window.Wikia.Cookies=cookieCutter();if(window.define){define('cookies',function(){return window.Wikia.Cookies;});}
function cookieCutter(){var cookieReplaceRegEx1=/^\s*/,cookieReplaceRegEx2=/\s*$/,lastCookieContent,cookies;function fetchCookies(){var cookieString=document.cookie,pair,name,value,separated;if(lastCookieContent!=cookieString){cookies={};lastCookieContent=cookieString;separated=cookieString.split(';');for(var i=0,m=separated.length;i<m;i++){pair=separated[i].split('=');name=pair[0].replace(cookieReplaceRegEx1,'').replace(cookieReplaceRegEx2,'');value=decodeURIComponent(pair[1]);cookies[name]=value;}}
return cookies;}
return{get:function(name){var val=fetchCookies()[name];return(typeof val!=='undefined')?val:null;},set:function(name,value,options){var expDate,cookieString='',data=[];options=options||{};if(typeof value=='undefined'||value===null){value='';options.expires=-1;}
if(options.expires){if(typeof options.expires=='number'){expDate=new Date();expDate.setTime(expDate.getTime()+(options.expires));}else if(options.expires instanceof Date){expDate=options.expires;}
data.push('; expires='+expDate.toUTCString());}
options.path&&data.push('; path='+options.path);options.domain&&data.push('; path='+options.domain);options.secure&&data.push('; secure');cookieString=name+'='+encodeURIComponent(value);for(var x=0,y=data.length;x<y;x++){cookieString+=data[x];}
document.cookie=cookieString;return cookieString;}};}})();;(function(){if(!window.Wikia)window.Wikia={};window.Wikia.log=logger();if(window.define){define('log',function(){return window.Wikia.log;});}
function logger(){var levels={user:1,feedback:2,info:3,system:4,warning:5,error:6,debug:7,trace:8,trace_l2:9,trace_l3:10},outputLevel=0,groups={},groupsString='';groupsCount=0,enabled=false,levelsMap=[];for(var p in levels){var v=levels[p];if(v)
levelsMap[v]=p;}
function logMessage(msg,level,group){level=level||'trace';if(typeof level=='number'){if(level<1)
level=1;else if(level>levelsMap.length-1)
level=levelsMap.length-1;level=levelsMap[level];}
level=level.toLowerCase();levelID=levels[level];group=group||'Unknown source';if(!enabled||(typeof msg=="undefined")||(levelID>outputLevel)||(groupsCount>0&&!(group in groups)))
return false;printMessage(msg,level,group);return true;}
function printMessage(msg,level,group){if(typeof console!='undefined')
console.log((typeof msg!='object'?'%s [%s]: %s':'%s [%s]: %o'),group,level,msg);else if(typeof opera!='undefined')
opera.postError(group+': '+msg);}
function init(querystring,cookies){var qs=new querystring(),selectedGroups,x;outputLevel=qs.getVal('log_level')||cookies.get('log_level')||outputLevel;if(typeof outputLevel=='string'&&parseInt(outputLevel)!=outputLevel)
outputLevel=levels[outputLevel];selectedGroups=(qs.getVal('log_group')||cookies.get('log_group')||'').replace(' ','').replace('|',',').split(',');groupsString=selectedGroups.join(', ');for(x=0;x<selectedGroups.length;x++){var g=selectedGroups[x];if(g!==''){groups[g]='';groupsCount++;}}
if(outputLevel>0){printMessage('initialized at level '+levelsMap[outputLevel]+((groupsCount>0)?' for '+groupsString:''),'info','Wikia.log');enabled=true;}}
if(window.require){require(['querystring','cookies'],init);}else{init(Wikia.Querystring,Wikia.Cookies);}
return logMessage;}}());;(function(context){'use strict';function thumbnailer(){var extRegExp=new RegExp('\\.(jpg|jpeg|gif|bmp|png|svg)$','i'),imagePath='/images/',thumbPath='/images/thumb/';function isThumbUrl(url){return url&&url.indexOf('/thumb/')>0;}
function clearThumbOptions(url){return url.substring(0,url.lastIndexOf('/'));}
function switchPathTo(url,type){var from,to,thumb=(type==='thumb');if(thumb){from=imagePath;to=thumbPath;}else{from=thumbPath;to=imagePath;}
url=url.replace(from,to);return url;}
return{isThumbUrl:isThumbUrl,getThumbURL:function getThumbURL(url,type,width,height){url=url||'';height=height||0;width=(width||50)+(height?'':'px');if(isThumbUrl(url)){url=clearThumbOptions(url);}else{url=switchPathTo(url,'thumb');}
var tokens=url.split('/'),last=tokens.slice(-1)[0].replace(extRegExp,'');tokens.push(width+(height?'x'+height:'-')+((type=='video'||type=='nocrop')?'-':'x2-')+last+'.png');return tokens.join('/');},getImageURL:function getImageURL(url){if(isThumbUrl(url)){url=clearThumbOptions(url);url=switchPathTo(url,'image');}
return url;}};}
if(typeof define!=='undefined'&&define.amd){define('thumbnailer',thumbnailer);}else{if(!context.Wikia){context.Wikia={};}
context.Wikia.Thumbnailer=thumbnailer();}}(this));;(function(window,document,jQuery){var head=document.getElementsByTagName('head')[0],loadedCompleteRegExp=/loaded|complete/,callbacks={},callbacksNb=0,timer;jQuery.getCSS=function(url,options,callback){if(jQuery.isFunction(options)){callback=options;options={};}
var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.media=options.media||'screen';link.href=url;if(options.charset){link.charset=options.charset;}
if(options.title){callback=(function(callback){return function(){link.title=options.title;callback(link,"success");};})(callback);}
if(link.readyState){link.onreadystatechange=function(){if(loadedCompleteRegExp.test(link.readyState)){link.onreadystatechange=null;callback(link,"success");}};}else if(link.onload===null&&link.all){link.onload=function(){link.onload=null;callback(link,"success");};}else{callbacks[link.href]=function(){callback(link,"success");};if(!callbacksNb++){timer=window.setInterval(function(){var callback,stylesheet,stylesheets=document.styleSheets,href,i=stylesheets.length;while(i--){stylesheet=stylesheets[i];if((href=stylesheet.href)&&(callback=callbacks[href])){try{callback.r=stylesheet.cssRules;throw'SECURITY';}catch(e){if(/SECURITY/.test(e)||/SECURITY/i.test(e.name)){callback(link,"success");delete callbacks[href];if(!--callbacksNb){timer=window.clearInterval(timer);}}}}}},13);}}
head.appendChild(link);};})(this,this.document,this.jQuery);;var jaaulde=window.jaaulde||{};jaaulde.utils=jaaulde.utils||{};jaaulde.utils.cookies=(function()
{var cookies=[];var defaultOptions={hoursToLive:null,path:'/',domain:null,secure:false};var resolveOptions=function(options)
{var returnValue;if(typeof options!=='object'||options===null)
{returnValue=defaultOptions;}
else
{returnValue={hoursToLive:(typeof options.hoursToLive==='number'&&options.hoursToLive!==0?options.hoursToLive:defaultOptions.hoursToLive),path:(typeof options.path==='string'&&options.path!==''?options.path:defaultOptions.path),domain:(typeof options.domain==='string'&&options.domain!==''?options.domain:defaultOptions.domain),secure:(typeof options.secure==='boolean'&&options.secure?options.secure:defaultOptions.secure)};}
return returnValue;};var expiresGMTString=function(hoursToLive)
{var dateObject=new Date();dateObject.setTime(dateObject.getTime()+(hoursToLive*60*60*1000));return dateObject.toGMTString();};var assembleOptionsString=function(options)
{options=resolveOptions(options);return((typeof options.hoursToLive==='number'?'; expires='+expiresGMTString(options.hoursToLive):'')+'; path='+options.path+
(typeof options.domain==='string'?'; domain='+options.domain:'')+
(options.secure===true?'; secure':''));};var splitCookies=function()
{cookies={};var pair,name,value,separated=document.cookie.split(';');for(var i=0;i<separated.length;i=i+1)
{pair=separated[i].split('=');name=pair[0].replace(/^\s*/,'').replace(/\s*$/,'');value=decodeURIComponent(pair[1]);cookies[name]=value;}
return cookies;};var constructor=function(){};constructor.prototype.get=function(cookieName)
{var returnValue;splitCookies();if(typeof cookieName==='string')
{returnValue=(typeof cookies[cookieName]!=='undefined')?cookies[cookieName]:null;}
else if(typeof cookieName==='object'&&cookieName!==null)
{returnValue={};for(var item in cookieName)
{if(typeof cookies[cookieName[item]]!=='undefined')
{returnValue[cookieName[item]]=cookies[cookieName[item]];}
else
{returnValue[cookieName[item]]=null;}}}
else
{returnValue=cookies;}
return returnValue;};constructor.prototype.filter=function(cookieNameRegExp)
{var returnValue={};splitCookies();if(typeof cookieNameRegExp==='string')
{cookieNameRegExp=new RegExp(cookieNameRegExp);}
for(var cookieName in cookies)
{if(cookieName.match(cookieNameRegExp))
{returnValue[cookieName]=cookies[cookieName];}}
return returnValue;};constructor.prototype.set=function(cookieName,value,options)
{if(typeof value==='undefined'||value===null)
{if(typeof options!=='object'||options===null)
{options={};}
value='';options.hoursToLive=-8760;}
var optionsString=assembleOptionsString(options);document.cookie=cookieName+'='+encodeURIComponent(value)+optionsString;};constructor.prototype.del=function(cookieName,options)
{var allCookies={};if(typeof options!=='object'||options===null)
{options={};}
if(typeof cookieName==='boolean'&&cookieName===true)
{allCookies=this.get();}
else if(typeof cookieName==='string')
{allCookies[cookieName]=true;}
for(var name in allCookies)
{if(typeof name==='string'&&name!=='')
{this.set(name,null,options);}}};constructor.prototype.test=function()
{var returnValue=false,testName='cT',testValue='data';this.set(testName,testValue);if(this.get(testName)===testValue)
{this.del(testName);returnValue=true;}
return returnValue;};constructor.prototype.setOptions=function(options)
{if(typeof options!=='object')
{options=null;}
defaultOptions=resolveOptions(options);};return new constructor();})();(function()
{if(window.jQuery)
{(function($)
{$.cookies=jaaulde.utils.cookies;var extensions={cookify:function(options)
{return this.each(function()
{var i,resolvedName=false,resolvedValue=false,name='',value='',nameAttrs=['name','id'],nodeName,inputType;for(i in nameAttrs)
{if(!isNaN(i))
{name=$(this).attr(nameAttrs[i]);if(typeof name==='string'&&name!=='')
{resolvedName=true;break;}}}
if(resolvedName)
{nodeName=this.nodeName.toLowerCase();if(nodeName!=='input'&&nodeName!=='textarea'&&nodeName!=='select'&&nodeName!=='img')
{value=$(this).html();resolvedValue=true;}
else
{inputType=$(this).attr('type');if(typeof inputType==='string'&&inputType!=='')
{inputType=inputType.toLowerCase();}
if(inputType!=='radio'&&inputType!=='checkbox')
{value=$(this).val();resolvedValue=true;}}
if(resolvedValue)
{if(typeof value!=='string'||value==='')
{value=null;}
$.cookies.set(name,value,options);}}});},cookieFill:function()
{return this.each(function()
{var i,resolvedName=false,name='',value,nameAttrs=['name','id'],iteration=0,nodeName;for(i in nameAttrs)
{if(!isNaN(i))
{name=$(this).attr(nameAttrs[i]);if(typeof name==='string'&&name!=='')
{resolvedName=true;break;}}}
if(resolvedName)
{value=$.cookies.get(name);if(value!==null)
{nodeName=this.nodeName.toLowerCase();if(nodeName==='input'||nodeName==='textarea'||nodeName==='select')
{$(this).val(value);}
else
{$(this).html(value);}}}
iteration=0;});},cookieBind:function(options)
{return this.each(function()
{$(this).cookieFill().change(function()
{$(this).cookify(options);});});}};$.each(extensions,function(i)
{$.fn[i]=this;});})(window.jQuery);}})();;(function($){function distance(date){return(new Date().getTime()-date.getTime());}
function inWords(date){return $t.inWords(distance(date));}
function refresh(){var data=prepareData(this);if(!isNaN(data.datetime)){$(this).text(inWords(data.datetime));}
return this;}
function prepareData(element){element=$(element);if(!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());if(text.length>0){element.attr("title",text);}}
return element.data("timeago");}
$.timeago=function(timestamp){if(timestamp instanceof Date){return inWords(timestamp);}else if(typeof timestamp==="string"){return inWords($.timeago.parse(timestamp));}else{return inWords($.timeago.datetime(timestamp));}};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:60000,allowFuture:true,strings:window.wgTimeAgoi18n||{}},inWords:function(distanceMillis){var $l=this.settings.strings,isFuture=false;if(this.settings.allowFuture){if(distanceMillis<0){isFuture=true;}
distanceMillis=Math.abs(distanceMillis);}
var seconds=distanceMillis/1000;var minutes=seconds/60;var hours=minutes/60;var days=hours/24;var years=days/365;function substitute(key,number){var string=$l[isFuture?(key+'-from-now'):key]||'';return string.replace(/%d/i,number);}
var words=(seconds<45&&substitute('seconds',Math.round(seconds)))||(seconds<90&&substitute('minute',1))||(minutes<45&&substitute('minutes',Math.round(minutes)))||(minutes<90&&substitute('hour',1))||(hours<24&&substitute('hours',Math.round(hours)))||(hours<48&&substitute('day',1))||(days<30&&substitute('days',Math.floor(days)))||(days<60&&substitute('month',1))||(days<365&&substitute('months',Math.floor(days/30)))||(years<2&&substitute('year',1))||substitute('years',Math.floor(years));return words;},parse:function(iso8601){var s=$.trim(iso8601);s=s.replace(/\.\d\d\d+/,"");s=s.replace(/-/,"/").replace(/-/,"/");s=s.replace(/T/," ").replace(/Z/," UTC");s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(s);},datetime:function(elem){var node=$(elem);var isTime=node.get(0).tagName.toLowerCase()==="time";var iso8601=isTime?node.attr("datetime"):node.attr("title");return $t.parse(iso8601);}});$.fn.timeago=function(){var self=this;self.each(refresh);var $s=$t.settings;if($s.refreshMillis>0){setInterval(function(){self.each(refresh);},$s.refreshMillis);}
return self;};document.createElement("abbr");document.createElement("time");}(jQuery));;(function($){$.store=function(driver,serializers)
{var that=this;this.encoders=[];this.decoders=[];if(typeof driver=='string')
{if($.store.drivers[driver]){this.driver=$.store.drivers[driver];}
else{throw new Error('Unknown driver '+driver);}}
else if(typeof driver=='object')
{var invalidAPI=!$.isFunction(driver.init)||!$.isFunction(driver.get)||!$.isFunction(driver.set)||!$.isFunction(driver.del)||!$.isFunction(driver.flush);if(invalidAPI){throw new Error('The specified driver does not fulfill the API requirements');}
this.driver=driver;}
else
{$.each($.store.drivers,function()
{if(!$.isFunction(this.available)||!this.available()){return true;}
that.driver=this;if(that.driver.init()===false)
{that.driver=null;return true;}
return false;});}
if(!serializers){serializers=$.store.serializers;}
this.serializers={};$.each(serializers,function(key,serializer)
{if(!$.isFunction(this.init)){return true;}
that.serializers[key]=this;that.serializers[key].init(that.encoders,that.decoders);});};$.extend($.store.prototype,{get:function(key)
{var value=this.driver.get(key);return this.driver.encodes?value:this.unserialize(value);},set:function(key,value)
{this.driver.set(key,this.driver.encodes?value:this.serialize(value));},del:function(key)
{this.driver.del(key);},flush:function()
{this.driver.flush();},driver:undefined,serialize:function(value)
{var that=this;$.each(this.encoders,function()
{var serializer=that.serializers[this+""];if(!serializer||!serializer.encode){return true;}
try
{value=serializer.encode(value);}
catch(e){}});return value;},unserialize:function(value)
{var that=this;if(!value){return value;}
$.each(this.decoders,function()
{var serializer=that.serializers[this+""];if(!serializer||!serializer.decode){return true;}
value=serializer.decode(value);});return value;}});$.store.drivers={'localStorage':{ident:"$.store.drivers.localStorage",scope:'browser',available:function()
{try
{return!!window.localStorage;}
catch(e)
{return false;}},init:$.noop,get:function(key)
{return window.localStorage.getItem(key);},set:function(key,value)
{try{window.localStorage.setItem(key,value);}catch(error){}},del:function(key)
{window.localStorage.removeItem(key);},flush:function()
{window.localStorage.clear();}},'userData':{ident:"$.store.drivers.userData",element:null,nodeName:'userdatadriver',scope:'browser',initialized:false,available:function()
{try
{return!!(document.documentElement&&document.documentElement.addBehavior);}
catch(e)
{return false;}},init:function()
{if(this.initialized){return;}
try
{this.element=document.createElement(this.nodeName);document.documentElement.insertBefore(this.element,document.getElementsByTagName('title')[0]);this.element.addBehavior("#default#userData");this.initialized=true;}
catch(e)
{return false;}},get:function(key)
{this.element.load(this.nodeName);return this.element.getAttribute(key);},set:function(key,value)
{this.element.setAttribute(key,value);this.element.save(this.nodeName);},del:function(key)
{this.element.removeAttribute(key);this.element.save(this.nodeName);},flush:function()
{this.element.expires=(new Date()).toUTCString();this.element.save(this.nodeName);}},'windowName':{ident:"$.store.drivers.windowName",scope:'window',cache:{},encodes:true,available:function()
{return true;},init:function()
{this.load();},save:function()
{window.name=$.store.serializers.json.encode(this.cache);},load:function()
{try
{this.cache=$.store.serializers.json.decode(window.name+"");if(typeof this.cache!="object"){this.cache={};}}
catch(e)
{this.cache={};window.name="{}";}},get:function(key)
{return this.cache[key];},set:function(key,value)
{this.cache[key]=value;this.save();},del:function(key)
{try
{delete this.cache[key];}
catch(e)
{this.cache[key]=undefined;}
this.save();},flush:function()
{window.name="{}";}}};$.store.serializers={'json':{ident:"$.store.serializers.json",init:function(encoders,decoders)
{encoders.push("json");decoders.push("json");},encode:function(data){try{return JSON.stringify(data);}catch(e){return'';}},decode:function(data){try{return JSON.parse(data);}catch(e){return null;}}}};})(jQuery);$.storage=new $.store();;(function(window,undefined){'$:nomunge';var $=window.jQuery||window.Cowboy||(window.Cowboy={}),jq_throttle;$.throttle=jq_throttle=function(delay,no_trailing,callback,debounce_mode){var timeout_id,last_exec=0;if(typeof no_trailing!=='boolean'){debounce_mode=callback;callback=no_trailing;no_trailing=undefined;}
function wrapper(){var that=this,elapsed=+new Date()-last_exec,args=arguments;function exec(){last_exec=+new Date();callback.apply(that,args);};function clear(){timeout_id=undefined;};if(debounce_mode&&!timeout_id){exec();}
timeout_id&&clearTimeout(timeout_id);if(debounce_mode===undefined&&elapsed>delay){exec();}else if(no_trailing!==true){timeout_id=setTimeout(debounce_mode?clear:exec,debounce_mode===undefined?delay-elapsed:delay);}};if($.guid){wrapper.guid=callback.guid=callback.guid||$.guid++;}
return wrapper;};$.debounce=function(delay,at_begin,callback){return callback===undefined?jq_throttle(delay,at_begin,false):jq_throttle(delay,callback,at_begin!==false);};})(this);;jQuery.fn.placeholder=function(){var hasNativeSupport='placeholder'in document.createElement('input');return this.each(function(){if(hasNativeSupport){return;}
var input=$(this);var text=input.attr('placeholder');if(input.val()==''){input.addClass('placeholder').val(text);}
input.focus(function(){if(input.val()==text){input.val('');}
input.removeClass('placeholder');});input.blur(function(){if(input.val()==''){input.addClass('placeholder').val(text);}});input.closest('form').submit(function(){if(input.val()==text){input.val('');}});});};$(function(){$('input[placeholder], textarea[placeholder]').placeholder();});;if(typeof[].indexOf==='undefined'){Array.prototype.indexOf=function(val,fromIndex){fromIndex=fromIndex||0;for(var i=fromIndex,m=this.length;i<m;i++){if(this[i]===val){return i;}}
return-1;}}
if(typeof[].filter==='undefined'){Array.prototype.filter=function(fun,t){var len=this.length,res=[];for(var i=0;i<len;i++){if(fun.call(t,this[i],i,this))res[res.length]=this[i];}
return res;};};(function(window,$){$.getSassCommonURL=function(scssFilePath,params){return $.getSassURL(wgCdnRootUrl,scssFilePath,params);};$.getSassLocalURL=function(scssFilePath,params){return $.getSassURL(wgServer,scssFilePath,params);};$.getSassURL=function(rootURL,scssFilePath,params){return rootURL+wgAssetsManagerQuery.replace('%1$s','sass').replace('%2$s',scssFilePath).replace('%3$s',encodeURIComponent($.param(params||window.sassParams))).replace('%4$d',wgStyleVersion);};$.getSassLocalURL=function(scssFilePath,params){return wgAssetsManagerQuery.replace('%1$s','sass').replace('%2$s',scssFilePath).replace('%3$s',encodeURIComponent($.param(params||window.sassParams))).replace('%4$d',wgStyleVersion);};$.getAssetManagerGroupUrl=function(groups,params){if(typeof groups=='string'){groups=[groups];}
return wgAssetsManagerQuery.replace('%1$s','groups').replace('%2$s',groups.join(',')).replace('%3$s',params?encodeURIComponent($.param(params)):'-').replace('%4$d',wgStyleVersion);};$.ajaxSetup({cache:true});$.getScript=function(url,callback,failureFn){return $.ajax({type:"GET",url:url,success:function(xhr){if(typeof callback=='function'){try{callback();}
catch(e){eval(xhr);callback();$().log('eval() fallback applied for '+url,'getScript');}}},error:(typeof failureFn=='function'?failureFn:$.noop),dataType:'script'});};$.fn.log=function(msg,group){if(typeof console!='undefined'){if(group){console.log((typeof msg!='object'?'%s: %s':'%s: %o'),group,msg);}
else{console.log(msg);}}
return this;};$.fn.exists=function(){return this.length>0;};$.fn.getModal=function(url,id,options){$.get(url,function(html){$("body").append(html);if(typeof options=='object'&&typeof options.callbackBefore=='function'){options.callbackBefore();}
if(typeof id=='string'){$(id).makeModal(options);$().log('getModal: '+id+' modal made');}
if(typeof options=='object'&&typeof options.callback=='function'){options.callback();}});};$.showModal=function(title,content,options){options=(typeof options!='object')?{}:options;var header=$('<h1>').html(title),dialog=$('<div>').html(content).prepend(header).appendTo('body'),wrapper;if(typeof options.callbackBefore=='function'){options.callbackBefore();}
wrapper=dialog.makeModal(options);if(typeof options.callback=='function'){options.callback();}
return wrapper;};$.confirm=function(options){options=(typeof options!='object')?{}:options;options.id='WikiaConfirm';var html='<p>'+(options.content||'')+'</p>'+'<div class="neutral modalToolbar">'+'<button id="WikiaConfirmCancel" class="wikia-button secondary">'+(options.cancelMsg||'Cancel')+'</button>'+'<button id="WikiaConfirmOk" class="wikia-button">'+(options.okMsg||'Ok')+'</button>'+'</div>';var dialog=$('<div>').appendTo("body").html(html).attr('title',options.title||'');if(typeof options.callbackBefore=='function'){options.callbackBefore();}
$('#WikiaConfirmOk').click(function(){$('#WikiaConfirm').closeModal();if(typeof options.onOk=='function'){options.onOk();}});$('#WikiaConfirmCancel').click(function(){$('#WikiaConfirm').closeModal();});dialog.makeModal(options);if(typeof options.callback=='function'){options.callback();}};$.showCustomModal=function(title,content,options){options=(typeof options!='object')?{}:options;var buttons='';if(options.buttons){buttons=$('<div class="neutral modalToolbar"></div>');for(var buttonNo=0;buttonNo<options.buttons.length;buttonNo++){var button='<a id="'+options.buttons[buttonNo].id+'" class="wikia-button'+(options.buttons[buttonNo].defaultButton?'':' secondary')+'">'+options.buttons[buttonNo].message+'</a>';$(button).bind('click',options.buttons[buttonNo].handler).appendTo(buttons);}}
var dialog=$('<div>').html(content).attr('title',title).append(buttons);$("body").append(dialog);if(typeof options.callbackBefore=='function'){options.callbackBefore();}
var modal=dialog.makeModal(options);if(typeof options.callback=='function'){options.callback(modal);}
return modal;};$.postJSON=function(u,d,callback){return $.post(u,d,callback,"json");};$.extend({_urlVars:null,getUrlVars:function(){if($._urlVars===null){var hash,hashes=window.location.search.slice(window.location.search.indexOf('?')+1).split('&');$._urlVars={};for(var i=0,j=hashes.length;i<j;i++){hash=hashes[i].split('=');$._urlVars[hash[0]]=hash[1];}}
return $._urlVars;},getUrlVar:function(name){return $.getUrlVars()[name];}});$.fn.reverse=function(){return this.pushStack(this.get().reverse(),arguments);};$.fn.isChrome=function(){if($.browser.webkit&&!$.browser.opera&&!$.browser.msie&&!$.browser.mozilla){var userAgent=navigator.userAgent.toLowerCase();if(userAgent.indexOf("chrome")>-1){return true;}}
return false;};$.fn.isTouchscreen=function(){return('ontouchstart'in window);}
$.fn.hasParent=function(selector){return this.first().parent().closest(selector).exists();}
$.fn.startThrobbing=function(){this.append('<div class="wikiaThrobber"></div>');};$.fn.stopThrobbing=function(){this.find('.wikiaThrobber').remove();};$.thumbUrl2ThumbUrl=function(url,type,width,height){return Wikia.Thumbnailer.getThumbURL(url,type,width,height);}
$.htmlentities=function(s){return String(s).replace(/\&/g,'&'+'amp;').replace(/</g,'&'+'lt;').replace(/>/g,'&'+'gt;').replace(/\'/g,'&'+'apos;').replace(/\"/g,'&'+'quot;');};$.createClass=function(sc,o){var constructor=o.constructor;if(typeof constructor!='function'||constructor==Object.prototype.constructor){constructor=function(){sc.apply(this,arguments);};}
var bc=constructor;var f=function(){};f.prototype=sc.prototype||{};bc.prototype=new f();if(typeof o.statics=='object'){bc=$.extend(bc,o.statics);delete o.statics;}
for(var m in o){bc.prototype[m]=o[m];}
bc.prototype.constructor=bc;bc.superclass=sc.prototype;return bc;};$.proxyBind=function(fn,thisObject,baseArgs){return function(){var args=baseArgs.slice(0).concat(Array.prototype.call(arguments,0));return fn.apply(thisObject,args);}};var Observable=$.createClass(Object,{constructor:function(){Observable.superclass.constructor.apply(this,arguments);this.events={};},bind:function(e,cb,scope){if(typeof e=='object'){scope=cb;for(var i in e){if(i!=='scope'){this.bind(i,e[i],e.scope||scope);}}}else if($.isArray(cb)){for(var i=0;i<cb.length;i++){this.bind(e,cb[i],scope);}}else{scope=scope||this;this.events[e]=this.events[e]||[];this.events[e].push({fn:cb,scope:scope});}
return true;},unbind:function(e,cb,scope){if(typeof e=='object'){scope=cb;var ret=false;for(var i in e){if(i!=='scope'){ret=this.unbind(i,e[i],e.scope||scope)||ret;}}
return ret;}else if($.isArray(cb)){var ret=false;for(var i=0;i<cb.length;i++){ret=this.unbind(e,cb[i],scope)||ret;}
return ret;}else{if(!this.events[e]){return false;}
scope=scope||this;for(var i in this.events[e]){if(this.events[e][i].fn==cb&&this.events[e][i].scope==scope){delete this.events[e][i];return true;}}
return false;}},on:function(e,cb){this.bind.apply(this,arguments);},un:function(e,cb){this.unbind.apply(this,arguments);},relayEvents:function(o,e,te){te=te||e;o.bind(e,function(){var a=[te].concat(arguments);this.fire.apply(this,a);},this);},fire:function(e){var a=Array.prototype.slice.call(arguments,1);if(!this.events[e])
return true;var ee=this.events[e];for(var i=0;i<ee.length;i++){if(typeof ee[i].fn=='function'){var scope=ee[i].scope||this;if(ee[i].fn.apply(scope,a)===false){return false;}}}
return true;},proxy:function(func){return $.proxy(func,this);},debugEvents:function(list){var fns=list?list:['bind','unbind','fire','relayEvents'];for(var i=0;i<fns.length;i++){(function(fn){if(typeof this['nodebug-'+fn]=='undefined'){var f=this['nodebug-'+fn]=this[fn];this[fn]=function(){window.console&&console.log&&console.log(this,fn,arguments);return f.apply(this,arguments);}}}).call(this,fns[i]);}}});var GlobalTriggers=(function(){var GlobalTriggersClass=$.createClass(Observable,{fired:null,constructor:function(){GlobalTriggersClass.superclass.constructor.apply(this);this.fired={};},bind:function(e,cb,scope){GlobalTriggersClass.superclass.bind.apply(this,arguments);if(typeof e=='object'||$.isArray(cb)){return;}
if(typeof this.fired[e]!='undefined'){var a=this.fired[e].slice(0);setTimeout(function(){for(i=0;i<a.length;i++){cb.apply(scope||window,a[i]);}},10);}},fire:function(e){var a=Array.prototype.slice.call(arguments,1);this.fired[e]=this.fired[e]||[];this.fired[e].push(a);GlobalTriggersClass.superclass.fire.apply(this,arguments);}});return new GlobalTriggersClass();})();var Timer=$.createClass(Object,{callback:null,timeout:1000,timer:null,constructor:function(callback,timeout){this.callback=callback;this.timeout=(typeof timeout=='number')?timeout:this.timeout;},run:function(){this.callback.apply(window);},start:function(timeout){this.stop();timeout=(typeof timeout=='number')?timeout:this.timeout;this.timer=setTimeout(this.callback,timeout);},stop:function(){if(this.timer!=null){clearTimeout(this.timer);this.timer=null;}}});$.extend(Timer,{create:function(callback,timeout){var timer=new Timer(callback,timeout);return timer;},once:function(callback,timeout){var timer=Timer.create(callback,timeout);timer.start();return timer;}});$.openPopup=function(url,name,moduleName,width,height){if(wgUserName){window.open(url,name,'width='+width+',height='+height+',menubar=no,status=no,location=no,toolbar=no,scrollbars=no,resizable=yes');}
else{showComboAjaxForPlaceHolder(false,"",function(){AjaxLogin.doSuccess=function(){$('.modalWrapper').children().not('.close').not('.modalContent').not('h1').remove();$.nirvana.sendRequest({controller:moduleName,method:'AnonLoginSuccess',format:'html',type:'get',callback:function(html){$('.modalContent').html(html);}});}},false);}}
$(function(){if(typeof wgNow!='undefined'){var loadTime=(new Date()).getTime()-wgNow.getTime();$().log('DOM ready after '+loadTime+' ms',window.skin);}
if(window.beacon_id){$.cookies.set('wikia_beacon_id',window.beacon_id,{path:wgCookiePath,domain:wgCookieDomain});}
window.wgWikiaDOMReady=true;if(typeof $.fn.timeago!='undefined'){$('.timeago').timeago();}});var $window=$(window);$window.bind('load',function(){if(typeof wgNow!='undefined'){var loadTime=(new Date()).getTime()-wgNow.getTime();$().log('window onload after '+loadTime+' ms',window.skin);}});$window.on('scroll',$.debounce(100,function(event){$window.trigger('scrollstop',[event]);}));$.toJSON=JSON.stringify;$.evalJSON=$.secureEvalJSON=JSON.parse;window.GlobalTriggers=GlobalTriggers;window.Observable=Observable;window.Timer=Timer;})(window,jQuery);;(function($){$.nirvana={sendRequest:function(attr){var type=(typeof attr.type=='undefined')?'POST':attr.type.toUpperCase();var format=(typeof attr.format=='undefined')?'json':attr.format.toLowerCase();var data=(typeof attr.data=='undefined')?{}:attr.data;var callback=(typeof attr.callback=='undefined')?function(){}:attr.callback;var onErrorCallback=(typeof attr.onErrorCallback=='undefined')?function(){}:attr.onErrorCallback;if((typeof attr.controller=='undefined')||(typeof attr.method=='undefined')){throw"controller and method are required";}
if(!(format==='json'||format==='html'||format==='jsonp')){throw"Only Json,Jsonp and Html format are allowed";}
var url=(typeof attr.scriptPath=='undefined')?wgScriptPath:attr.scriptPath;return $.ajax({url:url+'/wikia.php?'+$.param({controller:attr.controller,method:attr.method,format:format}),dataType:format,type:type,data:data,success:callback,error:onErrorCallback});},getJson:function(controller,method,data,callback,onErrorCallback){return $.nirvana.ajaxJson(controller,method,data,callback,onErrorCallback,'GET');},postJson:function(controller,method,data,callback,onErrorCallback){return $.nirvana.ajaxJson(controller,method,data,callback,onErrorCallback,'POST');},ajaxJson:function(controller,method,data,callback,onErrorCallback,requestType){if(typeof data=='function'){callback=data;data={};}
return $.nirvana.sendRequest({controller:controller,method:method,data:data,type:requestType,format:'json',callback:callback,onErrorCallback:onErrorCallback});}};})(jQuery);;(function($,window){$.fn.carousel=function(options){var $this=$(this);var defaults={transitionSpeed:500,itemsShown:3,activeIndex:0,nextClass:"next",prevClass:"previous",attachBlindImages:false,itemClick:false,trackProgress:false,beforeMove:false,afterMove:false};options=$.extend(defaults,options);var dom={wrapper:$this,carousel:$this.find('.carousel'),items:$this.find('.carousel > li'),container:$this.children('div:first'),next:$this.siblings('.'+options.nextClass),previous:$this.siblings('.'+options.prevClass)};var constants={viewPortWidth:$this.outerWidth(),itemWidth:dom.items.first().outerWidth(true),carouselWidth:0,minLeft:0};var states={browsing:false,enable_next:false,enable_previous:false,currIndex:0,left:0};function nextImage(){if(states.browsing==false&&states.enable_next==true){states.browsing=true;moveToIndex(states.currIndex+options.itemsShown);}
return false;}
function previousImage(){if(states.browsing==false&&states.enable_previous==true){states.browsing=true;moveToIndex(states.currIndex-1);}
return false;}
function moveToIndex(idx){if(!isVisible(idx)){if(idx>(dom.items.length-options.itemsShown)){idx=dom.items.length-options.itemsShown;}
if(states.currIndex>idx){var leftmost=idx-options.itemsShown+1;if(leftmost<0){leftmost=0;}
idx=leftmost;}
var left=constants.itemWidth*idx*-1;states.currIndex=idx;doMove(left);}else{afterMove();}}
function doMove(left){states.left=left;if(typeof options.beforeMove=='function'){options.beforeMove();}
dom.carousel.animate({left:left},options.transitionSpeed,function(){states.browsing=false;afterMove();});}
function afterMove(){updateArrows();lazyLoadImages();if(typeof options.trackProgress=='function'){trackProgress(options.trackProgress);}
if(typeof options.afterMove=='function'){options.afterMove(states.currIndex+options.itemsShown);}}
function isVisible(idx){return idx>=states.currIndex&&idx<(states.currIndex+options.itemsShown);}
function setAsActive(idx){if(idx>-1){dom.items.removeClass('active');dom.items.eq(idx).addClass('active');moveToIndex(idx);}else{updateArrows();}}
function trackProgress(callback){var total=dom.items.length,idx1=Math.floor(states.currIndex)+1,idx2=Math.floor(states.currIndex)+(options.itemsShown>total?total:options.itemsShown);if(idx2>total){idx2=total;}
callback(idx1,idx2,total);}
function updateArrows(){if(dom.items.length<=options.itemsShown){disableNext();disablePrevious();return;}
var left=parseInt(dom.carousel.css('left'));if(isNaN(left)){left=0;}
if(left<constants.minLeft+constants.itemWidth/2){disableNext();enablePrevious();}else if(left==0){disablePrevious();enableNext();}else{enablePrevious();enableNext();}}
function lazyLoadImages(){var idx1=states.currIndex-options.itemsShown,idx2=states.currIndex,idx3=states.currIndex+options.itemsShown*2;idx1=idx1<0?0:idx1;var firstImages=dom.items.slice(idx2,idx3).find('img[data-src]'),lastImages=dom.items.slice(idx1,idx2).find('img[data-src]');doImageLoad(firstImages);doImageLoad(lastImages);}
function doImageLoad(images){images.each(function(){var image=$(this);image.attr('src',image.attr('data-src')).removeAttr('data-src');});}
function setCarouselWidth(){var width=constants.itemWidth*dom.items.length;dom.carousel.css('width',width);var minLeft=(width-constants.viewPortWidth)*-1;constants.carouselWidth=width;constants.minLeft=minLeft;}
function attachBlindImages(){if(dom.carousel.find('li').length==5){dom.carousel.append("<li class='blind'></li>");}
else if(dom.carousel.find('li').length==4){dom.carousel.append("<li class='blind'></li>");dom.carousel.append("<li class='blind'></li>");}
dom.carousel.find('li').first().addClass("first-image");dom.carousel.find('li').last().addClass("last-image");}
function disableNext(){states.enable_next=false;dom.next.addClass('disabled');}
function enableNext(){states.enable_next=true;dom.next.removeClass('disabled');}
function disablePrevious(){states.enable_previous=false;dom.previous.addClass('disabled');}
function enablePrevious(){states.enable_previous=true;dom.previous.removeClass('disabled');}
this.updateCarouselItems=function(){dom.items=dom.carousel.find('li');lazyLoadImages();};this.updateCarouselWidth=function(){setCarouselWidth();};this.updateCarouselArrows=function(){updateArrows();};return this.each(function(){if(typeof options.attachBlindImages=='function'){attachBlindImages();}
dom.next.click(nextImage);dom.previous.click(previousImage);setCarouselWidth();setAsActive(options.activeIndex);if(options.itemClick){dom.carousel.on('click','li',function(e){setAsActive($(this).index());options.itemClick.call(this,e);});}
lazyLoadImages();});}})(jQuery,this);;$.fn.extend({getModalTopOffset:function(){var top=Math.max((($(window).height()-this.outerHeight())/2),20);var opts=this.data('settings');if(opts&&typeof opts.topMaximum=="number"){top=Math.min(top,opts.topMaximum);}
return $(window).scrollTop()+top;},makeModal:function(options){var settings={showCloseButton:true,width:400,height:"auto",topOffset:50,escapeToClose:true};if(options){$.extend(settings,options);}
var ts=Math.round((new Date()).getTime()/1000),id=settings.id||($(this).attr('id')||ts)+'Wrapper',wrapper;if(skin=="oasis"){wrapper=$('<section>',{'class':'modalWrapper','id':id}).append($('<section>',{'class':'modalContent'}).append(this)).appendTo('body');}
else{this.wrap('<div class="modalWrapper" id="'+id+'"></div>');wrapper=this.closest(".modalWrapper");wrapper.appendTo('#positioned_elements');}
if(settings.className){wrapper.addClass(settings.className);}
var zIndex=settings.zIndex?parseInt(settings.zIndex):(2000000001+($('body').children('.blackout').length)*2);wrapper.data('settings',settings);if(!settings.noHeadline){var headline=wrapper.find("h1:first");if(headline.exists()){headline.remove();}else{headline=$('<h1>').html($(this).attr('title')||'');}
headline.prependTo(wrapper);}
if(skin=="oasis"){var modalTabs=wrapper.find('.modal-tabs');if(modalTabs.exists()){modalTabs.insertBefore(wrapper.find('.modalContent'));}
if(options.width!='auto'){var modalWidth=$("#WikiaMainContent").width();if(typeof options.width!='undefined'){modalWidth=options.width+30;}}else{modalWidth='auto';}
wrapper.css({left:"50%",top:$(window).scrollTop()+settings.topOffset,width:modalWidth,height:options.height,zIndex:zIndex+1}).css("margin-left",-wrapper.outerWidth()/2);}else{wrapper.width(settings.width).css({marginLeft:-wrapper.outerWidth()/2,top:wrapper.getModalTopOffset(),zIndex:zIndex+1}).fadeIn("fast");}
if(settings.showCloseButton){wrapper.prepend('<button class="close wikia-chiclet-button"><img src="'+stylepath+'/oasis/images/icon_close.png"></button>');}
wrapper.log('makeModal: #'+id);this.removeAttr('title');var persistent=(typeof settings.persistent=='boolean')?settings.persistent:false;var onClose=(typeof settings.onClose=='function')?settings.onClose:false;var closeOnBlackoutClick=(typeof settings.closeOnBlackoutClick=='boolean')?settings.closeOnBlackoutClick:true;wrapper.find('.close').bind("click",function(){var wrapper=$(this).closest('.modalWrapper');var settings=wrapper.data('settings');if(typeof settings.onClose=='function'){if(settings.onClose({click:1})==false){return;}}
if(persistent){wrapper.hideModal();}else{wrapper.closeModal();}});if(settings.escapeToClose){$(window).bind("keydown.modal"+id,function(event){if(event.keyCode==27){if(typeof settings.onClose=='function'){if(settings.onClose({keypress:1})==false){return;}}
if(persistent){wrapper.hideModal();}else{wrapper.closeModal();}
return false;}});}
$(window).bind("resize.modal",function(){if(window.skin=='oasis'){return;}
wrapper.css("top",wrapper.getModalTopOffset());$(".blackout:last").height($(document).height());});var blackoutOpacity=0.65;if(settings.blackoutOpacity){blackoutOpacity=settings.blackoutOpacity;}
var blackout=$('<div>').addClass('blackout').attr('data-opacity',blackoutOpacity);blackout.height($(document).height()).width($(document).width()).css({zIndex:zIndex}).fadeTo("fast",blackoutOpacity).bind("click",function(){if(!closeOnBlackoutClick){return;}
if(typeof settings.onClose=='function'){if(settings.onClose({click:1})==false){return;}}
if(persistent){wrapper.hideModal();}else{wrapper.closeModal();}});if(skin=="oasis"){blackout.appendTo("body");}else{blackout.appendTo("#positioned_elements");}
wrapper.data('blackout',blackout);if(typeof settings.onCreate=='function'){settings.onCreate(this,wrapper);}
if(window.loadAd){AdDriverDelayedLoader.load();window.loadAd=false;}
$(document.body).addClass('modalShown');return wrapper;},closeModal:function(){$(window).unbind(".modal"+this.attr('id'));this.animate({top:this.offset()["top"]+100,opacity:0},"fast",function(){$(this).remove();});var blackout=$(this).data('blackout');blackout.fadeOut("fast",function(){$(this).remove();});$(document.body).removeClass('modalShown');},hideModal:function(){var blackout=$(this).data('blackout');blackout.fadeOut("fast").addClass('blackoutHidden');this.animate({top:this.offset()["top"]+100,opacity:0},"fast",function(){$(this).hide();});$(document.body).removeClass('modalShown');},showModal:function(){var wrapper=this.closest(".modalWrapper");var zIndex=2000000001+($('body').children('.blackout').length)*2;var blackout=$(this).data('blackout');var blackoutOpacity=blackout.attr('data-opacity');if(!blackoutOpacity){blackoutOpacity=0.65;}
blackout.height($(document).height()).width($(document).width()).css({display:'block',opacity:blackoutOpacity,zIndex:zIndex}).removeClass('blackoutHidden');wrapper.css({top:wrapper.getModalTopOffset(),zIndex:zIndex+1,opacity:1,display:"block"}).log('showModal: #'+this.attr('id'));$(document.body).addClass('modalShown');},resizeModal:function(width){width=parseInt(width);var wrapper=this.closest(".modalWrapper");wrapper.width(width).css('marginLeft',-wrapper.outerWidth()>>1).log('resizeModal: #'+this.attr('id')+' resized to '+width+'px');},isModalShown:function(){return $(document.body).hasClass('modalShown');},getModalWrapper:function(){return $('.modalWrapper');}});;$.expiryStorage=new $.store();$.expiryStorage.get=function(key){var value=this.driver.get(key);if(!value){return;}
var data=this.driver.encodes?value:this.unserialize(value);value=null;var d=new Date();if(data.expires>=d.getTime()){value=data.value;}
else{this.del(key);}
return value;};$.expiryStorage.set=function(key,value,expires){var d;if(typeof expires=='number'){d=new Date();d.setTime(d.getTime()+(expires));}
else if(typeof expires=='object'&&expires.toUTCString){d=expires;}
else{throw'expires is not in a valid form';}
var data={value:value,expires:d.getTime()};this.driver.set(key,this.driver.encodes?data:this.serialize(data));};;(function($){var getResources=(function(){var rAssetManagerGroup=/__am\/\d+\/groups?\/.*\/(.*)$/,rAssetManagerGroupType=/(js|s?css)/,rExtension=/\.(js|s?css)$/;return function(resources,success,failure){var l,n,matches,remaining,dfd=new $.Deferred();var complete=function(){remaining--;if(remaining<1){if(typeof success=='function'){success();}
dfd.resolve();}};if(!$.isArray(resources)){resources=[resources];}
if(!(l=remaining=resources.length)){complete();}
for(n=0;n<l;n++){var resource=resources[n],type=typeof resource;if(type=='object'){if(resource.type&&resource.url){type=resource.type;resource=resource.url;}}else if(type=='string'){matches=resource.match(rAssetManagerGroup);matches=matches?matches[1].match(rAssetManagerGroupType):resource.match(rExtension);type=matches?matches[1]:'unknown';}
if(type=='js'){$.getScript(resource,complete,failure);}else if(type=='css'||type=='scss'){$.getCSS(resource,complete);}else if(type=='function'){resource.call($,complete);}else{dfd.reject({error:'Unknown type',resource:resource});}}
return dfd.promise();}}());$.getResources=$.getResource=getResources;})(jQuery);;$.loadLibrary=function(name,files,typeCheck,callback,failureFn){var dfd=new jQuery.Deferred();if(typeCheck==='undefined'){$().log('loading '+name,'loadLibrary');files=(typeof files=='string')?[files]:files;$.getResources(files,function(){$().log(name+' loaded','loadLibrary');if(typeof callback=='function'){callback();}},failureFn).then(function(){dfd.resolve();}).fail(function(){dfd.reject();});}
else{$().log(name+' already loaded','loadLibrary');if(typeof callback=='function'){callback();}
dfd.resolve();}
return dfd.promise();};$.loadYUI=function(callback){return mw.loader.use('wikia.yui').done(callback);};$.loadModalJS=function(callback){if(typeof callback==='function'){callback();}};$.loadJQueryUI=function(callback){return mw.loader.use('wikia.jquery.ui').done(callback);};$.loadJQueryAutocomplete=function(callback){return mw.loader.use('jquery.autocomplete').done(callback);};$.loadWikiaTooltip=function(callback){return $.loadLibrary('Wikia Tooltip',[stylepath+'/../resources/wikia/libraries/jquery/tooltip/jquery.wikia.tooltip.js',$.getSassCommonURL("skins/oasis/css/modules/WikiaTooltip.scss")],typeof jQuery.fn.wikiaTooltip,callback);};$.loadJQueryAIM=function(callback){return mw.loader.use('jquery.aim').done(callback);};$.loadMustache=function(callback){return mw.loader.use('jquery.mustache').done(callback);};$.loadGoogleMaps=function(callback){var dfd=new jQuery.Deferred(),onLoaded=function(){if(typeof callback==='function'){callback();}
dfd.resolve();};if(typeof(window.google&&window.google.maps)!='undefined'){onLoaded();}
else{window.onGoogleMapsLoaded=function(){delete window.onGoogleMapsLoaded;onLoaded();};$.loadLibrary('GoogleMaps','http://maps.googleapis.com/maps/api/js?sensor=false&callback=onGoogleMapsLoaded',typeof(window.google&&window.google.maps)).fail(function(){dfd.reject();});}
return dfd.promise();};$.loadFacebookAPI=function(callback){return $.loadLibrary('Facebook API',window.fbScript||'//connect.facebook.net/en_US/all.js',typeof window.FB,callback);};$.loadGooglePlusAPI=function(callback){return $.loadLibrary('Google Plus API','//apis.google.com/js/plusone.js',typeof(window.gapi&&window.gapi.plusone),callback);};$.loadTwitterAPI=function(callback){return $.loadLibrary('Twitter API','//platform.twitter.com/widgets.js',typeof(window.twttr&&window.twttr.widgets),callback);};;var WikiaWideTables={settings:{article:$("#WikiaArticle"),tables:[],popouts:null},init:function(){WikiaWideTables.getTables();if(WikiaWideTables.settings.tables.length){$.each(WikiaWideTables.settings.tables,function(){var table=this,wrapper;wrapper=table.wrap('<div class="WikiaWideTablesWrapper"><div class="table"></div></div>').parent().parent();$('<img src="'+wgBlankImgUrl+'" class="sprite popout">').click(WikiaWideTables.makeModal).prependTo(wrapper);if(table.attr("data-overflow")=="true"){var canvas=$('<canvas></canvas>').prependTo(wrapper);if(canvas.get(0).getContext){var context=canvas.get(0).getContext("2d");canvas.css({position:"absolute",right:0,top:0}).attr("width",15).attr("height",wrapper.height());var y=0;var x=15;context.moveTo(x,y);while(y<canvas.height()){x=6;y+=17;context.lineTo(x,y);x=13;y+=21;context.lineTo(x,y);x=0;y+=21;context.lineTo(x,y);x=10;y+=19;context.lineTo(x,y);x=3;y+=18;context.lineTo(x,y);x=15;y+=27;context.lineTo(x,y);}
context.fillStyle=window.sassParams['color-page'];context.fill();}else{canvas.remove();wrapper.addClass("border");}}});WikiaWideTables.settings.popouts=$(".WikiaWideTablesWrapper > .popout");$(window).scroll(WikiaWideTables.popoutScrolling);}},getTables:function(){WikiaWideTables.settings.article.find("table").each(function(){var table=$(this);if(table.width()<=WikiaWideTables.settings.article.width()&&!table.hasClass('popout')){return;}
if(table.width()>WikiaWideTables.settings.article.width()){table.attr("data-overflow","true");}
WikiaWideTables.settings.tables.push(table);});},makeModal:function(event){var table=$(event.currentTarget).next(".table").children("table:first"),$sortableTable;table.clone().makeModal({id:"ModalTable",width:$(window).width()-100});$("#ModalTable .modalContent").css({overflow:"auto",height:$(window).height()-150});$sortableTable=$('#ModalTable').find('table.sortable');if($sortableTable.length){$sortableTable.tablesorter();}},popoutScrolling:function(){WikiaWideTables.settings.popouts.each(function(){var popout=$(this),wrapper=popout.parent(),tableTop=wrapper.offset().top,tableBottom=tableTop+wrapper.height(),scrolledBy=$(window).scrollTop();if(scrolledBy>tableTop&&scrolledBy<tableBottom&&popout.css("position")=="absolute"){popout.css("margin-left",popout.offset().left-($(window).width()/2)).addClass("float");}else if((scrolledBy<tableTop||scrolledBy>tableBottom)&&popout.hasClass("float")){popout.css("margin-left","auto").removeClass("float");}});}};$(function(){WikiaWideTables.init();});;window.Wikia=window.Wikia||{};window.Wikia.getMultiTypePackage=function(options){var request={},styles=options.styles,scripts=options.scripts,messages=options.messages,templates=options.templates,mustache=options.mustache,callback=options.callback,params=options.params,ttl=options.ttl,varnishTTL=options.varnishTTL,browserTTL=options.browserTTL,send=false;if(typeof styles==='string'){request.styles=styles;send=true;}
if(typeof scripts==='string'){request.scripts=scripts;send=true;}
if(typeof messages==='string'){request.messages=messages;send=true;}
if(typeof mustache==='string'){request.mustache=mustache;send=true;}
if(typeof templates!='undefined'){request.templates=(typeof templates==='object')?JSON.stringify(templates):templates;send=true;}
if(typeof params==='object'){request=$.extend(request,params);}
if(ttl)
request.ttl=~~ttl;if(varnishTTL)
request.varnishTTL=~~varnishTTL;if(browserTTL)
request.browserTTL=~~browserTTL;if(send){request.cb=wgStyleVersion;return $.nirvana.getJson('AssetsManagerController','getMultiTypePackage',request,function(resources){if(resources.messages){wgMessages=$.extend(wgMessages,resources.messages);}
if(typeof callback==='function'){callback(resources);}});}else{throw'No resources to load specified';}};window.Wikia.processScript=function(js){var script=document.createElement('script'),firstScript=document.getElementsByTagName('script')[0];script.type='text/javascript';script.text=js;firstScript.parentNode.insertBefore(script,firstScript);};window.Wikia.processStyle=function(css){var style=document.createElement('style');style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=css;}else{style.appendChild(document.createTextNode(css));}
document.getElementsByTagName('head')[0].appendChild(style);};window.Wikia.getAMgroups=function(groups,callback){return $.getScript($.getAssetManagerGroupUrl(groups),callback);};;(function($){var loadedPackages=[];$.extend({msg:function(){var key=Array.prototype.shift.call(arguments),params=arguments;var ret=false;if(typeof wgMessages!='undefined'){ret=wgMessages[key]||ret;if(ret!==false&&params&&params.length){$.each(params,function(i,param){ret=ret.replace(new RegExp('\\$'+parseInt(i+1),'g'),param);});}}
return ret!==false?ret:('<'+key+'>');},getMessages:function(packages,callback,language){var dfd=new jQuery.Deferred();if(typeof packages=='string'){packages=[packages];}
language=language||window.wgUserLanguage;$().log('loading '+packages.join(',')+' package(s) for "'+language+'"','JSMessages');var packagesToLoad=[];for(var i=0,len=packages.length;i<len;i++){if(loadedPackages.indexOf(packages[i])===-1){packagesToLoad.push(packages[i]);}}
if(packagesToLoad.length==0){$().log('package(s) are already loaded','JSMessages');if(typeof callback=='function'){callback();}
dfd.resolve();}
else{$.get(wgScriptPath+'/wikia.php',{controller:'JSMessages',method:'getMessages',format:'html',packages:packagesToLoad.join(','),uselang:language,cb:window.wgJSMessagesCB},function(){$().log(packagesToLoad.join(',')+' package(s) loaded','JSMessages');if(typeof callback=='function'){callback();}
dfd.resolve();loadedPackages=loadedPackages.concat(packagesToLoad);},'script').error(function(){dfd.reject();});}
return dfd.promise();},getMessagesForContent:function(packages,callback){return this.getMessages(packages,callback,window.wgContentLanguage);}});})(jQuery);;if((typeof wgAction=="undefined")||(wgAction=="view")||(wgAction=="purge")){wgAfterContentAndJS.push(function(){$(".catlinks-allhidden").css("display","block");$('#csAddCategorySwitch').children('a').click(function(ev){ev.preventDefault();$.getResources([$.loadYUI,wgExtensionsPath+'/wikia/CategorySelect/CategorySelect.js']).then(function(){showCSpanel();});$('#catlinks').addClass('csLoading');});});};(function(window,$){var HoverMenu=function(selector){this.settings={mouseoverDelay:300,mouseoutDelay:350};this.mouseoverTimer=null;this.mouseoutTimer=null;this.mouseoverTimerRunning=false;this.event={};this.selector=selector;this.menu=$(this.selector);if(!this.menu.find('ul').exists()){$().log('skipping '+this.selector,'HoverMenu');return;}
this.menu.children("li").hover($.proxy(this.mouseover,this),$.proxy(this.mouseout,this));this.menu.children("li").children("a").focus($.proxy(function(event){this.hideNav();this.showNav($(event.currentTarget).closest("li"));},this));this.menu.find(".subnav a").focus($.proxy(function(event){this.hideNav();this.showNav($(event.currentTarget).closest(".subnav").closest("li"));},this));this.menu.children("li").first().children("a").focusout($.proxy(this.hideNav,this));this.menu.find(".subnav>li:last-child li:last-child a").focusout($.proxy(this.hideNav,this));};var globalNavigationMenusCached=false;HoverMenu.prototype.mouseover=function(event){this.event=event;this.menu.children("li").children("ul").not($(event.currentTarget).find("ul")).removeClass("show");clearTimeout(this.mouseoutTimer);if(this.selector=='#GlobalNavigation'&&!globalNavigationMenusCached){var $nav=$(this.selector),$navItems=$nav.children('li'),indexes=$navItems.map(function(){return $(this).data('index');}).get();globalNavigationMenusCached=true;$.nirvana.sendRequest({controller:'GlobalHeaderController',method:'menuItemsAll',format:'json',type:'GET',data:{hash:$nav.data('hash'),indexes:indexes},callback:$.proxy(function(items){$.each(items,function(index,html){$navItems.filter(function(){return $(this).data('index')==index;}).find('.subnav').html(html);});if(this.event.type=='mouseover'){this.handleShowNav(event);}},this)});}else{this.handleShowNav(event);}};HoverMenu.prototype.handleShowNav=function(event){if($(event.relatedTarget).closest(this.selector).length==0){this.mouseoverTimer=setTimeout($.proxy(function(){this.showNav(event.currentTarget);},this),this.settings.mouseoverDelay);this.mouseoverTimerRunning=true;}else{if(this.mouseoverTimerRunning){clearTimeout(this.mouseoverTimer);this.mouseoverTimer=setTimeout($.proxy(function(){this.showNav(event.currentTarget);},this),this.settings.mouseoverDelay);}else{this.showNav(event.currentTarget);}}};HoverMenu.prototype.mouseout=function(event){this.event=event;if($(event.relatedTarget).closest(this.selector).length==0){clearTimeout(this.mouseoverTimer);this.mouseoverTimerRunning=false;this.mouseoutTimer=setTimeout($.proxy(function(){this.hideNav();},this),this.settings.mouseoutDelay);}else{this.hideNav();}};HoverMenu.prototype.showNav=function(parent){var nav=$(parent).children('ul');window.HoverMenuGlobal.hideAll();this.mouseoverTimerRunning=false;if(nav.exists()){nav.addClass("show");if(this.selector=='#GlobalNavigation'){var i=$(parent).index()+1,funcSuffix="_SPOTLIGHT_GLOBALNAV_"+i,func=window["fillIframe"+funcSuffix]||window["fillElem"+funcSuffix];if(func){func();func=null;}}}};HoverMenu.prototype.hideNav=function(){this.menu.find(".subnav").removeClass("show");};var HoverMenuGlobal={menus:[],hideAll:function(){var menus=HoverMenuGlobal.menus;for(var i=0;i<menus.length;i++){menus[i].hideNav();}}};$(function(){HoverMenuGlobal.menus.push(new HoverMenu("#GlobalNavigation"));HoverMenuGlobal.menus.push(new HoverMenu("#AccountNavigation"));HoverMenuGlobal.menus.push(new HoverMenu("#WallNotifications"));$("div.skiplinkcontainer a").focus(function(evt){$("body").data("accessible","true");$("#GlobalNavigation .subnav, #WikiHeader .subnav").show();});});window.HoverMenu=HoverMenu;window.HoverMenuGlobal=HoverMenuGlobal;})(this,jQuery);;var PageHeader={settings:{mouseoverDelay:300,mouseoutDelay:350},init:function(){if(typeof FB!='undefined'&&typeof FB.Event!='undefined'){FB.Event.subscribe('xfbml.render',function(){var likeWrapper=$('.commentslikes').children('.likes');likeWrapper.css('width','auto');});}
if(typeof $.browser.msie!='undefined'&&typeof $.browser.version!='undefined'&&$.browser.version&&$.browser.version.substring(0,$.browser.version.indexOf('.'))<9){GlobalTriggers.bind('fbinit',function(){$('.likes').each(function(){var node=$(this),html=node.html();node.html('').append(html);FB.XFBML.parse(node.get(0));});$().log('fixed like buttons','FB');});}}};var ProfileSyncButton={init:function(){ProfileSyncButton.attachEventListeners();},attachEventListeners:function(){$('a[data-id=syncprofile]').click(function(){window.location.href=$(this).attr('data-href');return false;});}}
$(function(){PageHeader.init();ProfileSyncButton.init();});;var WikiaSearchApp={searchForm:false,searchField:false,ads:false,trackInternal:function(event,params){WikiaTracker.trackEvent(event,params,'internal');},init:function(){this.searchForm=$('#WikiaSearch');this.searchFormBottom=$('#search');this.searchField=this.searchForm.children('input[placeholder]');this.ads=$("[id$='TOP_RIGHT_BOXAD']");if(!this.searchForm.hasClass('noautocomplete')){this.searchField.bind({'suggestShow':$.proxy(this.hideAds,this),'suggestHide':$.proxy(this.showAds,this)});this.searchField.one('focus',$.proxy(this.initSuggest,this));}},hideAds:function(){this.ads.each(function(){$(this).children().css('margin-left','-9999px');});},showAds:function(){this.ads.each(function(){$(this).children().css('margin-left','auto');});},initSuggest:function(){$.when($.loadJQueryAutocomplete()).then($.proxy(function(){this.searchField.autocomplete({serviceUrl:wgServer+wgScript+'?action=ajax&rs=getLinkSuggest&format=json',onSelect:$.proxy(function(value,data,event){var valueEncoded=encodeURIComponent(value.replace(/ /g,'_')),location=wgArticlePath.replace(/\$1/,valueEncoded).replace(encodeURIComponent('/'),'/');this.trackInternal('search_start_suggest',{'sterm':valueEncoded,'rver':0});if(event.button===1||event.metaKey||event.ctrlKey){window.open(location);return false;}else{window.location.href=location;}},this),appendTo:'#WikiaSearch',deferRequestBy:2000,minLength:3,maxHeight:1000,selectedClass:'selected',width:'270px',skipBadQueries:true});},this));}};$(function(){WikiaSearchApp.init();});;var WikiaFooterApp={init:function(){this.footer=$("#WikiaFooter");this.toolbar=this.footer.children(".toolbar");this.gn=$('.global-notification');this.windowObj=$(window);this.originalWidth=this.toolbar.width();if(this.toolbar.exists()||this.gn.exists()){if(!(navigator.platform in{'iPad':'','iPhone':'','iPod':''}||(navigator.userAgent.match(/android/i)!=null))){this.addScrollEvent();this.addResizeEvent();}
this.tcToolbar=new ToolbarCustomize.Toolbar(this.footer.find('.tools'));}},addScrollEvent:function(){WikiaFooterApp.windowObj.off('scroll.FooterAp');WikiaFooterApp.windowObj.on('scroll.FooterAp',WikiaFooterApp.resolvePosition).triggerHandler('scroll');},addResizeEvent:function(){WikiaFooterApp.windowObj.on('resize',WikiaFooterApp.centerBar).triggerHandler('resize');},centerBar:function(){var w=WikiaFooterApp.windowObj.width();if(w<WikiaFooterApp.originalWidth&&WikiaFooterApp.footer.hasClass('float')){WikiaFooterApp.toolbar.css('width',w+10);if(!WikiaFooterApp.toolbar.hasClass('small')){WikiaFooterApp.toolbar.addClass('small');}}else if(WikiaFooterApp.toolbar.hasClass('small')){WikiaFooterApp.toolbar.css('width',WikiaFooterApp.originalWidth);WikiaFooterApp.toolbar.removeClass('small');}
WikiaFooterApp.resolvePosition();},resolvePosition:function(){if(typeof wgIsEditPage!='undefined'){return;}
var scrollTop=WikiaFooterApp.windowObj.scrollTop(),scroll=scrollTop+WikiaFooterApp.windowObj.height(),line=0;if(WikiaFooterApp.footer.offset()){line=WikiaFooterApp.footer.offset().top+WikiaFooterApp.toolbar.outerHeight();}
if(scroll>line&&WikiaFooterApp.footer.hasClass("float")){WikiaFooterApp.footer.removeClass("float");WikiaFooterApp.centerBar();}else if(scroll<line&&!WikiaFooterApp.footer.hasClass("float")){WikiaFooterApp.footer.addClass("float");WikiaFooterApp.centerBar();}
if(window.GlobalNotification){GlobalNotification.onScroll(scrollTop);}}};(function(){window.ToolbarCustomize=window.ToolbarCustomize||{};var TC=window.ToolbarCustomize;TC.MenuGroup=$.createClass(Observable,{showTimer:false,hideTimer:false,showTimeout:300,hideTimeout:350,showing:false,visible:false,constructor:function(){TC.MenuGroup.superclass.constructor.call(this);this.showTimer=Timer.create($.proxy(this.show,this),this.showTimeout);this.hideTimer=Timer.create($.proxy(this.hide,this),this.hideTimeout);},add:function(el){var e=$(el);e.unbind('.menugroup').bind('mouseenter.menugroup',$.proxy(this.delayedShow,this)).bind('mouseleave.menugroup',$.proxy(this.delayedHide,this)).children('a','img').unbind('.menugroup').bind('click.menugroup',$.proxy(this.showOnClick,this));},remove:function(el){$(el).unbind('.menugroup').children('a','img').unbind('.menugroup');},show:function(evt){this.hideTimer.stop();this.showTimer.stop();if(!this.showing||this.visible==this.showing){return;}
if(this.visible){this.hide();}
if(this.showing){this.visible=this.showing;this.showing=false;this.fire('menushow',this,this.visible,this.visible.children('ul'));this.visible.children('ul').show();}},delayedShow:function(evt){this.showing=$(evt.currentTarget);if(this.visible){this.show(evt);}else{this.hideTimer.stop();this.showTimer.start();}},showOnClick:function(evt){evt.preventDefault();this.showing=$(evt.currentTarget).parent();this.show(evt);},hide:function(evt){this.hideTimer.stop();this.showTimer.stop();if(this.visible){this.fire('menuhide',this,this.visible,this.visible.children('ul'));this.visible.children('ul').hide();this.visible=false;}},delayedHide:function(evt){this.hideTimer.stop();if(this.visible){this.hideTimer.start();}else if(this.showing){this.showing=false;this.showTimer.start();}}});TC.Toolbar=$.createClass(Object,{el:false,more:false,menuGroup:false,constructor:function(el){TC.Toolbar.superclass.constructor.call(this);this.el=el;this.menuGroup=new TC.MenuGroup();this.menuGroup.bind('menushow',this.onShowMenu,this);this.initialize();},initialize:function(){this.el.find('.tools-customize').click($.proxy(this.openConfiguration,this));this.menuGroup.add(this.el.find('li.menu'));this.handleOverflowMenu();},openConfiguration:function(evt){evt.preventDefault();var conf=new TC.ConfigurationLoader(this);conf.show();},buildOveflowItem:function(){return this.el.find('.overflow-menu').css('display','');},handleOverflowMenu:function(){var all=this.el.children('li'),moreable=all.filter('.overflow'),where=moreable.last().next(),width=0,mwidth=0,fwidth=this.el.width();all.each(function(i,v){width+=$(v).outerWidth(true);});moreable.each(function(i,v){mwidth+=$(v).outerWidth(true);});if(width<fwidth){return;}
var li_more=this.buildOveflowItem();if(where.exists()){where.before(li_more);}
else{this.el.append(li_more);}
var more=li_more.children('ul');var moreWidth=li_more.outerWidth(true)+5;var rwidth=fwidth-moreWidth-(width-mwidth);moreable.each(function(i,v){rwidth-=$(v).outerWidth(true);if(rwidth<0){$(v).prependTo(more);}});this.menuGroup.add(li_more,$.proxy(this.onShowMenu,this));},onShowMenu:function(mgroup,li,ul){ul.css('left',(li.offset().left-this.el.offset().left)+'px');ul.css('right','auto');},load:function(html){this.el.children('li').not('.loadtime').remove();this.el.prepend($(html));this.initialize();}});TC.ConfigurationLoader=$.createClass(Object,{constructor:function(toolbar){this.toolbar=toolbar;},show:function(){$.loadLibrary('ToolbarCustomize',stylepath+'/oasis/js/ToolbarCustomize.js',typeof TC.Configuration,$.proxy(function(){var c=new TC.Configuration(this.toolbar);c.show();},this));}});})();$(function(){WikiaFooterApp.init();});;(function(){var corporateFooter=$('footer.CorporateFooter');if(Wikia.Cookies.get('mobilefullsite')){var linksWrapper=corporateFooter.find('nav ul').first();if(linksWrapper.exists()){$.getMessages('Oasis-mobile-switch').then(function(resp){var mobileSwitch=$('<li><a href="#">'+$.msg('oasis-mobile-site')+'</a></li>');mobileSwitch.on('click',function(ev){ev.preventDefault();ev.stopPropagation();Wikia.Cookies.set('mobilefullsite',null);WikiaTracker.trackEvent('trackingevent',{ga_category:'corporate-footer',ga_action:WikiaTracker.ACTIONS.CLICK_LINK_BUTTON,ga_label:'mobile-switch'},'both');var url=new Wikia.Querystring();url.setVal('useskin','wikiamobile');url.addCb();url.goTo();});linksWrapper.prepend(mobileSwitch.wrap('<li></li>'));});}}})();;var WikiaButtons={settings:{delay:350},init:function(limit){if(typeof limit=='object'){WikiaButtons.menuButtons=$(".wikia-menu-button",limit);}else{WikiaButtons.menuButtons=$(".wikia-menu-button");}
WikiaButtons.timer=null;WikiaButtons.add(WikiaButtons.menuButtons);},add:function(e,opts){var defaults={click:WikiaButtons.click};var s=$.extend({},defaults,opts||{});e.unbind('.wikiabutton').one("mouseover.wikiabutton",WikiaButtons.setup).bind('mouseenter.wikiabutton',WikiaButtons.mouseover).bind('mouseleave.wikiabutton',WikiaButtons.mouseout).bind('click.wikiabutton',s.click);},setup:function(){$(this).data('menu',$(this).find("ul"));},click:function(event){var button=$(this);if(!button.attr('disabled')){if(event.target.tagName!=='A'){var width=button.outerWidth();if(width!==button.data('prevWidth')){button.data('prevWidth',width);var menu=button.data('menu');width=width-(parseInt(menu.css('padding-left'))+parseInt(menu.css('padding-right'))+parseInt(menu.css('border-left-width'))+parseInt(menu.css('border-right-width')));menu.css("min-width",width);}
button.toggleClass("active");}}
else{event.preventDefault();return false;}},mouseover:function(){clearTimeout(WikiaButtons.timer);},mouseout:function(event){var dalay=$(event.target).closest('.wikia-menu-button').attr('data-delay');if((typeof dalay)!='string'){dalay=WikiaButtons.settings.delay;}
WikiaButtons.timer=setTimeout(function(){$(event.currentTarget).removeClass("active");},dalay);}};$(function(){WikiaButtons.init();});;var WikiHeader={isDisplayed:false,settings:{mouseoverDelay:300,mouseoutDelay:350},init:function(){WikiHeader.nav=$("header.WikiHeader").children("nav");WikiHeader.navLI=WikiHeader.nav.children("ul").children("li");WikiHeader.subnav=WikiHeader.nav.find(".subnav");WikiHeader.mouseoverTimerRunning=false;WikiHeader.positionNav();WikiHeader.navLI.children("a").focus(function(){WikiHeader.hideNav();WikiHeader.showSubNav($(this).parent("li"));});if(!$().isTouchscreen()){WikiHeader.navLI.hover(WikiHeader.mouseover,WikiHeader.mouseout);}else{WikiHeader.navLI.click(WikiHeader.click);}
var suppressOnFocus=false;WikiHeader.subnav.find("a").bind('mousedown',function(){suppressOnFocus=true;}).bind('mouseup',function(){suppressOnFocus=false;}).focus(function(event){if(!suppressOnFocus){WikiHeader.hideNav();WikiHeader.showSubNav($(event.currentTarget).closest(".subnav").parent("li"));}});WikiHeader.nav.children("ul").find("li:first-child a").focusout(WikiHeader.hideNav);WikiHeader.subnav.last().find("li:last-child a").focusout(WikiHeader.hideNav);$(document).mouseout(function(e){if(WikiHeader.isDisplayed){var from=e.relatedTarget||e.toElement;if(!from||from.nodeName=='HTML'){WikiHeader.hideNav();}}});if((window.wgIsWikiNavMessage)&&(wgAction=="edit")){$('#wpSave').hide();}},click:function(event){var subnav=$(this).children('.subnav');if(subnav.length&&!subnav.hasClass('opened')){event.preventDefault();WikiHeader.hideNav();WikiHeader.showSubNav(event.currentTarget);WikiHeader.subnav.removeClass('opened');subnav.addClass('opened');}},mouseover:function(event){var otherSubnavs=WikiHeader.subnav.not($(this).find(".subnav"));if($('body').data('accessible')){otherSubnavs.css("top","-9999px");}else{otherSubnavs.hide();}
clearTimeout(WikiHeader.mouseoutTimer);if($(event.relatedTarget).closest("#WikiHeader nav li").length==0){WikiHeader.mouseoverTimer=setTimeout(function(){WikiHeader.showSubNav(event.currentTarget);WikiHeader.mouseoverTimerRunning=false;},WikiHeader.settings.mouseoverDelay);WikiHeader.mouseoverTimerRunning=true;}else{if(WikiHeader.mouseoverTimerRunning){clearTimeout(WikiHeader.mouseoverTimer);WikiHeader.mouseoverTimerRunning=false;WikiHeader.mouseoverTimer=setTimeout(function(){WikiHeader.showSubNav(event.currentTarget);},WikiHeader.settings.mouseoverDelay);WikiHeader.mouseoverTimerRunning=true;}else{WikiHeader.showSubNav(this);}}},mouseout:function(event){if($(event.relatedTarget).closest("#WikiHeader nav li").length==0){clearTimeout(WikiHeader.mouseoverTimer);WikiHeader.mouseoverTimerRunning=false;WikiHeader.mouseoutTimer=setTimeout(WikiHeader.hideNav,WikiHeader.settings.mouseoutDelay);}else{WikiHeader.hideNav();}},showSubNav:function(parent){var subnav=$(parent).children('ul');if(subnav.exists()){WikiHeader.isDisplayed=true;subnav.css("top",WikiHeader.navtop).show();}},hideNav:function(){WikiHeader.isDisplayed=false;if($('body').data('accessible')){WikiHeader.subnav.css("top","-9999px");}else{WikiHeader.subnav.hide();}},positionNav:function(){WikiHeader.navtop=WikiHeader.nav.height();}};$(function(){WikiHeader.init();});var WikiHeaderV2={lastSubnavClicked:-1,isDisplayed:false,activeL1:null,settings:{mouseoverDelay:200,mouseoutDelay:350},log:function(msg){$().log(msg,'WikiHeaderV2');},init:function(isValidator){WikiHeaderV2.nav=$('header.WikiHeaderRestyle').children('nav');WikiHeaderV2.navLI=WikiHeaderV2.nav.children('ul').children('li');WikiHeaderV2.subnav2=WikiHeaderV2.nav.find('.subnav-2');WikiHeaderV2.subnav2LI=WikiHeaderV2.subnav2.children('li');WikiHeaderV2.subnav3=WikiHeaderV2.nav.find('.subnav-3');WikiHeaderV2.positionNav();WikiHeaderV2.navLI.click(WikiHeaderV2.mouseclickL1).children('a').focus(function(){WikiHeaderV2.showSubNavL2($(this).parent('li'));});WikiHeaderV2.subnav2LI.click(WikiHeaderV2.mouseclickL2).children('a').focus(function(){WikiHeaderV2.hideNavL3();WikiHeaderV2.showSubNavL3($(this).parent('li'));});if(!$().isTouchscreen()){WikiHeaderV2.navLI.hover(WikiHeaderV2.mouseoverL1,WikiHeaderV2.mouseoutL1);WikiHeaderV2.subnav2LI.hover(WikiHeaderV2.mouseoverL2,WikiHeaderV2.mouseoutL2);}
var suppressOnFocus=false;WikiHeaderV2.subnav3.find('a').bind('mousedown',function(){suppressOnFocus=true;}).bind('mouseup',function(){suppressOnFocus=false;}).focus(function(event){if(!suppressOnFocus){WikiHeaderV2.hideNavL3();WikiHeaderV2.showSubNavL3($(event.currentTarget).closest('.subnav').parent('li'));}});WikiHeaderV2.subnav3.find('li:first-child a').focusout(WikiHeaderV2.hideNavL3);WikiHeaderV2.subnav3.last().find('li:last-child a').focusout(WikiHeaderV2.hideNavL3);$(document).mouseout(function(e){if(WikiHeaderV2.isDisplayed){var from=e.relatedTarget||e.toElement;if(!from||from.nodeName=='HTML'){WikiHeaderV2.hideNavL3();}}});if(!isValidator){var itemsRemoved=0;WikiHeaderV2.subnav2.each(function(i){var menu=$(this),items=menu.children('li').reverse();if(i>0){menu.css('visibility','hidden').show();}
items.each(function(){var item=$(this),pos=item.position();if(pos.top===0){return false;}
else{item.remove();itemsRemoved++;}});if(i>0){menu.css('visibility','visible').hide();}});if(itemsRemoved>0){WikiHeaderV2.log('items removed: '+itemsRemoved);}}},mouseclickL1:function(event){if(!$(this).hasClass('marked')){event.preventDefault();WikiHeaderV2.subnav2LI.removeClass('marked2');WikiHeaderV2.navLI.removeClass('marked');WikiHeaderV2.hideNavL3();$(this).addClass('marked');var otherSubnavs=WikiHeaderV2.subnav2.not();if($('body').data('accessible')){otherSubnavs.css('top','-9999px');}else{otherSubnavs.hide();}
WikiHeaderV2.activeL1=this;WikiHeaderV2.showSubNavL2(this);}
var node=$(event.target);if(node.is('a')&&node.attr('data-canonical')=='chat'){event.preventDefault();ChatEntryPoint.onClickChatButton(wgUserName!==null,node.attr('href'));}},mouseoverL1:function(event){var self=this;if(WikiHeaderV2.activeL1===self){return;}
WikiHeader.mouseoverTimer=setTimeout(function(){WikiHeaderV2.navLI.removeClass('marked');WikiHeaderV2.hideNavL3();$(self).addClass('marked');var otherSubnavs=WikiHeaderV2.subnav2.not();if($('body').data('accessible')){otherSubnavs.css('top','-9999px');}else{otherSubnavs.hide();}
WikiHeaderV2.activeL1=self;WikiHeaderV2.showSubNavL2(self);},WikiHeaderV2.settings.mouseoverDelay);},mouseoutL1:function(event){clearTimeout(WikiHeader.mouseoverTimer);},mouseclickL2:function(event){var otherSubnavs=WikiHeaderV2.subnav3.not($(this).find('.subnav'));if($(this).find('.subnav').exists()&&!$(this).hasClass('marked2')){WikiHeaderV2.hideNavL3();event.preventDefault();$(this).addClass('marked2');if($('body').data('accessible')){otherSubnavs.css('top','-9999px');}else{otherSubnavs.hide();}
WikiHeaderV2.showSubNavL3(event.currentTarget);}},mouseoverL2:function(){var self=this;clearTimeout(WikiHeader.mouseoutTimer);WikiHeader.mouseoverTimer=setTimeout(function(){var otherSubnavs=WikiHeaderV2.subnav3.not($(self).find('.subnav'));if($('body').data('accessible')){otherSubnavs.css('top','-9999px');}else{otherSubnavs.hide();}
$(self).siblings().removeClass('marked2');WikiHeaderV2.showSubNavL3(self);},WikiHeaderV2.settings.mouseoverDelay);},mouseoutL2:function(){clearTimeout(WikiHeader.mouseoverTimer);WikiHeader.mouseoutTimer=setTimeout(function(){WikiHeaderV2.hideNavL3();},WikiHeaderV2.settings.mouseoutDelay);},showSubNavL2:function(parent){var subnav=$(parent).children('ul');if(subnav.exists()){subnav.show();}},showSubNavL3:function(parent){var subnav=$(parent).children('ul');if(subnav.exists()){$(parent).addClass('marked2');WikiHeaderV2.isDisplayed=true;subnav.css('top',WikiHeaderV2.navtop).show();}},hideNavL3:function(){WikiHeaderV2.isDisplayed=false;WikiHeaderV2.lastSubnavClicked=-1;WikiHeaderV2.subnav2LI.removeClass('marked2');if($('body').data('accessible')){WikiHeaderV2.subnav3.css('top','-9999px');}else{WikiHeaderV2.subnav3.hide();}},positionNav:function(){WikiHeaderV2.navtop=WikiHeaderV2.nav.height()-7;},firstMenuValidator:function(){var widthLevelFirst=0,returnVal=true,menuNodes=$('.ArticlePreview #WikiHeader > nav > ul > li');menuNodes.reverse().each(function(){var item=$(this),pos=item.position();if(pos.top===0){return false;}
else{returnVal=false;WikiHeaderV2.log('menu level #1 not valid');}});menuNodes.each(function(menuItemKey,menuItem){widthLevelFirst+=$(menuItem).width();});if(widthLevelFirst>550){returnVal=false;WikiHeaderV2.log('menu level #1 not valid');}
return returnVal;},secondMenuValidator:function(){var widthLevelSecond=0,returnVal=true,maxWidth=$('#WikiaPage').width()-280,menuNodes=$('.ArticlePreview #WikiHeader .subnav-2');$.each(menuNodes,function(){var menu=$(this);menu.show();$.each(menu.children('li'),function(){widthLevelSecond+=$(this).width();});menu.hide();if(widthLevelSecond>maxWidth){returnVal=false;WikiHeaderV2.log('menu level #2 not valid');}
widthLevelSecond=0;});menuNodes.eq(0).show();return returnVal;}};$(function(){WikiHeaderV2.init();if(window.wgIsWikiNavMessage){$.getMessages('Oasis-navigation-v2');$(window).bind('EditPageRenderPreview',function(ev,options){options.width=($('#WikiaPage').width()-271)+32;});$(window).bind('EditPageAfterRenderPreview',function(ev,previewNode){previewNode.removeClass('WikiaArticle');WikiHeaderV2.init(true);var firstMenuValid=WikiHeaderV2.firstMenuValidator(),secondMenuValid=WikiHeaderV2.secondMenuValidator(),menuParseError=!!previewNode.find('nav > ul').attr('data-parse-errors'),errorMessages=[];if(menuParseError){errorMessages.push($.msg('oasis-navigation-v2-magic-word-validation'));}
if(!firstMenuValid&&!secondMenuValid){errorMessages.push($.msg('oasis-navigation-v2-level12-validation'));}
else if(!firstMenuValid){errorMessages.push($.msg('oasis-navigation-v2-level1-validation'));}
else if(!secondMenuValid){errorMessages.push($.msg('oasis-navigation-v2-level2-validation'));}
if(errorMessages.length>0){$('#publish').remove();alert(errorMessages.join("\n\n"));}
previewNode.find('nav > ul a').click(function(){if($(this).attr('href')=='#'){return false;}});});$('#wpPreview').parent().removeClass('secondary');$('#EditPageRail .module_page_controls .module_content').append('<div class="preview-validator-desc">'+$.msg('oasis-navigation-v2-validation-caption')+'</div>');$('#EditPageMain').addClass('editpage-wikianavmode');}});;var UploadPhotos={d:false,destfile:false,filepath:false,doptions:{persistent:false,width:600},status:false,libinit:false,init:function(){if(!($(".upphotoslogin").exists())){$(".upphotos").click(UploadPhotos.showDialog);}
$('#LatestPhotosModule').find('.upphotos, .upphotoslogin').tooltip({delay:{show:500,hide:100}});},showDialog:function(evt){if(evt){evt.preventDefault();}
$.nirvana.sendRequest({controller:'UploadPhotos',method:'Index',format:'html',data:{title:wgPageName,cb:wgCurRevisionId,uselang:wgUserLanguage},type:'get',callback:function(html){UploadPhotos.d=$(html).makeModal(UploadPhotos.doptions);UploadPhotos.destfile=UploadPhotos.d.find("input[name=wpDestFile]");UploadPhotos.filepath=UploadPhotos.d.find("input[name=wpUploadFile]");UploadPhotos.status=UploadPhotos.d.find("div.status");UploadPhotos.advanced=UploadPhotos.d.find(".advanced a");UploadPhotos.advancedChevron=UploadPhotos.d.find(".advanced .chevron");UploadPhotos.options=UploadPhotos.d.find(".options");UploadPhotos.uploadbutton=UploadPhotos.d.find("input[type=submit]");UploadPhotos.step1=UploadPhotos.d.find(".step-1");UploadPhotos.step2=UploadPhotos.d.find(".step-2");UploadPhotos.conflict=UploadPhotos.d.find(".conflict");UploadPhotos.ignore=UploadPhotos.d.find("input[name=wpIgnoreWarning]");UploadPhotos.override=UploadPhotos.d.find(".override");UploadPhotos.overrideinput=UploadPhotos.override.find("input");UploadPhotos.ajaxwait=UploadPhotos.d.find(".ajaxwait");UploadPhotos.dfcache={};UploadPhotos.wpLicense=$('#wpLicense');UploadPhotos.wpLicenseTarget=$('#mw-license-preview');UploadPhotos.filepath.change(UploadPhotos.filePathSet);UploadPhotos.destfile.blur(UploadPhotos.destFileSet);UploadPhotos.d.find('form').submit(function(){$.AIM.submit(this,UploadPhotos.uploadCallback);});UploadPhotos.advanced.click(function(evt){evt.preventDefault();if(UploadPhotos.options.is(":visible")){UploadPhotos.advanced.text(UploadPhotos.advanced.data("more"));UploadPhotos.advancedChevron.removeClass("up");}else{UploadPhotos.advanced.text(UploadPhotos.advanced.data("fewer"));UploadPhotos.advancedChevron.addClass("up");}
UploadPhotos.options.slideToggle("fast");});UploadPhotos.destfile.keyup(function(){if(UploadPhotos.dftimer){clearTimeout(UploadPhotos.dftimer);}
UploadPhotos.dftimer=setTimeout(UploadPhotos.destFileSet,500);});UploadPhotos.wpLicense.change(function(){var license=$(this).val();if(license==""){$(this).attr('selectedIndex',0);UploadPhotos.wpLicenseTarget.html("");return;}
var title=UploadPhotos.destfile.val()||'File:Sample.jpg';$.get(mw.util.wikiScript('api'),{action:'parse',text:'{{'+license+'}}',title:title,prop:'text',format:'json'},function(data){UploadPhotos.wpLicenseTarget.html(data.parse.text['*']);},"json");});}});if(!UploadPhotos.libinit){$.loadJQueryAIM();UploadPhotos.libinit=true;}},uploadCallback:{onComplete:function(res){res=$("<div/>").html(res).text();var json=JSON.parse(res);if(json){if(json['status']==0){window.location=wgArticlePath.replace('$1','Special:NewFiles');}else if(json['status']==-2){UploadPhotos.step1.hide(400,function(){UploadPhotos.conflict.html(json['statusMessage']);UploadPhotos.step2.show(400,function(){UploadPhotos.uploadbutton.removeAttr("disabled").show();UploadPhotos.ajaxwait.hide();});});UploadPhotos.ignore.attr("checked",true);}else{UploadPhotos.status.addClass("error").show(400).html(json['statusMessage']);UploadPhotos.uploadbutton.removeAttr("disabled").show();UploadPhotos.ajaxwait.hide();}}},onStart:function(){UploadPhotos.uploadbutton.attr("disabled","true").hide();UploadPhotos.ajaxwait.show();UploadPhotos.status.hide("fast",function(){$(this).removeClass("error");});}},filePathSet:function(){if(UploadPhotos.filepath.val()){var filename=UploadPhotos.filepath.val().replace(/^.*\\/,'');UploadPhotos.destfile.val(filename);UploadPhotos.destFileSet();}},destFileSet:function(){if(UploadPhotos.destfile.val()){var df=UploadPhotos.destfile.val();if(UploadPhotos.dfcache[df]){UploadPhotos.destFileInputSet(UploadPhotos.dfcache[df]);}else{$.nirvana.sendRequest({controller:'UploadPhotos',method:'ExistsWarning',format:'html',type:'get',data:{title:wgPageName,cb:wgCurRevisionId,uselang:wgUserLanguage,wpDestFile:UploadPhotos.destfile.val()},callback:function(html){UploadPhotos.dfcache[df]=html;UploadPhotos.destFileInputSet(html);}});}}},destFileInputSet:function(html){if(html&&$.trim(html)){UploadPhotos.override.fadeIn(400);UploadPhotos.status.removeClass("error").html(html).show(400);}else{UploadPhotos.override.fadeOut(400);UploadPhotos.overrideinput.attr("checked",false);UploadPhotos.status.removeClass("error").hide(400);}}};var LatestPhotos={init:function(){this.carousel=$('.LatestPhotosModule').find('.carousel-container');this.carousel.carousel({attachBlindImages:true});}};$(function(){LatestPhotos.init();UploadPhotos.init();});;var Interlang={init:function(){$('.WikiaArticleInterlang .more-link').click(Interlang.showAll);},showAll:function(){$('.WikiaArticleInterlang .more-link').hide();$('.WikiaArticleInterlang .more').show();return false;}};$(function(){Interlang.init();});;var WikiaNotificationsApp={purgeCurrentPage:function(){$.post(wgScript,{action:'purge',title:wgPageName});},init:function(){var notifications=$('#WikiaNotifications');notifications.find('.close-notification').click(function(ev){var notification=$(this).parent();var notificationType=parseInt(notification.attr('data-type'));switch(notificationType){case 1:$.post(wgScript,{action:'ajax',rs:'wfDismissWikiaNewtalks'},WikiaNotificationsApp.purgeCurrentPage);notification.parent().remove();break;case 2:$.post(wgScript,{action:'ajax',rs:'CommunityMessagesAjax',method:'dismissMessage'},WikiaNotificationsApp.purgeCurrentPage);notification.parent().remove();break;case 5:var messageId=parseInt(notification.attr('id').substr(4));var nextNotification=notification.next();$.post(wgScript,{title:'Special:SiteWideMessages',action:'dismiss',mID:messageId},WikiaNotificationsApp.purgeCurrentPage);var trackObj={ga_category:'sitewidemessages',ga_action:WikiaTracker.ACTIONS.CLICK_LINK_BUTTON,ga_label:'swm-dismiss',ga_value:messageId};WikiaTracker.trackEvent('trackingevent',trackObj,'internal');notification.remove();nextNotification.css("display","block");break;case 10:$.post($(this).attr('data-url'),WikiaNotificationsApp.purgeCurrentPage);notification.parent().remove();break;default:notification.parent().remove();break;}});}};$(function(){WikiaNotificationsApp.init();$('body').on({'meebo-visible':function(){$('#WikiaNotifications').addClass('meebo');},'meebo-hidden':function(){$('#WikiaNotifications').removeClass('meebo');}});});;$(function(){var WikiaRailNode=$('#WikiaRail'),WikiaFoooterNode=$('#WikiaFooter'),WikiaSpotlightsModuleNode=$('#WikiaSpotlightsModule');if(WikiaRailNode.exists()&&WikiaFoooterNode.exists()&&WikiaSpotlightsModuleNode.exists()){if(WikiaFoooterNode.offset().top-(WikiaRailNode.offset().top+WikiaRailNode.height())>1200){WikiaSpotlightsModuleNode.show();}}});;var FirefoxFindFix={scrollThreshold:30,lastScroll:0,init:function(){$(window).scroll(FirefoxFindFix.analyze).mousedown(FirefoxFindFix.cancelTimer);},analyze:function(){if(window.getSelection().toString()){var currentScroll=$(window).scrollTop();if(currentScroll>FirefoxFindFix.lastScroll+FirefoxFindFix.scrollThreshold){FirefoxFindFix.adjust();}
FirefoxFindFix.lastScroll=currentScroll;}},adjust:function(){$(window).scrollTop($(window).scrollTop()+FirefoxFindFix.scrollThreshold);FirefoxFindFix.anchorOffset=window.getSelection().anchorOffset;if(!FirefoxFindFix.timer){FirefoxFindFix.timer=setInterval(FirefoxFindFix.monitorHighlight,250);}},monitorHighlight:function(){if(window.getSelection().anchorOffset!=FirefoxFindFix.anchorOffset){if(FirefoxFindFix.timer){FirefoxFindFix.adjust();}}},cancelTimer:function(){if(FirefoxFindFix.timer){clearInterval(FirefoxFindFix.timer);FirefoxFindFix.timer=null;}}};$(function(){if($.browser.mozilla&&$("#WikiaFooter .toolbar").exists()){FirefoxFindFix.init();}});;if($().isTouchscreen()){$.getResources([$.getSassCommonURL('/skins/oasis/css/touchScreen.scss'),stylepath+'/oasis/js/touchScreen.js']);};jQuery(function($){$('body').on('click','.tabs a',function(evt){if($(this).parent().hasClass('disabled')){return;}
var newTabName=$(this).parent().data('tab');if($('[data-tab-body="'+newTabName+'"]').length>0){evt.preventDefault();var previousTabName=$(this).closest('ul').find('.selected').removeClass('selected').data('tab');$(this).closest('li').addClass('selected');$('[data-tab-body="'+previousTabName+'"]').removeClass('selected');$('[data-tab-body="'+newTabName+'"]').addClass('selected');}else{$().log("Tried to switch to tab but could not find data-tab-body: \""+newTabName+"\"");}});});;var SharingToolbar={pageWidth:0,toolbarNode:false,contributeOffsetTop:0,init:function(){this.toolbarNode=$('#SharingToolbar');if(!this.toolbarNode.exists()){return;}
this.pageWidth=$('#WikiaPage').width();this.contributeOffsetTop=$('#WikiHeader > .buttons > .contribute').offset().top-5;$(window).bind('scroll',$.proxy(this.onScroll,this));this.toolbarNode.find('.email-link').bind('click',this.onEmailClick);$('.WikiHeaderRestyle .share-button').bind('click',this.toolbarToggle);},onScroll:function(){if($(window).scrollTop()>=this.contributeOffsetTop){this.toolbarNode.addClass('fixed');}
else{this.toolbarNode.removeClass('fixed');}},onEmailClick:function(ev){var node=$(this),lightboxShareEmailLabel=node.attr('data-lightboxShareEmailLabel'),lightboxSend=node.attr('data-lightboxSend'),lightboxShareEmailLabelAddress=node.attr('data-lightboxShareEmailLabelAddress'),lightboxCancel=node.attr('data-lightboxcancel');var showEmailModal=function(){SharingToolbar.showEmailModal(lightboxShareEmailLabel,lightboxSend,lightboxShareEmailLabelAddress,lightboxCancel);};if(window.wgUserName==null){if(window.wgComboAjaxLogin){showComboAjaxForPlaceHolder(false,false,function(){AjaxLogin.doSuccess=function(){$('#AjaxLoginBoxWrapper').closest('.modalWrapper').closeModal();showEmailModal();};AjaxLogin.close=function(){$('#AjaxLoginBoxWrapper').closeModal();};},false,true);}else{UserLoginModal.show({callback:showEmailModal});}
return false;}
else{showEmailModal();}},showEmailModal:function(lightboxShareEmailLabel,lightboxSend,lightboxShareEmailLabelAddress,lightboxCancel){var refreshPage=function(){UserLoginAjaxForm.prototype.reloadPage();};$.showCustomModal(lightboxShareEmailLabel,'<label>'+lightboxShareEmailLabelAddress+'<br/>'
+'<input type="text" id="lightbox-share-email-text" /></label>',{id:'shareEmailModal',width:690,showCloseButton:true,buttons:[{id:'ok',defaultButton:true,message:lightboxSend,handler:function(){$.nirvana.sendRequest({controller:'SharingToolbarController',method:'sendMail',format:'json',data:{pageName:wgPageName,addresses:$('#shareEmailModal #lightbox-share-email-text').val(),messageId:1},callback:function(data){var result=data.result;$.showModal(result['info-caption'],result['info-content'],{onClose:refreshPage});if(result.success){$('#shareEmailModal').closeModal();}}});}},{id:'cancel',message:'Cancel',handler:function(){$('#shareEmailModal').hideModal();}}],onClose:refreshPage});},checkWidth:function(){var maxWidth=0,nodes=this.toolbarNode.children();$.each(nodes,function(key,value){var node=$(value),elementWidth=Math.max(node.outerWidth(),node.children().outerWidth());maxWidth=Math.max(elementWidth,maxWidth);});this.toolbarNode.css('width',maxWidth);},toolbarToggle:function(ev){var button=$(this),self=SharingToolbar;ev.preventDefault();button.toggleClass('share-enabled');self.toolbarNode.toggle();if(button.hasClass('share-enabled')){self.checkWidth();}}}
$(function(){SharingToolbar.init();});;var WikiaForm=function(el){this.el=$(el);this.genericError=this.el.find('.general-errors');if(this.genericError.length==0){this.el.find('fieldset').prepend('<div class="input-group general-errors error"><div class="error-msg"></div></div>');this.genericError=this.el.find('.general-errors');this.genericError.hide();this.genericErrorMsg=this.genericError.find('.error-msg');}
this.genericSuccess=this.el.find('.general-success');if(this.genericSuccess.length==0){this.el.find('fieldset').prepend('<div class="input-group general-success success"><div class="success-msg"></div></div>');this.genericSuccess=this.el.find('.general-success');this.genericSuccess.hide();this.genericSuccessMsg=this.genericSuccess.find('.success-msg');}
this.inputs={};var inputs=this.el.find('input, select, textarea');for(var i=0;i<inputs.length;i++){var input=$(inputs[i]),name=input.attr('name');if(name){this.inputs[name]=input;}}
this.inputGroups={};this.el.find('[rel=tooltip]').tooltip();};WikiaForm.prototype.showGenericError=function(msg){this.genericError.show();this.showErrorMsg(this.genericError,msg);};WikiaForm.prototype.showGenericSuccess=function(msg){this.genericSuccess.show();this.showSuccessMsg(this.genericSuccess,msg);};WikiaForm.prototype.getInputGroup=function(paramName){var inputGroup=this.inputGroups[paramName];if(!inputGroup){inputGroup=this.inputs[paramName].closest('.input-group');if(!inputGroup.exists()){var input=this.el.find('input[name='+paramName+']');if(input.exists()){inputGroup=input.closest('.input-group');}}
if(inputGroup.exists()){this.inputGroups[paramName]=inputGroup;}}
return inputGroup;};WikiaForm.prototype.showInputError=function(paramName,msg){var inputGroup=this.getInputGroup(paramName);if(inputGroup){inputGroup.addClass('error');this.showErrorMsg(inputGroup,msg);}};WikiaForm.prototype.clearInputError=function(paramName){var inputGroup=this.getInputGroup(paramName);inputGroup.removeClass('error');this.clearErrorMsg(inputGroup);};WikiaForm.prototype.showErrorMsg=function(inputGroup,msg){var errorMsg=inputGroup.find('.error-msg');if(!errorMsg.length){errorMsg='<div class="error-msg"></div>';inputGroup.append(errorMsg);errorMsg=inputGroup.find('.error-msg');}
errorMsg.text(msg);};WikiaForm.prototype.showSuccessMsg=function(inputGroup,msg){var successMsg=inputGroup.find('.success-msg');if(!successMsg.length){successMsg='<div class="success-msg"></div>';inputGroup.append(successMsg);successMsg=inputGroup.find('.success-msg');}
successMsg.text(msg);};WikiaForm.prototype.clearErrorMsg=function(inputGroup){inputGroup.find('.error-msg').remove();};WikiaForm.prototype.clearSuccessMsg=function(inputGroup){inputGroup.find('.success-msg').remove();};WikiaForm.prototype.clearGenericError=function(inputGroup){inputGroup.hide().find('.error-msg').remove();}
WikiaForm.prototype.clearGenericSuccess=function(inputGroup){inputGroup.hide().find('.success-msg').remove();};!function($){"use strict";var Tooltip=function(element,options){this.init('tooltip',element,options)}
Tooltip.prototype={constructor:Tooltip,init:function(type,element,options){var eventIn,eventOut
this.type=type
this.$element=$(element)
this.options=this.getOptions(options)
this.enabled=true
if(this.options.trigger!='manual'){eventIn=this.options.trigger=='hover'?'mouseenter':'focus'
eventOut=this.options.trigger=='hover'?'mouseleave':'blur'
this.$element.on(eventIn,this.options.selector,$.proxy(this.enter,this))
this.$element.on(eventOut,this.options.selector,$.proxy(this.leave,this))}
this.options.selector?(this._options=$.extend({},this.options,{trigger:'manual',selector:''})):this.fixTitle()},getOptions:function(options){options=$.extend({},$.fn[this.type].defaults,options,this.$element.data())
if(options.delay&&typeof options.delay=='number'){options.delay={show:options.delay,hide:options.delay}}
return options},enter:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type)
if(!self.options.delay||!self.options.delay.show)return self.show()
clearTimeout(this.timeout)
self.hoverState='in'
this.timeout=setTimeout(function(){if(self.hoverState=='in')self.show()},self.options.delay.show)},leave:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type)
if(this.timeout)clearTimeout(this.timeout)
if(!self.options.delay||!self.options.delay.hide)return self.hide()
self.hoverState='out'
this.timeout=setTimeout(function(){if(self.hoverState=='out')self.hide()},self.options.delay.hide)},show:function(){var $tip,inside,pos,actualWidth,actualHeight,placement,tp
if(this.hasContent()&&this.enabled){$tip=this.tip()
this.setContent()
if(this.options.animation){$tip.addClass('fade')}
placement=typeof this.options.placement=='function'?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement
inside=/in/.test(placement)
$tip.remove().css({top:0,left:0,display:'block'}).appendTo(inside?this.$element:document.body)
pos=this.getPosition(inside)
actualWidth=$tip[0].offsetWidth
actualHeight=$tip[0].offsetHeight
switch(inside?placement.split(' ')[1]:placement){case'bottom':tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}
break
case'top':tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}
break
case'left':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}
break
case'right':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}
break}
$tip.css(tp).addClass(placement).addClass('in')}},isHTML:function(text){return typeof text!='string'||(text.charAt(0)==="<"&&text.charAt(text.length-1)===">"&&text.length>=3)||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(text)},setContent:function(){var $tip=this.tip(),title=this.getTitle()
$tip.find('.tooltip-inner')[this.isHTML(title)?'html':'text'](title)
$tip.removeClass('fade in top bottom left right')},hide:function(){var that=this,$tip=this.tip()
$tip.removeClass('in')
function removeWithAnimation(){var timeout=setTimeout(function(){$tip.off($.support.transition.end).remove()},500)
$tip.one($.support.transition.end,function(){clearTimeout(timeout)
$tip.remove()})}
$.support.transition&&this.$tip.hasClass('fade')?removeWithAnimation():$tip.remove()},fixTitle:function(){var $e=this.$element
if($e.attr('title')||typeof($e.attr('data-original-title'))!='string'){$e.attr('data-original-title',$e.attr('title')||'').removeAttr('title')}},hasContent:function(){return this.getTitle()},getPosition:function(inside){return $.extend({},(inside?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var title,$e=this.$element,o=this.options
title=$e.attr('data-original-title')||(typeof o.title=='function'?o.title.call($e[0]):o.title)
return title},tip:function(){return this.$tip=this.$tip||$(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide()
this.$element=null
this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass('in')?'hide':'show']()}}
$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data('tooltip'),options=typeof option=='object'&&option
if(!data)$this.data('tooltip',(data=new Tooltip(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.tooltip.Constructor=Tooltip
$.fn.tooltip.defaults={animation:true,placement:'top',selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:'hover',title:'',delay:0}}(window.jQuery);;var WikiaTracker_ABtests={};;window.WikiaTracker=(function(){var actions={ADD:'add',CLICK:'click',CLICK_LINK_BUTTON:'click-link-button',CLICK_LINK_IMAGE:'click-link-image',CLICK_LINK_TEXT:'click-link-text',IMPRESSION:'impression',PLAY_VIDEO:'play-video',REMOVE:'remove',PAGINATE:'paginate',SUBMIT:'submit',TAKE_SURVEY:'take-survey',VIEW:'view',SHARE:'share'},mainEventName="trackingevent",actionsReverse={};for(var key in actions){actionsReverse[actions[key]]=key;}
function trackEvent(eventName,data,trackingMethod){var logGroup='WikiaTracker.trackEvent',eventName=eventName||mainEventName,data=data||{},trackingMethod=trackingMethod||'none',gaqArgs=[];if(data&&data.href)
event.preventDefault();var ga_category=data['ga_category'],ga_action=data['ga_action'],ga_label=data['ga_label'],ga_value=data['ga_value'];if(trackingMethod=='none'||(trackingMethod in{both:'',ga:''}&&(!ga_category||!ga_action||!actionsReverse[ga_action]))){Wikia.log('Missing or invalid parameters','error',logGroup);return;}
if(ga_category)
gaqArgs.push(ga_category);if(ga_action)
gaqArgs.push(ga_action);if(ga_label)
gaqArgs.push(ga_label);if(ga_value)
gaqArgs.push(ga_value);if(trackingMethod=='internal'||trackingMethod=='both'){Wikia.log(eventName+' '+gaqArgs.join('/')+' [internal track]','info',logGroup);internalTrack(eventName,data);}
if(trackingMethod=='ga'||trackingMethod=='both'){Wikia.log(eventName+' '+gaqArgs.join('/')+' [GA track]','info',logGroup);window.gaTrackEvent(ga_category,ga_action,ga_label,ga_value,true);}
if(data&&data.href){setTimeout(function(){document.location=data.href;},100);}}
function internalTrack(event,data,successCallback,errorCallback,timeout){var logGroup='WikiaTracker.internalTrack';if(!event){Wikia.log('missing required argument: event','error',logGroup);return;}
Wikia.log(event+' [event name]','trace',logGroup);if(data){Wikia.log(data,'trace',logGroup);}
var params={'c':wgCityId,'x':wgDBname,'a':wgArticleId,'lc':wgContentLanguage,'n':wgNamespaceNumber,'u':window.trackID||window.wgTrackID||0,'s':skin,'beacon':window.beacon_id||'','cb':Math.floor(Math.random()*99999)};extendObject(params,data);var head=document.head||document.getElementsByTagName('head')[0]||document.documentElement,script=document.createElement("script"),callbackDelay=200,timeout=timeout||3000,requestUrl='http://a.wikia-beacon.com/__track/special/'+encodeURIComponent(event),requestParameters=[],p;for(p in params)
requestParameters.push(encodeURIComponent(p)+'='+encodeURIComponent(params[p]));requestUrl+='?'+requestParameters.join('&');if("async"in script)
script.async="async";script.src=requestUrl;script.onload=script.onreadystatechange=function(abort){if(abort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode)
head.removeChild(script);script=undefined;var callback;if(!abort&&typeof successCallback=='function')
setTimeout(successCallback,callbackDelay);else if(abort&&typeof errorCallback=='function')
setTimeout(errorCallback,callbackDelay);}};head.insertBefore(script,head.firstChild);if(timeout>0){setTimeout(function(){if(script)
script.onload(true);},timeout);}};function extendObject(obj,ext){for(var p in ext){obj[p]=ext[p];}}
if(typeof wikiaTrackingSpool!=='undefined'){for(var x=0,y=wikiaTrackingSpool.length;x<y;x++){eventData=wikiaTrackingSpool[x];Wikia.log('Sending previously-spooled tracking event','trace','WikiaTracker.trackEvent::spool');Wikia.log(eventData,'trace','WikiaTracker.trackEvent::spool');trackEvent.apply(this,eventData);}
wikiaTrackingSpool=null;}
return{ACTIONS:actions,ACTIONS_REVERSE:actionsReverse,trackEvent:trackEvent};})();WikiaTracker.debug=function(msg,level,obj){Wikia.log(msg,level,'WikiaTracker.debug');return true;};WikiaTracker.track=function(page,profile,events){if(typeof page!='undefined'&&page instanceof Array){page=page.join('/');}
this.debug(page+' in '+profile,3,events);return this._track(page,profile,100,events);};WikiaTracker._track=function(page,profile,sample,events){this.debug(page+' in '+profile+' at '+sample+'%',7);if(page!=null){if(page.indexOf('/')!=0){page='/'+page;}
if(page.indexOf('/999')!=-1){if(page.indexOf('/999/error')!=-1){window.gaTrackAdEvent(profile,page,null,null,true);return true;}
if(page.indexOf('/999/slot')!=-1){window.gaTrackAdEvent(profile,page,null,null,true);return true;}
window.gaTrackAdEvent(profile,page,null,null,true);return true;}
return false;}
return true;};WikiaTracker.trackAdEvent=function(eventName,data,trackingMethod){var logGroup='WikiaTracker.trackAdEvent',gaqArgs=[];var ga_category=data['ga_category'],ga_action=data['ga_action'],ga_label=data['ga_label'],ga_value=data['ga_value'];if(ga_category)
gaqArgs.push(ga_category);if(ga_action)
gaqArgs.push(ga_action);if(ga_label)
gaqArgs.push(ga_label);if(ga_value)
gaqArgs.push(ga_value);if(trackingMethod=='ga'||trackingMethod=='both'){Wikia.log(eventName+' '+gaqArgs.join('/')+' [GA track]','info',logGroup);window.gaTrackAdEvent(ga_category,ga_action,ga_label,ga_value,true);}};WikiaTracker._simpleHash=function(s,tableSize){var i,hash=0;for(i=0;i<s.length;i++){hash+=(s.charCodeAt(i)*(i+1));}
return Math.abs(hash)%tableSize;};WikiaTracker._inGroup=function(hash_id,group_id){return false;};WikiaTracker._userGroup=function(){return null;};WikiaTracker.inGroup=function(group){return false;};WikiaTracker.isTracked=function(){return this.inGroup('N');};WikiaTracker._abData=function(){var in_ab=[];return in_ab;};WikiaTracker.AB=function(page){return true;};;(function(){if(!window.Wikia)window.Wikia={};window.Wikia.geo=geo();window.Geo=window.Wikia.geo;function geo(){var cookieName='Geo',geoData=false;function getGeoData(){if(geoData===false){var jsonData=decodeURIComponent(Wikia.Cookies.get(cookieName));geoData=JSON.parse(jsonData);}
return geoData;}
return{getGeoData:getGeoData}}}());;var AdMeldAPIClient={sizes:[],slots:{'TOP_RIGHT_BOXAD':{size:'300x250',placement:'test_atf',ad:null,pixels:null},'TOP_LEADERBOARD':{size:'728x90',placement:'test_atf',ad:null,pixels:null},'LEFT_SKYSCRAPER_2':{size:'160x600',placement:'test_btf_right',ad:null,pixels:null},'PREFOOTER_LEFT_BOXAD':{size:'300x250',placement:'test_btf',ad:null,pixels:null},'PREFOOTER_RIGHT_BOXAD':{size:'300x250',placement:'test_btf_right',ad:null,pixels:null}}};AdMeldAPIClient.log=function(msg,level){if(typeof window.top.Wikia!=='undefined'&&typeof window.top.Wikia.log==='function'){window.top.Wikia.log(msg,level,'AdMeldAPIClient');}};AdMeldAPIClient.track=function(data,profile){profile=profile||'admeldapiclient';this.log('track '+data.join('/')+' in '+profile,'trace_l3');data[0]='admeldapiclient/'+data[0];var event=data;if(event.length>3){event=[event[0],event[1],event.slice(2).join('/')];}
this.log('event: ['+event.join(', ')+']','trace_l3');};AdMeldAPIClient.getAd=function(slotname){this.log('getAd '+slotname,'trace_l2');try{slotname=slotname.replace('HOME_','');this.log('slotname HOME_'+slotname+' replaced with '+slotname,'trace_l3');}catch(e1){}
try{return this.slots[slotname].ad.creative+this.slots[slotname].pixels.join("\n");}catch(e2){this.log('Error in getAd '+slotname+', returning null','error');this.track(['error','get_ad',slotname],'error');return null;}};AdMeldAPIClient.getBid=function(slotname){this.log('getBid '+slotname,'trace_l2');try{slotname=slotname.replace('HOME_','');this.log('slotname HOME_'+slotname+' replaced with '+slotname,'trace');}catch(e1){}
try{return this.slots[slotname].ad.bid;}catch(e2){this.log('Error in getBid '+slotname+', returning -1','error');this.track(['error','get_bid',slotname],'error');return-1;}};AdMeldAPIClient.init=function(){this.log('init','info');var page=window.top.wgServer+window.top.wgArticlePath.replace('$1',window.top.wgPageName);for(var slot in this.slots){this.log('ask for '+slot+' bid','trace_l3');var s=this.slots[slot];this.log(s,'trace_l3');var url='http://tag.admeld.com/ad/json?publisher_id='+525+'&site_id='+'wikia'+'&placement='+s.placement+'&size='+s.size+'&url='+page+'&callback='+'AdMeldAPIClient.callback'+'&container='+slot;this.log('calling '+url,'trace');this.track(['call',slot]);$.ajax({url:url,dataType:'jsonp',timeout:2000});this.slots[slot].url=url;this.slots[slot].timer=(new Date).getTime();if($.inArray(s.size,this.sizes)==-1){this.sizes.push(s.size);}}};AdMeldAPIClient.callback=function(data){this.log(data,'trace_l3');try{var slot=data.ad.container;this.slots[slot].ad=data.ad;this.slots[slot].pixels=data.pixels;}catch(e){this.log('Error in callback, broken ad','error');this.track(['error','callback','ad'],'error');return false;}
try{var time=(new Date).getTime()-this.slots[slot].timer;this.log('callback '+slot+' after '+time+' ms','trace_l2');this.slots[slot].timer=time;if(time>5000)time=5000;time=(time/1000).toFixed(1);this.track(['callback',slot,time]);}catch(e){this.log('Error in callback, broken timer','error');this.track(['error','callback','timer'],'error');}
try{var bid=this.slots[slot].ad.bid;this.track(['bid',slot,bid.toFixed(3)]);this.slots[slot].ad.bid=(bid*0.875).toFixed(2);}catch(e){this.log('Error in callback, broken bid','error');this.track(['error','callback','bid'],'error');return false;}
return true;};AdMeldAPIClient.adjustLiftiumChain=function(tags){this.log(tags,'trace_l3');try{if(this.sizes.indexOf(tags[0].size)==-1){this.log('adjustLiftiumChain '+tags[0].size+' skipped, no tags for this size','trace_l2');return tags;}
this.log('adjustLiftiumChain '+tags[0].size,'trace_l3');}catch(e){this.log('Error in adjustLiftiumChain','error')
this.track(['error','adjust_liftium_chain'],'error');}
for(var i=0;i<tags.length;i++){var t=tags[i];this.log(t,'trace_l3');if(t.network_id==172){this.log(t,'trace_l3');var slotname=t.criteria.placement[0];try{slotname=slotname.replace('HOME_','');this.log('slotname HOME_'+slotname+' replaced with '+slotname,'trace_l2');}catch(e){}
var bid=this.getBid(slotname);var tier=this.getLiftiumTier(bid);tags[i].tier=tier;tags[i].value=bid;this.log('AdMeld tag #'+t.tag_id+' adjusted to tier '+tier+', value $'+bid,'trace_l2');this.track(['liftium',t.tag_id,tier,bid]);}}
return tags;};AdMeldAPIClient.getLiftiumTier=function(bid){this.log('getLiftiumTier '+bid,'trace_l2');if(bid>=2.00)return 3;if(bid>=1.00)return 4;if(bid>=0.80)return 5;if(bid>=0.65)return 6;if(bid>=0.50)return 7;if(bid>=0.35)return 8;if(bid>=0.20)return 9;return 10;};AdMeldAPIClient.getParamForDART=function(slotname){this.log('getParamForDART '+slotname,'trace_l2');var bid=this.roundBidForDART(this.getBid(slotname));this.track(['dart',slotname,bid]);return'admeld='+bid+';';};AdMeldAPIClient.roundBidForDART=function(bid){this.log('roundBidForDART '+bid,'trace_l2');if(bid>5)bid=5;bid=Math.round(bid*10)/10;bid=bid.toFixed(2);return bid;};if(window.top.wgEnableAdMeldAPIClient){window.top.AdMeldAPIClient.init();};var AdConfig={adSlotsRequiringJSInvocation:{HOME_INVISIBLE_TOP:1,INVISIBLE_TOP:1,INVISIBLE_1:1,INVISIBLE_2:1},geo:null,isHighValueCountry:function(country){country=country.toUpperCase();if(window.wgHighValueCountries){return window.wgHighValueCountries[country]||false;}},isHighValueSlot:function(slotname){switch(slotname){case'CORP_TOP_LEADERBOARD':case'CORP_TOP_RIGHT_BOXAD':case'EXIT_STITIAL_BOXAD_1':case'HOME_INVISIBLE_TOP':case'HOME_TOP_LEADERBOARD':case'HOME_TOP_RIGHT_BOXAD':case'HUB_TOP_LEADERBOARD':case'INVISIBLE_MODAL':case'INVISIBLE_TOP':case'LEFT_SKYSCRAPER_2':case'MIDDLE_RIGHT_BOXAD':case'MODAL_RECTANGLE':case'MODAL_INTERSTITIAL':case'MODAL_VERTICAL_BANNER':case'TEST_HOME_TOP_RIGHT_BOXAD':case'TEST_TOP_RIGHT_BOXAD':case'TOP_LEADERBOARD':case'TOP_RIGHT_BOXAD':return true;default:return false;}},cookie:function(name,value,options){if(arguments.length>1){return Wikia.Cookies.set(name,value,options);}
return Wikia.Cookies.get(name);},init:function(){AdConfig.geo=Wikia.geo.getGeoData();}};AdConfig.DART={adDriverNumCall:null,categories:null,categoryStrMaxLength:500,corporateDbName:'wikiaglobal',hasPrefooters:null,height:null,largeWidth:1024,ord:Math.round(Math.random()*23456787654),size:null,tile:1,width:null,zone1:null,zone2:null,sizeMap:{'300x250':'300x250,300x600','600x250':'600x250,300x250','728x90':'728x90,468x60,980x130,980x65','160x600':'160x600,120x600','0x0':'1x1','300x100':'300x100','120x240':'120x240','242x90':'242x90','320x240':'320x240'},slotMap:{'CORP_TOP_LEADERBOARD':{'tile':2,'loc':'top','dcopt':'ist'},'CORP_TOP_RIGHT_BOXAD':{'tile':1,'loc':'top'},'DOCKED_LEADERBOARD':{'tile':8,'loc':"bottom"},'EXIT_STITIAL_BOXAD_1':{'tile':2,'loc':"exit"},'EXIT_STITIAL_BOXAD_2':{'tile':3,'loc':"exit"},'EXIT_STITIAL_INVISIBLE':{'tile':1,'loc':"exit",'dcopt':"ist"},'FOOTER_BOXAD':{'tile':5,'loc':"footer"},'HOME_INVISIBLE_TOP':{'tile':12,'loc':"invisible"},'HOME_LEFT_SKYSCRAPER_1':{'tile':3,'loc':"top"},'HOME_LEFT_SKYSCRAPER_2':{'tile':3,'loc':"middle"},'HOME_TOP_LEADERBOARD':{'tile':2,'loc':"top",'dcopt':"ist"},'HOME_TOP_RIGHT_BOXAD':{'tile':1,'loc':"top"},'HOME_TOP_RIGHT_BUTTON':{'tile':3,'loc':"top"},'HUB_TOP_LEADERBOARD':{'tile':2,'loc':'top','dcopt':'ist'},'INCONTENT_BOXAD_1':{'tile':4,'loc':"middle"},'INCONTENT_BOXAD_2':{'tile':5,'loc':"middle"},'INCONTENT_BOXAD_3':{'tile':6,'loc':"middle"},'INCONTENT_BOXAD_4':{'tile':7,'loc':"middle"},'INCONTENT_BOXAD_5':{'tile':8,'loc':"middle"},'INCONTENT_LEADERBOARD_1':{'tile':4,'loc':"middle"},'INCONTENT_LEADERBOARD_2':{'tile':5,'loc':"middle"},'INCONTENT_LEADERBOARD_3':{'tile':6,'loc':"middle"},'INCONTENT_LEADERBOARD_4':{'tile':7,'loc':"middle"},'INCONTENT_LEADERBOARD_5':{'tile':8,'loc':"middle"},'INVISIBLE_1':{'tile':10,'loc':"invisible"},'INVISIBLE_2':{'tile':11,'loc':"invisible"},'INVISIBLE_MODAL':{'tile':14,'loc':"invisible"},'INVISIBLE_TOP':{'tile':13,'loc':"invisible"},'JWPLAYER':{'tile':2,'loc':"top"},'LEFT_SKYSCRAPER_1':{'tile':3,'loc':"top"},'LEFT_SKYSCRAPER_2':{'tile':3,'loc':"middle"},'LEFT_SKYSCRAPER_3':{'tile':6,'loc':"footer"},'MIDDLE_RIGHT_BOXAD':{'tile':1,'loc':"middle"},'MODAL_RECTANGLE':{'tile':2,'loc':"modal"},'MODAL_INTERSTITIAL':{'tile':2,'loc':"modal"},'MODAL_VERTICAL_BANNER':{'tile':2,'loc':"modal"},'PREFOOTER_BIG':{'tile':5,'loc':"footer"},'PREFOOTER_LEFT_BOXAD':{'tile':5,'loc':"footer"},'PREFOOTER_RIGHT_BOXAD':{'tile':5,'loc':"footer"},'TOP_BUTTON':{'tile':3,'loc':'top'},'TOP_LEADERBOARD':{'tile':2,'loc':"top",'dcopt':"ist"},'TOP_RIGHT_BOXAD':{'tile':1,'loc':"top"},'TEST_HOME_TOP_RIGHT_BOXAD':{'tile':1,'loc':"top"},'TEST_TOP_RIGHT_BOXAD':{'tile':1,'loc':"top"},'TOP_RIGHT_BUTTON':{'tile':3,'loc':"top"}}};AdConfig.DART.getUrl=function(slotname,size,useIframe,adProvider){var mtfIFPath='',src='',DART=AdConfig.DART,hostname=window.location.hostname;if(DART.sizeMap[size]){size=DART.sizeMap[size];}
switch(adProvider){case'AdDriver':src='driver';break;case'DART':src='direct';mtfIFPath='mtfIFPath=/extensions/wikia/AdEngine/;';break;default:src='liftium';mtfIFPath='mtfIFPath=/extensions/wikia/AdEngine/;';break;}
DART.initSiteAndZones();return'http://'+
DART.getSubdomain()+'.doubleclick.net/'+
DART.getAdType(useIframe)+'/'+
DART.site+'/'+DART.zone1+'/'+DART.zone2+';'+'s0='+DART.site.replace(/wka\./,'')+';'+'s1='+DART.zone1+';'+'s2='+DART.zone2+';'+
DART.getCustomKeyValues()+
DART.getArticleKV()+
DART.getDomainKV(hostname)+
DART.getHostnamePrefix(hostname)+'pos='+slotname+';'+
DART.getTitle()+
DART.getLanguage()+
DART.getResolution()+
DART.getPrefooterStatus()+
(window.wgEnableKruxTargeting&&window.Krux&&window.Krux.dartKeyValues?window.Krux.dartKeyValues:'')+
DART.getImpressionCount(slotname)+
DART.getPartnerKeywords()+
DART.getCategories()+
DART.getLocKV(slotname)+
DART.getDcoptKV(slotname)+
((typeof window.top.wgEnableAdMeldAPIClient!='undefined'&&window.top.wgEnableAdMeldAPIClient)?window.top.AdMeldAPIClient.getParamForDART(slotname):'')+
DART.getCustomVarAB()+
mtfIFPath+'src='+src+';'+'sz='+size+';'+'mtfInline=true;'+
DART.getTileKV(slotname,adProvider)+'endtag=$;'+'ord='+DART.ord+'?';};AdConfig.DART.getMobileUrl=function(slotname,size,useIframe,adProvider){size='5x5';var DART=AdConfig.DART,hostname=window.location.hostname;DART.initSiteAndZones();return'http://'+'ad.mo'+'.doubleclick.net/'+'DARTProxy/mobile.handler?k='+
DART.site+'/'+DART.zone1+'/'+DART.zone2+';'+'s0='+DART.site.replace(/wka\./,'')+';'+'s1='+DART.zone1+';'+'s2='+DART.zone2+';'+
DART.getCustomKeyValues()+
DART.getArticleKV()+
DART.getDomainKV(hostname)+
DART.getHostnamePrefix(hostname)+'pos='+slotname+';'+
DART.getTitle()+
DART.getLanguage()+
DART.getResolution()+
DART.getPrefooterStatus()+
DART.getImpressionCount(slotname)+
DART.getPartnerKeywords()+
DART.getCategories()+
DART.getLocKV(slotname)+
DART.getDcoptKV(slotname)+'positionfixed='+(Features.positionfixed?'css':'js')+';'+'src=mobile;'+'ord='+DART.ord+';'+'sz='+size+';'+'mtfInline=true;'+
DART.getTileKV(slotname,adProvider)+'&dw=1'+'&u='+DART.getUniqueId();};AdConfig.DART.getSubdomain=function(){var subdomain='ad';if(AdConfig.geo){switch(AdConfig.geo.continent){case'AF':case'EU':subdomain='ad-emea';break;case'AS':switch(AdConfig.geo.country){case'AE':case'CY':case'BH':case'IL':case'IQ':case'IR':case'JO':case'KW':case'LB':case'OM':case'PS':case'QA':case'SA':case'SY':case'TR':case'YE':subdomain='ad-emea';break;default:subdomain='ad-apac';}
break;case'OC':subdomain='ad-apac';break;default:subdomain='ad';}}
return subdomain;};AdConfig.DART.getAdType=function(useIframe){if(useIframe==='jwplayer'){return'pfadx';}
if(useIframe){return'adi';}
return'adj';};AdConfig.DART.initSiteAndZones=function(){var DART=AdConfig.DART;if(DART.isWikiaHub()){DART.site=DART.getSite('hub');DART.zone1=DART.getZone1(window.wgWikiaHubType+'_hub');DART.zone2='hub';}
else if(DART.isAutoHub()){var hubsPages=window.wgHubsPages[wgPageName.toLowerCase()];DART.site=DART.getSite(hubsPages['site']);DART.zone1=DART.getZone1(hubsPages['name']);DART.zone2='hub';}
if(!DART.site){DART.site=DART.getSite(window.cityShort);}
if(!DART.zone1){DART.zone1=DART.getZone1(window.wgDBname);}
if(!DART.zone2){DART.zone2=DART.getZone2(window.adLogicPageType);}};AdConfig.DART.isWikiaHub=function(){return!!window.wgWikiaHubType;};AdConfig.DART.isAutoHub=function(){if(wgDBname!=AdConfig.DART.corporateDbName){return false;}
if(!window.wgHubsPages){return false;}
for(var key in window.wgHubsPages){if(typeof key=='object'&&key['name']){key=key['name'];}
if(wgPageName.toLowerCase()==key.toLowerCase()){return true;}}
return false;};AdConfig.DART.getSite=function(hub){return'wka.'+hub;};AdConfig.DART.getZone1=function(dbname){if(typeof dbname!='undefined'&&dbname){return'_'+dbname.replace('/[^0-9A-Z_a-z]/','_');}else{return'_wikia';}};AdConfig.DART.getZone2=function(pageType){if(typeof pageType!='undefined'&&pageType){return pageType;}else{return'article';}};AdConfig.DART.getCustomKeyValues=function(){if(window.wgDartCustomKeyValues){return wgDartCustomKeyValues+';';}
return'';};AdConfig.DART.getArticleKV=function(){if(window.wgArticleId){return"artid="+wgArticleId+';';}else{return'';}};AdConfig.DART.getDomainKV=function(hostname){var lhost,pieces,sld='',np;lhost=hostname.toLowerCase();pieces=lhost.split(".");np=pieces.length;if(pieces[np-2]=='co'){sld=pieces[np-3]+'.'+pieces[np-2]+'.'+pieces[np-1];}else{sld=pieces[np-2]+'.'+pieces[np-1];}
if(sld!==''){return'dmn='+sld.replace(/\./g,'')+';';}else{return'';}};AdConfig.DART.getHostnamePrefix=function(hostname){lhost=hostname.toLowerCase();pieces=lhost.split('.');if(pieces.length){return'hostpre='+pieces[0]+';';}
return'';};AdConfig.DART.getTitle=function(){if(window.wgPageName){return"wpage="+encodeURIComponent(wgPageName.toLowerCase())+";";}else{return"";}};AdConfig.DART.getLanguage=function(){var lang='unknown';if(typeof wgContentLanguage!='undefined'&&wgContentLanguage){lang=wgContentLanguage;}
return'lang='+lang+';';};AdConfig.DART.getResolution=function(){var DART=AdConfig.DART;if(!DART.width||!DART.height){DART.width=document.documentElement.clientWidth||document.body.clientWidth;DART.height=document.documentElement.clientHeight||document.body.clientHeight;}
if(DART.width>DART.largeWidth){return'dis=large;';}else{return'';}};AdConfig.DART.getPrefooterStatus=function(){if(AdConfig.DART.hasPrefooters==null){if(typeof AdEngine!="undefined"){if(AdEngine.isSlotDisplayableOnCurrentPage("PREFOOTER_LEFT_BOXAD")){AdConfig.DART.hasPrefooters="yes";}else{AdConfig.DART.hasPrefooters="no";}}else{AdConfig.DART.hasPrefooters="unknown";}}
return"hasp="+AdConfig.DART.hasPrefooters+";";};AdConfig.DART.getImpressionCount=function(slotname){if(AdConfig.DART.adDriverNumCall==null){var cookie=AdConfig.cookie('adDriverNumAllCall');if(typeof cookie!='undefined'&&cookie){AdConfig.DART.adDriverNumCall=eval('('+cookie+')');}}
if(AdConfig.DART.adDriverNumCall!=null){for(var i=0;i<AdConfig.DART.adDriverNumCall.length;i++){if(AdConfig.DART.adDriverNumCall[i].slotname==slotname){if(parseInt(AdConfig.DART.adDriverNumCall[i].ts)+wgAdDriverCookieLifetime*3600000>wgNow.getTime()){var num=parseInt(AdConfig.DART.adDriverNumCall[i].num);return'impct='+num+';';}}}}
return'';};AdConfig.DART.getPartnerKeywords=function(){var kw='';if(typeof window.partnerKeywords=='undefined'||!window.partnerKeywords){return kw;}
kw='pkw='+encodeURIComponent(window.partnerKeywords)+';';return kw;};AdConfig.DART.initCategories=function(){if(typeof wgCategories!='object'||!wgCategories){AdConfig.DART.categories='';return;}
var categories='';for(var i=0;i<wgCategories.length;i++){categoryStr='cat='+encodeURIComponent(wgCategories[i].toLowerCase().replace(/ /g,'_'))+';';if(categories.length+categoryStr.length<=AdConfig.DART.categoryStrMaxLength){categories+=categoryStr;}}
AdConfig.DART.categories=categories;};AdConfig.DART.getCategories=function(){if(!AdConfig.DART.categories){AdConfig.DART.initCategories();}
return AdConfig.DART.categories;};AdConfig.DART.getLocKV=function(slotname){if(AdConfig.DART.slotMap[slotname]&&AdConfig.DART.slotMap[slotname].loc){return'loc='+AdConfig.DART.slotMap[slotname].loc+';';}else{return'';}};AdConfig.DART.getDcoptKV=function(slotname){if(window.wgUserName&&!window.wgUserShowAds){return'';}
else if(AdConfig.DART.slotMap[slotname]&&AdConfig.DART.slotMap[slotname].dcopt){return'dcopt='+AdConfig.DART.slotMap[slotname].dcopt+';';}else{return'';}};AdConfig.DART.getCustomVarAB=function(){if(typeof window.top.getTreatmentGroup==='function'){var ab=window.top.getTreatmentGroup(1);if(ab==1||ab==2||ab==3){return'ab=e1g'+ab+';';}}
return'';};AdConfig.DART.getTileKV=function(slotname,adProvider){switch(adProvider){case'AdDriver':return'tile='+AdConfig.DART.tile+++';';break;default:if(AdConfig.DART.slotMap[slotname]&&AdConfig.DART.slotMap[slotname].tile){return'tile='+AdConfig.DART.slotMap[slotname].tile+';';}}
return'';};AdConfig.DART.getUniqueId=function(){var wikia_mobile_id=AdConfig.cookie('wikia_mobile_id');if(typeof wikia_mobile_id!='undefined'&&wikia_mobile_id){return wikia_mobile_id;}else{wikia_mobile_id=Math.round(Math.random()*23456787654);AdConfig.cookie('wikia_mobile_id',wikia_mobile_id,{expires:1000*60*60*24*180,path:wgCookiePath,domain:wgCookieDomain});return wikia_mobile_id;}};AdConfig.init();;var AdsCB=Math.floor(Math.random()*99999999);var AdEngine={bodyWrapper:'bodyContent',adColorsContent:[],hidableSlotThreshold1:2400,hidableSlotThreshold2:4000,hidableSlotsThresholds:{},init:function(){AdEngine.hidableSlotsThresholds['LEFT_SKYSCRAPER_2']=AdEngine.hidableSlotThreshold1;AdEngine.hidableSlotsThresholds['LEFT_SKYSCRAPER_3']=AdEngine.hidableSlotThreshold2;AdEngine.hidableSlotsThresholds['PREFOOTER_LEFT_BOXAD']=AdEngine.hidableSlotThreshold1;AdEngine.hidableSlotsThresholds['PREFOOTER_RIGHT_BOXAD']=AdEngine.hidableSlotThreshold1;}};AdEngine.init();AdEngine.resetCssClear=function(side){$("#"+AdEngine.bodyWrapper+" div, #"+AdEngine.bodyWrapper+" table").each(function(){var $this=$(this);if($this.css("float")===side){$this.css("clear",side);}});};AdEngine.getAdColor=function(type){var color;if(typeof window.themename==='string'){if(typeof AdEngine.adColorsContent[window.themename]==='object'){if(typeof AdEngine.adColorsContent[window.themename][type]==='string'){return AdEngine.adColorsContent[window.themename][type];}}}
if(typeof AdEngine.adColorsContent[type]==='string'){return AdEngine.adColorsContent[type];}
if(type==='text'){AdEngine.adColorsContent[type]=AdEngine.normalizeColor($('#article').css('color'));return AdEngine.adColorsContent[type];}
if(type==='link'||type==='url'){color=$('#article a:first').css('color')||$('a:first').css('color');if(color){AdEngine.adColorsContent[type]=AdEngine.normalizeColor(color);}else{AdEngine.adColorsContent[type]='black';}
return AdEngine.adColorsContent[type];}
if(type==='bg'){color=AdEngine.normalizeColor($('#article').css('background-color'));if(color===''||color===window.AdGetColor('text')){color=AdEngine.normalizeColor($('#wikia_page').css('background-color'));}
if(color===''||color==='000000'){color=AdEngine.normalizeColor($("#bodyContent").css('background-color'));}
AdEngine.adColorsContent[type]=color;return AdEngine.adColorsContent[type];}};AdEngine.normalizeColor=function(input){var out,str,rgb;if(input==="transparent"){return"";}
if(input.match(/^#[A-F0-9a-f]{6}$/)){return input.toUpperCase().replace(/^#/,'');}
if(input.match(/^#[A-F0-9a-f]{3}$/)){out=input.toUpperCase();return out[0]+out[0]+out[1]+out[1]+out[2]+out[2];}
if(input.match(/^rgb/)){str=input.replace(/[^0-9,]/g,'');rgb=str.split(",");return AdEngine.dec2hex(rgb[0])+AdEngine.dec2hex(rgb[1])+AdEngine.dec2hex(rgb[2]);}
return input;};AdEngine.dec2hex=function(d){var h=parseInt(d,10).toString(16);if(h.length===1){h='0'+h;}
return h.toUpperCase();};window.AdGetColor=AdEngine.getAdColor;AdEngine.displaySlotIfAd=function(slotname){var noopStrings=['http://images.wikia.com/common/wikia/noad.gif'];var noopFound=false;for(var i=0;i<noopStrings.length;i++){if($('#'+slotname+'_load').html().indexOf(noopStrings[i])>-1){$("#"+slotname+"_load").hide();noopFound=true;break;}}
if(!noopFound){$("#"+slotname).show();}};AdEngine.getKeywords=function(){var metaTags=document.getElementsByTagName('meta');for(var i=0;i<metaTags.length;i++){if(metaTags[i].name=="keywords"){return metaTags[i].content;}}
return'';};AdEngine.getMinuteTargeting=function(){var myDate=new Date();return myDate.getMinutes()%15;};AdEngine.isSlotHidable=function(slotname){return slotname in AdEngine.hidableSlotsThresholds;};AdEngine.isSlotDisplayableOnCurrentPage=function(slotname){if(AdEngine.isSlotHidable(slotname)){if($(document).height()>=AdEngine.hidableSlotsThresholds[slotname]){return true;}
else{return false;}}
return true;};AdEngine.hiddenSlotOnShortPage=function(slotname){if(AdEngine.isSlotHidable(slotname)){if(AdEngine.isSlotDisplayableOnCurrentPage(slotname)){$('#'+slotname).show();return false;}
else{return true;}}
return false;};;var AdProviderOpenX={url:'',url2:''};AdProviderOpenX.getUrl=function(baseUrl,slotname,zoneId,affiliateId,hub,additionalParams){var url=baseUrl;url+="?loc="+escape(window.location);if(typeof document.referrer!="undefined"){url+="&referer="+escape(document.referrer);}
if(typeof document.context!="undefined"){url+="&context="+escape(document.context);}
if(typeof document.mmm_fo!="undefined"){url+="&mmm_fo=1";}
url+="&target=_top";if(typeof AdsCB!="undefined"){url+="&cb="+AdsCB;}else{url+="&cb="+Math.floor(Math.random()*99999999);}
if(typeof document.MAX_used!="undefined"&&document.MAX_used!=","){url+="&exclude="+document.MAX_used;}
url+="&hub="+hub;url+="&skin_name="+skin;url+="&cont_lang="+wgContentLanguage;url+="&user_lang="+wgUserLanguage;url+="&dbname="+wgDBname;url+="&tags="+wgWikiFactoryTagNames.join(",");url+=additionalParams;if(slotname!=''){url+="&slotname="+slotname;}
if(zoneId!=''){url+="&zoneid="+zoneId;}
if(affiliateId!=''){url+="&id="+affiliateId;}
url+="&block=1";AdProviderOpenX.url=url;return AdProviderOpenX.url;};AdProviderOpenX.getUrl2=function(){var url="/__spotlights/spc.php";url+="?zones=14|15|16|17|18|19|20|21|22";url+="&source=";url+="&r="+Math.floor(Math.random()*99999999);url+="&loc="+escape(window.location);if(typeof document.referrer!=="undefined"){url+="&referer="+escape(document.referrer);}
url+="&target=_top";url+="&cb="+Math.floor(Math.random()*99999999);url+="&hub="+window.cityShort;url+="&skin_name="+skin;url+="&cont_lang="+wgContentLanguage;url+="&user_lang="+wgUserLanguage;url+="&dbname="+wgDBname;url+="&tags="+escape(wgWikiFactoryTagNames.join(","));url+="&block=1";url+=(document.charset?'&charset='+document.charset:(document.characterSet?'&charset='+document.characterSet:''));AdProviderOpenX.url2=url;return AdProviderOpenX.url2;};if(!window.wgNoExternals&&window.wgEnableOpenXSPC){setTimeout(function(){$.getScript(AdProviderOpenX.getUrl2(),function(){if(typeof window.spcCallbacks!='undefined'){for(var i=0;i<window.spcCallbacks.length;i++){window[window.spcCallbacks[i]]();}}});},0);};var LazyLoadAds={log:function(msg){$().log(msg,'LazyLoadAds');},settings:{threshhold:200},init:function(){LazyLoadAds.update();$(window).scroll(LazyLoadAds.update);},update:function(){if(!LazyLoadAds.allAds){LazyLoadAds.w=$(window);LazyLoadAds.allAds=[];$(".LazyLoadAd").each(function(i,el){LazyLoadAds.allAds.push($(el));});LazyLoadAds.num=LazyLoadAds.allAds.length;}
var fold=LazyLoadAds.w.height()+LazyLoadAds.w.scrollTop();for(var i=0;i<LazyLoadAds.num;i++){if(LazyLoadAds.allAds[i]){var top=LazyLoadAds.allAds[i].offset().top;if(top>0&&top<(fold+LazyLoadAds.settings.threshhold)){var elemId=LazyLoadAds.allAds[i].attr("id");var adslot=elemId;if($('#'+elemId).get(0).nodeName=='IFRAME'){var fillFunction="fillIframe_"+adslot.replace("_iframe","");}else{var fillFunction="fillElem_"+adslot;}
if(typeof(window[fillFunction])!=='undefined'){window[fillFunction]();window[fillFunction]=false;}
else{LazyLoadAds.log("Warning! "+fillFunction+" does not exist.");}
LazyLoadAds.allAds[i]=false;}}}}};$(function(){LazyLoadAds.init();});;this.ghostwriter=this.ghostwriter||function(){function o(a,d){d=d||{};if(!w){w=true;z=o.htmlstreamparser;e=o.domtree;r=o.domelement;C=o.capabilities;o.fh.set()}if(f)return n(a,d);f=true;var k=a;if(typeof k=="string")k=H.getElementById(k);if(!k)throw Error("Unable to find element "+k+"\nUsage: ghostwriter(element|elementid, options)");a=k;return K(a,d)}function n(a,d){m&&u(i.D,d.script);x[x.length]=Array.prototype.slice.call(arguments);return false}function u(a,d){var k=s(d);flog([a,k,""].join(' "'))}
function K(a,d){function k(p){O.parse(p+"\n")}function D(p){O.parse(p)}function A(p){var I=C.synchronous;P--;m&&!p&&u(i.g,this);I||Q&&Q.parentNode&&Q.parentNode===G&&G.removeChild(Q);p||R("finishscript",this);if(U.length>0){if(!P){p=U.shift();l(p,A);R("startscript",p);P++;M.reset();m&&u(i.f,p);R("onelement",p);M.a&&M.a.element!=p?M.a.appendChild(p):N(p)}}else if(I||p)P<1&&Z&&L();else{o.currload=A;Q=H.createElement("SCRIPT");Q.text="ghostwriter.currload(true)";Q.type="text/javascript";flog("setting local trigger");P++;G.appendChild(Q)}return true}function J(p){if(p){if(p.defer){M.close();return p}if(P&&p.src){U[U.length]=p;M.close("script",false);return p}if(typeof p=="function"){p();m&&flog([i.f,p+"",""].join(" '"));A.call(p,true);return p}P++;var I=false;m&&u(i.f,p);R("startscript",p);if(!p.src){I=C;var S=!(I.synchronous&&I.localonload);if(S){p.setAttribute("type","text/any");p.removeAttribute("language")}else if(I.usedatauri){p.setAttribute("src","data:text/javascript,"+encodeURIComponent(p.text));p.async=true}I=S}I||l(p,A);M.close();if(I){I=p.text;S=E.execScript||eval;try{S(I)}finally{I=true}I&&A.call(p)}return p}}function L(){H.write=T;H.writeln=aa;m&&u(i.o,d.script);R("end",d.script);setTimeout(ba,0);f=false;if(!(x.length<1)){var p=x.shift();m&&u(i.A,p[1].script);o.apply(o,p)}return true}var N=g(a,d.insertType),O=new z({chars:function(p){M.m(p)},start:function(p,I,S){p=p.toLowerCase();for(var $={},W=0,ca=I.length,X=I[W];W<ca;X=I[++W])$[X.name]=X.value;I=$;if(!R("check",p,I))return false;M.add(p,I);S&&M.close(p)},end:function(p){p.toLowerCase()=="script"?J(M.a.element):M.close(p)}}),T=H.write,aa=H.writeln,V=F(d.script),ba=typeof d.done=="function"?d.done:h,R=v(o.handlers||{},d.handlers||{}),M=new e(N,function(){var p=Array.prototype.slice.call(arguments);p.unshift("onelement");R.apply(E,p)}),P=0,U=[],Z=false,Q=null;m&&u(i.start,d.script);H.write=D;D[q]=o[t]("write");H.writeln=k;k[q]=o[t]("writeln");R("begin",d.script);"tagName"in V&&y(M,V);J(V);V=null;Z=true;P<1&&L()}function y(a,d){var k=new r("script",{});k.b=false;k.element=d;k.parentNode=a.a;a.a=k}function v(a,d){var k={begin:[],end:[],onelement:[],check:[],startscript:[],finishscript:[]};B(k,function(D,A){typeof a[D]=="function"&&A.push(a[D]);typeof d[D]=="function"&&A.push(d[D])});return function(D){var A=k[D],J=Array.prototype.slice.call(arguments);J.shift();for(var L=0,N=A.length,O;L<N;L++){try{O=A[L].apply(E,J)}catch(T){flog([i.O,'handler type: "'+D+"'",'callback funtion: "'+A[L]+'"','exception: "'+T+'"'].join("\n"))}if(O!=null&&!O)return O}return true}}function B(a,d){for(var k in a)a.hasOwnProperty(k)&&d.call(a,k,a[k]);return a}function F(a){if(typeof a=="function"||typeof a=="object"&&"nodeType"in a&&"tagName"in a&&a.tagName=="SCRIPT")return a;var d=H.createElement("SCRIPT");if(typeof a=="string")a={src:a};for(var k in a){if(k=="text"||k=="innerText")d.text=a[k];if(typeof a[k]!="object")d[k]=a[k]}return d}function l(a,d){function k(D){D.type=="error"&&flog("uh oh ... script "+a.src+" finished shamefully");if(!(D.type=="readystatechange"&&a.readyState&&a.readyState!="complete"&&a.readyState!="loaded")){if(a.detachEvent){a.detachEvent("onreadystatechange",arguments.callee);a.detachEvent("onerror",arguments.callee)}else if(a.removeEventListener){a.removeEventListener("load",arguments.callee,false);a.removeEventListener("error",arguments.callee,false)}else a.onload=a.onerror=null;d.call(a)}}if(a.attachEvent){a.attachEvent("onreadystatechange",k);a.attachEvent("onerror",k)}else if(a.addEventListener){a.addEventListener("load",k,false);a.addEventListener("error",k,false)}else{a.onload=k;a.onerror=k}}function s(a){var d=typeof a=="function"?a+"":a.src?a.src:a.text;a=a.id||"";var k=d.length;a=a?"(#"+a+") ":"";d=d.replace(/\n/g," ");if(k<=45)return d;return[a,d.substr(0,40),"{...}",d.substr(k-40,k-1)].join("")}var E=this,H=E.document,G=H.G||H.getElementsByTagName("HEAD")[0],q="toString",t="nativeToString",z,e,r,C,x=[],w=false,f=false,m=E.location.hash.toLowerCase().indexOf("gwrdebug")>=0?true:false,h=new Function,g,j=function(a){var d={h:false,q:false,F:false};d.h=/msie/i.test(a);d.q=d.h&&/msie 6/i.test(a);d.F=!d.h&&/firefox/i.test(a);d.opera=!!E.opera;return d}(navigator.userAgent),i=function(a){for(var d in a)a[d]=["ghostwriter.js  >> ",a[d],""].join("");return a}({D:"ENQUEUE script",A:"DEQUEUE script",start:"BEGIN ghostload",o:"FINISHED ghostload",f:"\tattach/execute script",g:"\tloaded/finished script",N:" !!! ERROR !!!!  Error executing handler "});o.queue=x;o.handlers={};o.debug=function(a){return a==null?m:m=a};o.currload=h;o.getscriptidentifier=s;g=function(a){return function(d,k){var D=k in a?a[k]:a.append,A=d.parentNode;return function(J){D(d,J,A)}}}({append:function(a,d){a.appendChild(d)},before:function(a,d,k){if(k=a.parentNode||k)k!=a.parentNode||j.q&&a.nodeType==3&&d.tagName.toLowerCase()=="script"?k.appendChild(d):k.insertBefore(d,a)},after:function(a,d){a.parentNode.insertBefore(d,a.nextSibling)}});return o}();window.flog=function(){var o=new Date;return function(n){n=["#gwr[+",((new Date-o)/100).toFixed(1),"] ",n].join("");typeof Y=="object"&&typeof Y.log=="function"&&Y.log(n);typeof console=="object"&&"log"in console&&console.log(n)}}();ghostwriter.nativeToString=function(){var o="function 00() {\n    [native code]\n}".split(0);return function(n){var u=o.slice();u[1]=n;return function(){return u.join("")}}}();window.ghostwriter.flushloadhandlers=window.ghostwriter.fh=function(o){function n(){x();K();r=true}function u(){if(C)return x;var f,m,h=G.documentElement;if(typeof Element=="object"&&typeof Element.prototype=="object"&&Element.prototype.doScroll)f=Element.prototype;else if(h&&h.doScroll)f=G.documentElement;if(!f)return new Function("return new Function()");m=f.doScroll;f.doScroll=new Function("throw new Error;");return function(){if(f==G.documentElement)G.documentElement.doScroll=m;else f.doScroll=function(){m.call(this)}}}function K(){var f=t;s(f,function(m){var h=f[m];s(h,function(g){g=h[g];g.event&&y(g,m)})})}function y(f,m){var h=m.indexOf("on")==0;f.target.dispatchEvent&&!h?v.apply(this,arguments):B.apply(this,arguments)}function v(f){var m=f.event;f=f.target;var h=G.createEvent("UIEvents"),g=z+m.type;h.H=m;h.initEvent(g,false,false);f.dispatchEvent(h)}function B(f){var m=f.event,h=f.target;if(f=f.s)for(;listener=f.shift();)try{listener.call(h,m)}catch(g){E(w.z,listener+"",g.message)}}
function F(){function f(g){var j=t;return function(i){var a;if(i in j){a=[z+i,h(arguments[1],i),false];H()&&E(w.v,i,this)}else a=Array.prototype.slice.call(arguments);return Function.prototype.apply.call(g,this,a)}}function m(g){var j=t;return function(i,a){if(!(i in j))return Function.prototype.apply.call(g,this,Array.prototype.slice.call(arguments));var d=j[i][this];d=d.s=d.s||[];d[d.length]=a;return true}}function h(g){return function(j){var i=j.target,a=j.H;i.removeEventListener&&i.removeEventListener(j.type,arguments.callee,false);g.call(i,a)}}if(C)return false;l(q,function(g){if(g.addEventListener)g.addEventListener=f.call(g,g.addEventListener);if(g.attachEvent)g.attachEvent=m.call(g,g.attachEvent)})}function l(f,m){for(var h=0,g=f.length;h<g;h++)m.call(f,f[h]);return f}function s(f,m){for(var h in f)f.hasOwnProperty(h)&&m.call(f,h,f[h]);return f}function E(f,m,h){flog([f,' "',m,'" / "',h.toString(),'"'].join(""))}var H=o.ghostwriter.debug,G=document,q=[o,G],t,z="gwrsim",e=o.onload,r=false,C=false,x=new Function,w=function(f){for(var m in f)f[m]=["loadhandlers.js >> ",f[m],""].join("");return f}({B:"Received DOM load event of type ",K:"Registering for event of type ",v:"Adding new event listener ",z:"!!ERROR!! Exception thrown running callback function "});t=function(f,m){function h(j){var i=j.currentTarget||this,a=!j.target,d=a?"on"+j.type:j.type,k=g[d][i];H()&&E(w.B,d,i);if(a)if(document.createEventObject)j=document.createEventObject(j);else{a={};for(var D in j)a[D]=j[D];j=a}else j=j;k.event=j;i.removeEventListener&&i.removeEventListener(d,h,false);i.detachEvent&&!d.indexOf("on")==0&&i.detachEvent(d,h);r&&y(k,d)}var g={};l(f,function(j){l(m,function(i){var a=j;H()&&E(w.K,a,i);if(i.addEventListener){g[a]=g[a]||{};g[a][i]={event:null,target:i};i.addEventListener(a,h,false)}if(i.attachEvent){a="on"+a;g[a]=g[a]||{};g[a][i]={event:null,target:i};i.attachEvent(a,h)}})});return g}("DOMContentLoaded0load0readystatechange".split(0),q);n.set=function(){x=u();for(var f="write0writeln0close0open".split(0),m="flog('Illegal call to document.00(): \"'+ a + '\"')".split(0),h=o.ghostwriter.nativeToString,g=0,j;j=f[g++];){m[1]=j;fn=new Function("a",m.join(""));G[j]=fn;fn.toString=h(j)}F(t);f=o.onload||e;m=G.addEventListener?"load":"onload";o.onload=e=null;if(f)if(o.addEventListener)o.addEventListener(m,f,false);else o.attachEvent&&o.attachEvent(m,f);if(C)return false;else return C=true};n.eventlist=t;o.onload=null;return n}(this);window.ghostwriter.domtree=function(){function o(v){document.body.appendChild(v)}function n(v,B){y=y||K.domelement;var F=this;this.r=typeof v=="function"?v:o;this.n=B||new Function;this.a={tagName:null,appendChild:function(l){F.r(l);return this},close:function(){return this},parentNode:null,ready:function(){return true}};this.a.parentNode=this.a;this.R=null;this.c=0}var u={html:false,head:false,body:false,noscript:true,noembed:true,title:true,meta:true},K=window.ghostwriter,y;n.prototype={m:function(v){var B=y("",v);!this.c&&v!=="\n"&&v!=="\r\n"&&this.a.appendChild(B.element);return this},add:function(v,B){B=typeof B=="undefined"?{}:B;if(v in u){u[v]&&this.c++;return this}else if(this.c)return this;var F=this.a,l=this.a=y(v,B);l.parentNode=F;if(l.ready()){try{this.n(l.element)}catch(s){flog("ERROR executing element add handler: "+s.message)}F.appendChild(l.element)}return this},reset:function(){this.c=0;return this},close:function(v,B){v=v||"";v=v.toLowerCase();if(B==null)B=true;if(v&&v in u&&u[v]&&this.c){this.c--;return this}else if(v&&v in u)return this;else if(this.c)return this;var F=this.a.ready(),l=F||this.a.close()&&this.a.ready();this.a=this.a.parentNode;if(!l)throw Error("attempting to close tag that is not ready");if(B&&!F){try{this.n(l)}catch(s){flog("ERROR executing element add handler: "+s.message)}this.a?this.a.appendChild(l):this.r(l)}return this}};n.prototype.addText=n.prototype.m;n.prototype.add=n.prototype.add;n.prototype.close=n.prototype.close;return n}();window.ghostwriter.domelement=function(){function o(l,s){this.element=u.createTextNode(s);this.b=true;return this}function n(l,s){if(K==this)return new n(l,s);if(!l)return this;this.tagName=l.toUpperCase();this.element=this.create(l,s);this.b=l in B?B[l]:true;return this}var u=document,K=window,y=navigator.userAgent,v=y.indexOf("MSIE")>-1?true:false;y=y.indexOf("WebKit")>-1?true:false;var B={style:false,script:false},F={};n.prototype={setAttribute:function(l,s){return this.element.setAttribute(l,s)},appendChild:function(l){var s=this.element;if(!(s.tagName.toLowerCase()=="script"&&s.src)){if("canHaveChildren"in s&&!s.canHaveChildren){l="data"in l?l.data:l.textContent;if(!l)return false;s.text+=l}else s.appendChild(l);return this}},J:function(){return this.b?this.element:false},close:function(){this.b=true;return this.element},create:function(){function l(q,t){var z=["<"+q];E(t,function(e,r){if(e.toLowerCase().indexOf("on")==0)r=r.replace(/\"/g,"&quot;");z[z.length]=e+'="'+r+'"'});z[z.length]=">";return u.createElement(z.join(" "))}function s(q,t){G=G||window.ghostwriter.htmlstreamparser.Encoder;var z=u.createElement(q);E(t,function(e,r){r=typeof r=="string"?G.htmlDecode(r):r;z.setAttribute(e,r)});return z}function E(q,t){for(var z in q)q.hasOwnProperty(z)&&t.call(q,z,q[z]);return q}var H=v&&(!u.documentMode||u.documentMode<9)?l:s,G=null;return function(q,t){q=q.toLowerCase();t=typeof t=="object"?t:{};return H.call(this,q,t)}}()};n.prototype.setAttribute=n.prototype.setAttribute;n.prototype.appendChild=n.prototype.appendChild;n.prototype.ready=n.prototype.J;n.prototype.close=n.prototype.close;n.prototype.create=n.prototype.create;F.link=function(){var l={};return function(s,E){if(E.href&&E.href in l)return new o("","");l[E.href]=true;return new n(s,E)}}();o.prototype=new n;F[""]=o;v&&function(){function l(){n.apply(this,arguments);return this}function s(q,t){this.k="";this.u=t;this.b=false;return this}function E(){n.apply(this,arguments);this.b=false;return this}E.prototype=new n;s.prototype=new n;l.prototype=new n;l.prototype.appendChild=function(q){if(q.tagName=="TBODY"){this.e=q;this.element.appendChild(q);return this}else if(!this.e){this.e=document.createElement("TBODY");this.element.appendChild(this.e)}this.e.appendChild(q);return this};s.prototype.create=function(q,t){return t};s.prototype.appendChild=function(q){if(q="data"in q?q.data:q.text)this.k+=q};s.prototype.close=function(){var q="STYLE",t=["<span>&nbsp;</span><"+q],z=u.getElementsByTagName("HEAD")[0];return function(){var e=this.u,r=t.slice(),C=u.createElement("DIV");for(var x in e)r[r.length]=[x,'"'+e[x]+'"'].join("=");r[r.length]=[">",this.k,"</",q,">"].join("");C.innerHTML=r.join(" ");e=this.element=C.lastChild;e=e.styleSheet.imports;r=0;for(C=e.length;r<C;r++){x=(new n("LINK",{href:e[r].href.replace(t,""),type:"text/css",rel:"stylesheet"})).close();z.appendChild(x)}this.b=true;return this.element}}();var H={setAttribute:function(q,t){this.element.l[q]=t},appendChild:function(q){if(!q.tagName)return null;if(q.tagName.toUpperCase()==="PARAM"){var t=q.getAttribute("name"),z=this.element.t;if(t)z[t]=q.getAttribute("value")}return this},close:function(){var q=this.element,t=q.l,z=u.createElement("DIV"),e=["<object"];q=q.t;for(var r in t)e[e.length]=[r,'="',t[r],'"'].join("");e[e.length]=">";for(var C in q)e[e.length]=['<PARAM name="',C,'" value="',q[C],'"></PARAM>'].join("");e[e.length]="</object>";z.innerHTML=e.join(" ");this.b=true;return this.element=z.firstChild},create:function(q,t){t.type="application/x-shockwave-flash";return{l:t,t:{}}}};for(var G in H)E.prototype[G]=H[G];F.object=E;F.table=l;F.style=s}();if(y)F.Q=function(){function l(){return n.apply(this,arguments)}l.prototype=new n;l.prototype.create=function(){return u.createElement("noscript")};return l}();return function(l,s){l=l.toLowerCase();return l in F?new F[l](l,s):new n(l,s)}}();window.ghostwriter.htmlstreamparser=function(){function o(e){e=e||{};this.stack=[];this.i="";this.p=e||{};this.I=0;this.P=-1;for(var r=0,C=q.length,x=q[r];r<C;x=q[++r])x in this.p||(e[x]=new Function);this.get=function(){return""}}function n(e){var r={};e=e.split(",");for(var C=0;C<e.length;C++)r[e[C]]=true;return r}var u=/^<(\w+)((?:\s+[\w\-:]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,K=/^<\/(\w+) *[>\n]/,y={L:/^\s*(?:<!--).*/,j:"<!--",C:/--[^>]*>/,M:"--\>"},v=/<!\[CDATA\[(.*?)]]\>/g,B=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,F=n("xml,area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),l=n("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),s=n("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,kbd,label,map,q,s,samp,script,select,small,strike,strong,sub,sup,textarea,tt,u,var"),E=n("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),H=n("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),G=n("script,style,iframe"),q="chars,comment,start,end".split(","),t={};o.prototype={parse:function(e){function r(a,d){d=d.replace(y.L,"").replace(v,"$1");d.length>0&&g.chars(d);return""}function C(a,d,k,D){d=d.toLowerCase();if(l[d])for(;m.d()&&s[m.d()];)x("",m.d());E[d]&&m.d()==d&&x("",d);(D=F[d]||!!D)||m.push(d.toLowerCase());var A=[];k.replace(B,function(J,L,N,O,T){A.push({name:L,value:N?N:O?O:T?T:H[L]?L:""})});g.start(d,A,D)}function x(a,d){if(d){var k=false,D=m.slice();d=d.toLowerCase();for(var A=m.length-1;A>=0;A--)if(m[A]==d){k=true;break}if(k){m.length=A;for(k=D.length-1;k>=A;k--)g.end(D[k])}}}e=this.i+e;var w,f,m=this.stack,h=e,g=this.p,j="",i=0;this.i="";this.get=this.html=function(){return e};this.I++;for(m.d=function(){return this[this.length-1]};e;){j=this.stack[this.stack.length-1];f=true;i++;if(!j||!G[j]){if(e.indexOf(y.j)===0){if(w=y.C.exec(e.substr(y.j.length))){e=e.substr(y.j.length);w=w[0].length>3?w.index+w[0].length-3:w.index;g.comment(e.substr(w));e=e.substring(w+3);f=false}}else if(e.indexOf("</")===0){if(w=e.match(K)){e=e.substring(w[0].length);w[0].replace(K,x);f=false}}else if(e.indexOf("<")===0)if(w=e.match(u)){e=e.substring(w[0].length);w[0].replace(u,C);f=false}else e=e.replace(/^<[^>]*>/,"");if(f){w=e.indexOf("<");f=w<0?e:e.substring(0,w);j=j;e=w<0?"":e.substring(w);j in G||(f=z.htmlDecode(f));f.length>0&&g.chars(f)}}else if(e.indexOf("</")>-1&&e.match(RegExp("</"+j+" *[>\n]","i"))){w=e.length;f=t[j]=t[j]||RegExp("((?:.|\n|\r)*?)</"+j+" *[>\n]","i");e=e.replace(f,r);w>e.length&&x("",j)}if(e==h){this.i=e;return this}h=e}x();return false}};var z=o.Encoder=function(){function e(x,w){var f="";if(w[0]=="#")f=w[1]=="x"?parseInt(w.substr(2),16):parseInt(w.substr(1));else if(w in r)f=r[w];return f?String.fromCharCode(f):x}var r={apos:39,quot:34,amp:38,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,"int":8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830};(function(x){var w={};for(var f in x)w[String.fromCharCode(x[f])]=f;return w})(r);var C=/&(.+?);/g;return{htmlDecode:function(x){return x.replace(C,e)}}}();return o}();window.ghostwriter.loadscripts=function(){function o(){if(!f.length){F()&&flog(m.g);return K()}var h=f.shift()||[],g=h[0],j=h[1],i;if(!h[2]){j.parentNode.replaceChild(g,j);return o()}if(g[r]){x[x.length]=[b,c];w=null;return o()}i={insertType:"before",script:g,done:o};if(j.parentNode===v){i.insertType="append";j=v}w=g;F()&&function(a){flog([m.start,"'",a,"'"].join(""));i.o=function(){flog(m.end);o()}}(l(g));B(j,i);return false}function n(){var h=y.createElement(z);h.text="void null";v.insertBefore(h,v.firstChild)}function u(h){h.className="";var g=E?h.cloneNode(false):y.createElement(z),j=h.attributes,i="";if("cssText"in g.style)g.style.cssText="";if(!E)for(var a=0,d=j.length;a<d;a++){i=j[a];g.setAttribute(i.name,i.value)}g.setAttribute(G,q);g.removeAttribute(t);g.removeAttribute(C);if(h.text)g.text=h.text;return g}function K(){for(var h,g,j=y.getElementsByTagName(z)[0],i=0,a=x.length;i<a;i++){h=u(x[i][0]);h.removeAttribute(e);g=x[i][1];g.parentNode?g.parentNode.replaceChild(h,g):j.parentNode.insertBefore(h,j)}setTimeout(B.flushloadhandlers,0)}var y=document,v=y.getElementsByTagName("HEAD")[0],B=window.ghostwriter,F=B.debug,l=B.getscriptidentifier,s=y.defaultView,E=navigator.userAgent.indexOf("MSIE")>=0,H=s&&s.getComputedStyle?"background-position":"backgroundPositionX",G="type",q="text/javascript",t="language",z="script",e="defer",r=e,C=e+"src",x=[],w=null,f=function(h){for(var g=[],j=0,i=h.length;j<i;j++)g[g.length]=h[j][2];return g}(function(){for(var h=y.getElementsByTagName(z),g=[],j=0,i="";h.length>0;){var a=h[0];i=(a.getAttribute(G)||"").toLowerCase();var d=(a.getAttribute(t)||"").toLowerCase(),k=y.createTextNode(""),D=i.indexOf(r)>=0;i=i.indexOf("javascript")>0||d&&d.indexOf("javascript")>-1||!i;d=a.getAttribute(C)||a.getAttribute("src");var A;if(D){A=parseInt;var J;J=a;var L=H,N=void 0;if(s&&s.getComputedStyle)N=s.getComputedStyle(J,"").getPropertyValue(L);else if(J.currentStyle)N=J.currentStyle[L];J=N||"";A=A(J.split.call(J," "),10)||0}else A=0;A=A;J=D?u(a):a;if(d&&!J.src){J.removeAttribute(C);J.src=d}i||(g[g.length]=[A,j,[J,k,D]]);a.parentNode.replaceChild(k,a);j++}return g}().sort(function(h,g){var j=h[0],i=g[0];if(j==i){j=h[1];i=g[1];return j<i?-1:1}else return j>i?-1:1})),m=function(h){for(var g in h)h[g]=["scriptloader.js >> ",h[g]," text/deferscript "].join("");return h}({start:"Starting ",end:"Complete",w:"BEGIN loading",g:"LOADED all"});F()&&flog(m.w);E&&n();o()};this.ghostwriter.capabilities=function(o){function n(){if(this.readyState&&this.readyState!="complete"&&this.readyState!="loaded")return false;this.onload=this.onreadystatechange=null;return true}var u={synchronous:false,localonload:false,usedatauri:false,complete:false},K=o.G||o.getElementsByTagName("head")[0];(function(){var y=o.createElement("script"),v=o.createElement("script");y.async=v.async=false;y.src="data:text/javascript,void 0";v.text="$gwsynctest= true";K.appendChild(y,K);K.appendChild(v,K);u.synchronous=typeof this.$gwsynctest=="boolean"})();(function(){var y=o.createElement("script"),v;y.onload=y.onreadystatechange=function(){n.apply(this,arguments);u.localonload=true;u.usedatauri=false;u.complete=true;clearTimeout(v)};v=setTimeout(function(){var B=o.createElement("script");B.src="data:text/javascript,void 0";B.onload=B.onreadystatechange=function(){if(n.apply(this,arguments))u.localonload=u.complete=u.usedatauri=true};K.appendChild(B)},1);K.appendChild(y);return false})();return u}(document);;var LiftiumOptions=LiftiumOptions||{};if(!window.Liftium){var Liftium={baseUrl:LiftiumOptions.baseUrl||"http://liftium.wikia.com/",chain:[],currents:[],eventsTracked:0,geoUrl:LiftiumOptions.geoUrl||"http://liftium.wikia.com/",loadDelay:100,maxHops:LiftiumOptions.maxHops||5,slotHops:[],rejTags:[],slotPlacements:[],slotTimeouts:0,slotTimer2:[],hopRegister:[],maxLoadDelay:LiftiumOptions.maxLoadDelay||2500,isCalledAfterOnload:LiftiumOptions.isCalledAfterOnload||0,hasMoreCalls:LiftiumOptions.hasMoreCalls||0,slotnames:[],fingerprint:'a'};Liftium._=function(id){return document.getElementById(id);};Liftium.addEventListener=function(item,eventName,callback){if(window.addEventListener){return item.addEventListener(eventName,callback,false);}
if(window.attachEvent){return item.attachEvent("on"+eventName,callback);}
return false;};Liftium.beaconCall=function(url,cb){var img=new Image(0,0);if(cb!==false){url+='&cb='+Math.random().toString().substring(2,8);}
if(url.length>1000){Liftium.d("Truncating beacon call url to 1000 characters");url=url.substring(0,1000);}
Liftium.d("Beacon call: "+url,7);img.src=url;};Liftium.buildChain=function(slotname){Liftium.slotTimer=Liftium.slotTimer||[];var size=Liftium.getSizeForSlotname(slotname);var now=new Date();Liftium.slotTimer[slotname]=now.getTime();var networks=[];Liftium.chain[slotname]=[];if(window.LiftiumPlacement){Liftium.slotPlacements[slotname]=window.LiftiumPlacement;window.LiftiumPlacement=null;}else{Liftium.slotPlacements[slotname]=LiftiumOptions.placement;LiftiumOptions.placement=null;}
if(size=="1x1"){size="0x0";}
if(Liftium.e(Liftium.config.sizes)||Liftium.e(Liftium.config.sizes[size])){Liftium.reportError("Unrecognized size in Liftium: "+size,"publisher");return false;}
if(typeof window.top.wgEnableAdMeldAPIClient!='undefined'&&window.top.wgEnableAdMeldAPIClient){Liftium.d('Calling AdMeldAPIClient.adjustLiftiumChain for '+size,3);window.top.AdMeldAPIClient.adjustLiftiumChain(Liftium.config.sizes[size]);}
Liftium.setAdjustedValues(Liftium.config.sizes[size]);Liftium.config.sizes[size].sort(Liftium.chainSort);var forcedAd=Liftium.getRequestVal('liftium_tag');if(!Liftium.e(forcedAd)){for(var j=0,l2=Liftium.config.sizes[size].length;j<l2;j++){var tf=Liftium.clone(Liftium.config.sizes[size][j]);if(tf.tag_id==forcedAd){Liftium.d("Forcing tagid #"+forcedAd+" on the front of the chain.",1,tf);Liftium.config.sizes[size][j].inChain=true;Liftium.chain[slotname].push(tf);networks.push(tf.network_name+", #"+tf.tag_id);}}}
for(var i=0,l=Liftium.config.sizes[size].length;i<l;i++){var t=Liftium.clone(Liftium.config.sizes[size][i]);if(Liftium.isValidCriteria(t,slotname)){Liftium.config.sizes[size][i].inChain=true;Liftium.chain[slotname].push(t);networks.push(t.network_name+", #"+t.tag_id);if(t.always_fill==1){Liftium.d("Chain complete - last ad is always_fill",2,networks);break;}else if(Liftium.chain[slotname].length==Liftium.maxHops-1){break;}}else{Liftium.rejTags.push(t.tag_id);}}
if(Liftium.chain[slotname].length===0){Liftium.reportError("Error building chain for "+slotname+".  No matching tags?");WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/no_matching_tags','ga_action':slotname},'ga');return false;}
if(Liftium.chain[slotname][Liftium.chain[slotname].length-1].always_fill!=1){var gAd=Liftium.getAlwaysFillAd(size,slotname);if(gAd!==false){Liftium.chain[slotname].push(gAd);networks.push("AlwaysFill: "+gAd.network_name+", #"+gAd.tag_id);}}
var sampledAd=Liftium.getSampledAd(size);if(sampledAd!==false&&Liftium.isValidCriteria(sampledAd,slotname)&&Liftium.chain[slotname][0].tier!="1"){Liftium.chain[slotname].reverse();Liftium.chain[slotname].push(sampledAd);Liftium.chain[slotname].reverse();networks.push("Sampled: "+sampledAd.network_name+", #"+sampledAd.tag_id);}
Liftium.d("Chain for "+slotname+" = ",3,networks);return true;};Liftium.buildQueryString=function(nvpairs,sep){if(Liftium.e(nvpairs)){return'';}
if(typeof sep=="undefined"){sep='&';}
var out='';for(var name in nvpairs){if(Liftium.e(nvpairs[name])){continue;}
out+=sep+encodeURIComponent(name)+'='+encodeURIComponent(nvpairs[name]);}
return out.substring(sep.length);};Liftium.callAd=function(sizeOrSlot,iframe){if(LiftiumOptions.offline){Liftium.d("Not printing tag because LiftiumOptions.offline is set");return false;}
if(Liftium.e(Liftium.config)){Liftium.reportError("Error downloading config");var t=Liftium.fillerAd(sizeOrSlot,"Error downloading config");document.write(t.tag);return false;}else if(Liftium.config.error){Liftium.reportError("Config error "+Liftium.config.error);var t2=Liftium.fillerAd(sizeOrSlot,Liftium.config.error);document.write(t2.tag);return false;}
var slotname=Liftium.getUniqueSlotname(sizeOrSlot);document.write('<div id="'+slotname+'">');Liftium._callAd(slotname);document.write("</div>");return true;};Liftium._callAd=function(slotname,iframe){Liftium.d("Calling ad for "+slotname,1);var t=Liftium.getNextTag(slotname);if(t===false){t=Liftium.fillerAd(slotname,"getNextTag returned false");if(iframe){Liftium.clearPreviousIframes(slotname);}else{document.write("<!-- Liftium Tag #"+t.tag_id+"-->\n");document.write(t.tag);}
return false;}
Liftium.handleNetworkOptions(t);Liftium.d("Ad #"+t.tag_id+" for "+t.network_name+" called in "+slotname);Liftium.d("Config = ",6,t);try{if(!Liftium.e(iframe)){Liftium.clearPreviousIframes(slotname);Liftium.callIframeAd(slotname,t);}else{Liftium.d("Tag :"+t.tag,5);Liftium.lastTag=t;Liftium.lastSlot=slotname;document.write(t.tag);Liftium.lastTag=null;}}catch(e){Liftium.reportError("Error loading tag #"+t.tag_id+": "+Liftium.print_r(e),"tag");}
return true;};Liftium.callIframeAd=function(slotname,tag,adIframe){Liftium.d("Calling Iframe Ad for "+slotname,1);var iframeUrl=Liftium.getIframeUrl(slotname,tag);if(Liftium.e(iframeUrl)||iframeUrl=="about:blank"){Liftium.d("Skipping No iframe ad called for No Ad for "+slotname,3);return;}
Liftium.slotTimer2[slotname+"-"+tag.tag_id]=Liftium.debugTime();Liftium.d("slotTimer2 begin for #"+tag.tag_id+" in "+slotname,3,Liftium.slotTimer2);if(typeof adIframe=="object"){adIframe.src=iframeUrl;}else{adIframe=document.createElement("iframe");var s=tag.size.split("x");adIframe.src=iframeUrl;adIframe.width=s[0];adIframe.height=s[1];adIframe.scrolling="no";adIframe.frameBorder=0;adIframe.marginHeight=0;adIframe.marginWidth=0;adIframe.allowTransparency=true;adIframe.id=slotname+'_'+tag.tag_id;var fs=tag.tag_name.match(/ [0-9]+x[0-9]+ /);if(fs){fs=fs[0].match(/[0-9]+x[0-9]+/);fs=fs[0].split("x");if(fs[0]==adIframe.width&&fs[1]==adIframe.height){}else{Liftium.d("Forced size "+fs[0]+"x"+fs[1]+" for "+slotname,3);adIframe.className+=" jumbo";adIframe.width=fs[0];adIframe.height=fs[1];var sz=iframeUrl.match(/;sz=[0-9x,]+;/);if(sz){iframeUrl=iframeUrl.replace(/;sz=[0-9x,]+;/,";sz="+fs[0]+"x"+fs[1]+";");Liftium.d("Forced size "+fs[0]+"x"+fs[1]+" in Dart URL: "+iframeUrl,3);adIframe.src=iframeUrl;}}}
Liftium._(slotname).appendChild(adIframe);}};Liftium.callInjectedIframeAd=function(sizeOrSlot,iframeElement){Liftium.d("Calling injected Iframe Ad for "+sizeOrSlot,1);var slotname=Liftium.getContainingDivId(iframeElement);Liftium.d("It's "+iframeElement.id+" inside "+slotname+" div",3);var placement=iframeElement.id.replace(/_iframe$/,"");WikiaTracker.trackAdEvent('liftium.slot',{'ga_category':'slot/'+sizeOrSlot,'ga_action':placement,'ga_label':'liftium'},'ga');var t=Liftium.getNextTag(slotname);if(!t){Liftium.d("no tag found for "+sizeOrSlot+". Collapsing frame.",1);iframeElement.width=0;iframeElement.height=0;return;}
var iframeUrl=Liftium.getIframeUrl(slotname,t);iframeElement.src=iframeUrl;Liftium.slotTimer2[slotname+"-"+t.tag_id]=Liftium.debugTime();Liftium.d("slotTimer2 begin for #"+t.tag_id+" in "+slotname,3,Liftium.slotTimer2);if(iframeUrl=="about:blank"){Liftium.d("Forced size 0x0 for "+slotname,3);iframeElement.width=0;iframeElement.height=0;return;}
var fs=t.tag_name.match(/ [0-9]+x[0-9]+ /);if(fs){fs=fs[0].match(/[0-9]+x[0-9]+/);fs=fs[0].split("x");if(fs[0]==iframeElement.width&&fs[1]==iframeElement.height){return;}
Liftium.d("Forced size "+fs[0]+"x"+fs[1]+" for "+slotname,3);iframeElement.className+=" jumbo";iframeElement.width=fs[0];iframeElement.height=fs[1];var sz=iframeUrl.match(/;sz=[0-9x,]+;/);if(sz){iframeUrl=iframeUrl.replace(/;sz=[0-9x,]+;/,";sz="+fs[0]+"x"+fs[1]+";");Liftium.d("Forced size "+fs[0]+"x"+fs[1]+" in Dart URL: "+iframeUrl,3);iframeElement.src=iframeUrl;}
return;}};Liftium.catchError=function(msg,url,line){try{var jsmsg;if(typeof msg=="object"){jsmsg="Error object: "+Liftium.print_r(msg);}else{jsmsg="Error on line #"+line+" of "+url+" : "+msg;}
Liftium.d("ERROR! "+jsmsg);if(Liftium.e(Liftium.lastTag)){Liftium.reportError(jsmsg,"onerror");}else{Liftium.reportError("Tag error for tag "+Liftium.print_r(Liftium.lastTag)+"\n"+jsmsg,"tag");}
if(!Liftium.e(window.failTestOnError)){window.LiftiumTest.testFailed();alert(msg);}}catch(e){}
return false;};Liftium.chainSort=function(a,b){var a_tier=parseInt(a.tier,10)||0;var b_tier=parseInt(b.tier,10)||0;if(a_tier<b_tier){return-1;}else if(a_tier>b_tier){return 1;}else{var a_value=parseFloat(a.adjusted_value)||0;var b_value=parseFloat(b.adjusted_value)||0;var a_weight=a_value+(a_value*Math.random()*0.75);var b_weight=b_value+(b_value*Math.random()*0.75);return b_weight-a_weight;}};Liftium.clearPreviousIframes=function(slotname){var loadDiv=Liftium._(slotname);if(loadDiv===null){return false;}
var iframes=loadDiv.getElementsByTagName("iframe");for(var i=0,l=iframes.length;i<l;i++){iframes[i].style.display="none";}
return true;};Liftium.clone=function(obj){if(typeof obj=="object"){if(obj==null){Liftium.d("Liftium.clone: obj == null",7);return"";}
var t=new obj.constructor();for(var key in obj){t[key]=Liftium.clone(obj[key]);}
return t;}else{return obj;}};Liftium.crossDomainMessage=function(message){XDM.allowedMethods=["Liftium.iframeHop","LiftiumTest.testPassed"];XDM.executeMessage(message.data);};Liftium.cookie=function(name,value,options){if(arguments.length>1){options=options||{};if(Liftium.e(value)){value='';options.expires=-1;}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var d;if(typeof options.expires=='number'){d=new Date();Liftium.d("Setting cookie expire "+options.expires+" milliseconds from "+d.toUTCString(),7);d.setTime(d.getTime()+(options.expires));}else{d=options.expires;}
expires='; expires='+d.toUTCString();}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';Liftium.d("Set-Cookie: "+[name,'=',encodeURIComponent(value),expires,path,domain,secure].join(''),6);document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');return true;}else{var cookieValue=null;if(!Liftium.e(document.cookie)){var cookies=document.cookie.split(';');for(var i=0,l=cookies.length;i<l;i++){var cookie=cookies[i].replace(/^\s+|\s+$/g,"");if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}};Liftium.debug=function(msg,level,obj){if(Liftium.e(Liftium.debugLevel)){return false;}else if(level>Liftium.debugLevel){return false;}
if(typeof console=="object"&&console.dir){console.log(Liftium.debugTime()+" Liftium: "+msg);if(arguments.length>2){console.dir(obj);}}else if(typeof console=="object"&&console.log){console.log(Liftium.debugTime()+" Liftium: "+msg);if(arguments.length>2){console.log(Liftium.print_r(obj));}}
return true;};Liftium.d=Liftium.debug;Liftium.debugTime=function(){return new Date().getTime()-Liftium.startTime;};Liftium.formatTrackTime=function(t,max){if(isNaN(t)){Liftium.d("Error, time tracked is NaN: "+t,7);return"NaN";}
if(t<0){Liftium.d("Error, time tracked is a negative number: "+t,7);return"negative";}
t=t/1000;if(t>max){return"more_than_"+max;}
return t.toFixed(1);};Liftium.dec2hex=function(d){var h=parseInt(d,10).toString(16);if(h.toString()=="0"){return"00";}else{return h.toUpperCase();}};Liftium.empty=function(v){if(typeof v==='object'){for(var key in v){return false;}
return true;}else{return v===undefined||v===""||v===0||v===null||v===false||(typeof v==="number"&&isNaN(v))||false;}};Liftium.e=Liftium.empty;Liftium.fillerAd=function(size,message){size=size||"300x250";var tag='';if(!Liftium.e(message)){tag+='<div class="LiftiumError" style="display:none">Liftium message: '+message+"</div>";}
if(size.match(/300x250/)){tag+='<a href="http://www.peacecorps.gov/psa/webbanners/click?cid=psa15" target="_blank"><img src="http://www.peacecorps.gov/images/webbanners/full/300x250_legacy.gif" width="300" height="250" border="0" alt="Public Service Announcement"/></a>';}else if(size.match(/728x90/)){tag+='<a href="http://www.peacecorps.gov/psa/webbanners/click?cid=psa1" target="_blank"><img src="http://www.peacecorps.gov/images/webbanners/full/728x90_thinklocal.gif" width="728" height="90" border="0" alt="Public Service Announcement"/></a>';}else if(size.match(/160x600/)){tag+='<a href="http://www.peacecorps.gov/psa/webbanners/click?cid=psa14" target="_blank"><img src="http://www.peacecorps.gov/images/webbanners/full/160x600_legacy.gif" width="160" height="600" border="0" alt="Public Service Announcement"/></a>';}else{tag+='<span style="display: none">No available ads</span>';}
return{tag_id:'psa',network_name:"Internal Error PSA",tag:tag,size:size};};Liftium.getAdColor=function(type){try{switch(type){case"link":var links=document.getElementsByTagName("a");if(Liftium.e(links)){return null;}else{return Liftium.normalizeColor(Liftium.getStyle(links[0],"color"));}
case"bg":return Liftium.normalizeColor(Liftium.getStyle(document.body,"background-color"));case"text":return Liftium.normalizeColor(Liftium.getStyle(document.body,"color"));default:return null;}}catch(e){Liftium.d("Error in Liftium.getAdColor: "+e.message);return null;}};Liftium.getContainingDivId=function(element){var tempElement=element,tries=0;while(tempElement&&tries<10){if(tempElement.tagName=="DIV"&&tempElement.id){return tempElement.id;}else{tempElement=tempElement.parentNode;}
tries++;}
return false;};Liftium.getCookieDomain=function(){var domain=document.domain;var d=domain.match(/(?:wikia(?:-dev)?\.com|wowwiki\.com|wiki\.ffxiclopedia\.org|memory-alpha\.org|websitewiki\.de|yoyowiki\.org|marveldatabase\.com|www\.jedipedia\.de)$/);if(!Liftium.e(d)){domain=d[0];}else{WikiaTracker.trackAdEvent('liftium.varia',{'ga_category':'varia/cookie_domain','ga_action':domain},'ga');}
Liftium.d("cookie domain is "+domain,7);return domain;};Liftium.getPageVar=function(name,defaultVal){return LiftiumOptions['kv_'+name]||defaultVal||'';};Liftium.getStyle=function(element,cssprop){var camelCase=cssprop.replace(/\-(\w)/g,function(all,letter){return letter.toUpperCase();});if(element.currentStyle){return element.currentStyle[camelCase]||"";}else if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(element,"")[camelCase]||"";}else{return element.style[camelCase]||"";}};Liftium.getAlwaysFillAd=function(size,slotname){for(var i=0,l=Liftium.config.sizes[size].length;i<l;i++){var t=Liftium.config.sizes[size][i];if(t.always_fill==1&&Liftium.isValidCriteria(t,slotname)){return Liftium.clone(t);}}
return false;};Liftium.getCountry=function(){if(!Liftium.e(Liftium.getCountryFound)){return Liftium.getCountryFound;}
var ac,geo=Liftium.geo||window.Geo;if(!Liftium.e(Liftium.getRequestVal('liftium_country'))){ac=Liftium.getRequestVal('liftium_country');Liftium.d("Using liftium_country for geo targeting ("+ac+")",8);}else if(Liftium.e(geo)||Liftium.e(geo.country)){Liftium.d("Unable to find a country for this IP, defaulting to unknown");return"unknown";}else{ac=geo.country.toLowerCase();}
if(ac==="gb"){ac="uk";}
Liftium.getCountryFound=ac;return ac;};Liftium.getBrowserLang=function(){var n=window.navigator;var l=n.language||n.systemLanguage||n.browserLanguage||n.userLanguage||"";return l.substring(0,2);};Liftium.getIframeUrl=function(slotname,tag){var m=tag.tag?tag.tag.match(/<iframe[\s\S]+src="([^"]+)"/):null;var iframeUrl;if(m!==null){iframeUrl=m[1].replace(/&amp;/g,"&");Liftium.d("Found iframe in tag, using "+iframeUrl+" for "+slotname,3);}else if(tag.network_name=="No Ad"){Liftium.d("Using about:blank for 'No Ad' to avoid iframe in "+slotname,3);iframeUrl="about:blank";}else if(tag.network_name=="DART"){iframeUrl=window.LiftiumDART.getUrl(Liftium.slotPlacements[slotname],tag.size,tag.network_options,true);}else{var p={"tag_id":tag.tag_id,"size":tag.size,"slotname":slotname,"placement":Liftium.slotPlacements[slotname]};iframeUrl=Liftium.baseUrl+"tag/?"+Liftium.buildQueryString(p);Liftium.d("No iframe found in tag, using "+iframeUrl+" for "+slotname,4);}
return iframeUrl;};Liftium.getMinutesSinceMidnight=function(){var now=new Date();return(now.getHours()*60)+now.getMinutes();};Liftium.getMinutesSinceReject=function(tag_id){var m=Liftium.getTagStat(tag_id,"m");if(m===null){return null;}else{return Liftium.getMinutesSinceMidnight()-m;}};Liftium.getNextTag=function(slotname){if(Liftium.e(Liftium.chain[slotname])){if(Liftium.buildChain(slotname)===false){Liftium.reportError("Error building chain "+slotname,"chain");return false;}}
Liftium.slotHops[slotname]=Liftium.slotHops[slotname]||0;Liftium.slotHops[slotname]++;if(Liftium.slotHops[slotname]>10){Liftium.reportError("Maximum number of hops exceeded: 10","chain");return false;}
var now=new Date();var length=Liftium.chain[slotname].length;var current=Liftium.currents[slotname]||0;var diff=now.getTime()-Liftium.slotTimer[slotname];if(diff>Liftium.maxHopTime){Liftium.d("Liftium.maxHopTime="+Liftium.maxHopTime,5);Liftium.d("Hop Time of "+Liftium.maxHopTime+" exceeded, it's "+diff+" now. Using the always_fill for "+slotname,2);var sec=diff/1000;WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/hop_timeout','ga_action':'slot '+slotname+', net '+Liftium.chain[slotname][current].network_id+', tag '+Liftium.chain[slotname][current].tag_id,'ga_label':sec.toFixed(1)},'ga');Liftium.slotTimeouts++;var lastOne=length-1;Liftium.currents[slotname]=lastOne;Liftium.chain[slotname][lastOne].started=now.getTime();return Liftium.chain[slotname][lastOne];}else{for(var i=current,l=length;i<l;i++){if(!Liftium.e(Liftium.chain[slotname][i].started)){continue;}else{Liftium.chain[slotname][i].started=now.getTime();Liftium.currents[slotname]=i;return Liftium.chain[slotname][i];}}}
Liftium.reportError("No more tags left in the chain - "+slotname+" Last ad in the chain marked as always fill but actually hopped? :"+Liftium.print_r(Liftium.chain[slotname][Liftium.chain[slotname].length-1]),"chain");WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/last_hopped','ga_action':slotname},'ga');return Liftium.fillerAd(slotname,"No more tags left in the chain");};Liftium.getPagesSinceSearch=function(){var kwords=Liftium.getReferringKeywords();if(Liftium.e(kwords)){return null;}
var pagesSince=Liftium.cookie("Lps");if(Liftium.e(pagesSince)){pagesSince=1;}else{pagesSince++;}
Liftium.cookie("Lps",pagesSince);return null;};Liftium.getPropertyCount=function(obj){try{if(typeof obj!="object"){return 0;}
var c=0;for(var property in obj){if(obj.hasOwnProperty(property)){c++;}}
return c;}catch(e){return 0;}};Liftium.getReferrer=function(){return LiftiumOptions.referrer||document.referrer;};Liftium.getReferringKeywords=function(){var l=Liftium.getReferrer(),kwords;var qstring=l.match(/\?(.*)$/);if(Liftium.e(qstring)){qstring=[];}else{qstring=qstring[1];}
var varNames=["q","p","query"];for(var i=0;i<varNames.length;i++){kwords=Liftium.getRequestVal(varNames[i],'',qstring);if(!Liftium.e(kwords)){break;}}
var kwordsCookie=Liftium.cookie("Lrk");if(!Liftium.e(kwords)){Liftium.cookie("Lrk",kwords);return kwords;}else if(!Liftium.e(kwordsCookie)){return kwordsCookie;}else{return null;}};Liftium.getRequestVal=function(varName,defaultVal,qstring){var nvpairs=Liftium.parseQueryString(qstring||document.location.search);if(typeof nvpairs[varName]!="undefined"){return nvpairs[varName];}else if(typeof defaultVal!="undefined"){return defaultVal;}else{return'';}};Liftium.getSampledAd=function(size){var sArray=[],total=0,myRandom=Math.random()*100;for(var i=0,l=Liftium.config.sizes[size].length;i<l;i++){var sample_rate=parseFloat(Liftium.config.sizes[size][i].sample_rate);if(Liftium.e(sample_rate)){continue;}
total+=sample_rate;Liftium.d("Sample Rate for "+Liftium.config.sizes[size][i].tag_id+" is "+sample_rate,7);sArray.push({"upper_bound":total,"index":i});}
Liftium.d("Sample Array = ",7,sArray);for(var j=0,l2=sArray.length;j<l2;j++){if(myRandom<sArray[j].upper_bound){var f=sArray[j].index;return Liftium.clone(Liftium.config.sizes[size][f]);}}
return false;};Liftium.getSlotnameFromElement=function(element){if(typeof element!="object"){return false;}
var tempElement=element,tries=0;while(tempElement&&tries<10){if(tempElement.id&&tempElement.id.match(/^Liftium_/)){return tempElement.id;}else{tempElement=tempElement.parentNode;}
tries++;}
return false;};Liftium.getStatRegExp=function(tag_id){return new RegExp(Liftium.now.getDay()+'_'+tag_id+'l([0-9]+)r*([0-9]*)m*([0-9]*)');};Liftium.getSizeForSlotname=function(slotname){var match=slotname.match(/[0-9]{1,3}x[0-9]{1,3}/);if(match!==null){return match[0];}
for(var slot in Liftium.config.slotnames){if(typeof Liftium.config.slotnames[slot]=="function"){continue;}
if(slot==slotname){return Liftium.config.slotnames[slot];}}
return false;};Liftium.getTagStat=function(tag_id,type){var stat=null;if(Liftium.e(Liftium.tagStats)){Liftium.tagStats=Liftium.getRequestVal("liftium_tag_stats",null)||Liftium.cookie("LTS")||"";}
var statMatch=Liftium.tagStats.match(Liftium.getStatRegExp(tag_id));if(!Liftium.e(statMatch)){var len=statMatch.length;if(type==="l"&&len>=2){stat=statMatch[1];}else if(type==="r"&&len>=3){stat=statMatch[2];}else if(type==="m"&&len>=4){stat=statMatch[3];}else if(type==="a"){var l=parseInt(statMatch[1],0)||0;var r=parseInt(statMatch[2],0)||0;stat=l+r;}}
if(Liftium.e(stat)){if(type=="m"){stat=null;}else{stat=0;}}else{stat=parseInt(stat,10);}
Liftium.d("Stats for "+tag_id+" type "+type+" = "+stat,9);return stat;};Liftium.getUniqueSlotname=function(sizeOrSlot){Liftium.slotnames=Liftium.slotnames||[];var s="Liftium_"+sizeOrSlot+'_'+Liftium.slotnames.length;Liftium.slotnames.push(s);return s;};Liftium.handleNetworkOptions=function(tag){switch(tag.network_id){case"1":for(var opt in LiftiumOptions){if(opt.match(/^google_/)){Liftium.d(opt+" set to "+LiftiumOptions[opt],5);window[opt]=LiftiumOptions[opt];}}
return true;default:return true;}};Liftium.hop=function(slotname){if(Liftium.e(slotname)){slotname=Liftium.lastSlot;}
Liftium.d("Liftium.hop() called for "+slotname);Liftium.markLastAdAsRejected(slotname);return Liftium._callAd(slotname);};var LiftiumHop=Liftium.hop;Liftium.iframeHop=function(iframeUrl){Liftium.d("Liftium.iframeHop() called from "+iframeUrl,3);if(Liftium.in_array(iframeUrl,Liftium.hopRegister)){Liftium.d("Hop from "+iframeUrl+" already registered. Bailing out.",1);WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/last_hopped_2','ga_action':'last_hopped_2'},'ga');Liftium.reportError("Hop from "+iframeUrl+" already registered.");return;}
Liftium.hopRegister.push(iframeUrl);var slotname;var iframes=document.getElementsByTagName("iframe"),found=false,srcs=[];Liftium.d("iframes:",5,iframes);for(var i=0,len=iframes.length;i<len;i++){var id=Math.random();if(!iframes[i].id){iframes[i].id=id;}else{id=iframes[i].id;}
var myframe=Liftium._(id);if(Liftium.e(myframe.src)){Liftium.d("myframe.src for #"+i+" ("+id+") is empty, skipping",7);continue;}
if(iframeUrl.indexOf(myframe.src)>=0){found=true;Liftium.d("found iframe match, #"+i+" ("+id+")",5);slotname=Liftium.getContainingDivId(myframe);Liftium.debug("Slotname from containing div is "+slotname,3);if(Liftium.e(slotname)){Liftium.reportError("Unable to determine slotname from iframe "+iframeUrl);return;}
break;}
srcs.push(myframe.src);}
if(!found){Liftium.reportError("Unable to find iframe for "+iframeUrl+"in : "+srcs.join(", "));return;}
Liftium.d("slotname is "+slotname+" in iframeHop",3);Liftium.markLastAdAsRejected(slotname);Liftium._callAd(slotname,true);};Liftium.iframeContents=function(iframe,html){if(typeof iframe!="object"){return false;}
if(!iframe.doc){if(iframe.contentDocument){iframe.doc=iframe.contentDocument;}else if(iframe.contentWindow){iframe.doc=iframe.contentWindow.document;}else if(iframe.document){iframe.doc=iframe.document;}
iframe.doc.open();iframe.doc.close();}
if(typeof html!="undefined"){iframe.doc.body.style.backgroundColor="blue";var div=iframe.doc.createElement("div");div.id="div42";div.innerHTML=html;iframe.doc.body.appendChild(div);return true;}else{return iframe.doc.getElementById("div42").innerHTML;}};Liftium.in_array=function(needle,haystack,ignoreCase){for(var key in haystack){if(haystack[key]==needle){return true;}else if(ignoreCase&&haystack[key].toString().toLowerCase()==needle.toString().toLowerCase()){return true;}}
return false;};Liftium.init=function(callback){if(Liftium.e(LiftiumOptions.pubid)){return false;}
Liftium.pullGeo();Liftium.pullConfig(callback);Liftium.addEventListener(window,"load",Liftium.onLoadHandler);if(LiftiumOptions.enableXDM!==false){XDM.listenForMessages(Liftium.crossDomainMessage);}
if(BrowserDetect.browser=="Opera"){Liftium.iframeOnload=function(e){var iframe=e.target||e;try{if(typeof iframe.readyState=="undefined"){iframe.readyState="complete";}}catch(err){}};Liftium.addEventListener(window,"DOMFrameContentLoaded",Liftium.iframeOnload);}
if(Liftium.getRequestVal('liftium_exclude_tag')){LiftiumOptions.exclude_tags=[Liftium.getRequestVal('liftium_exclude_tag')];}
WikiaTracker.trackAdEvent('liftium.init',{'ga_category':'init/init','ga_action':'init'},'ga');Liftium.trackQcseg();return true;};Liftium.iframesLoaded=function(){if(Liftium.isCalledAfterOnload&&Liftium.hasMoreCalls){return false;}
var iframes=document.getElementsByTagName("iframe");var l=iframes.length;if(l===0){return true;}
var b=BrowserDetect.browser;if(Liftium.in_array(b,["Firefox","Gecko","Mozilla"])&&!Liftium.isCalledAfterOnload&&Liftium.pageLoaded){return true;}else if(Liftium.in_array(b,["Explorer","Opera"])&&document.readyState=="complete"){for(var i=0;i<l;i++){if(iframes[i].document.readyState!="complete"){return false;}}
if(Liftium.loadDelay<200){return false;}else{return true;}}else{if(Liftium.loadDelay<1000*Liftium.slotnames.length){return false;}else{return true;}}};Liftium.isValidBrowser=function(browser){var obv=BrowserDetect.OS+" "+BrowserDetect.browser+" "+BrowserDetect.version;var reg=new RegExp(browser,"i");if(obv.match(reg)){return true;}else{return false;}};Liftium.isNetworkInChain=function(network_name,slotname){var found=false;for(var k=0;k<Liftium.chain[slotname].length;k++){if(Liftium.chain[slotname][k].network_name==network_name){found=true;break;}}
return found;};Liftium.isValidCountry=function(countryList){var ac=Liftium.getCountry();Liftium.d("Checking if '"+ac+"' is in:",8,countryList);if(Liftium.in_array("row",countryList,true)&&!AdConfig.isHighValueCountry(ac)){Liftium.d("ROW targetted, and country not high-value",8);return true;}
if(Liftium.in_array(ac,countryList,true)){return true;}
return false;};Liftium.isValidCriteria=function(t,slotname){var rejmsg="Ad #"+t.tag_id+" from "+t.network_name+" invalid for "+slotname+": ";if(!Liftium.e(t.inChain)&&!Liftium.e(t.freq_cap)){Liftium.d(rejmsg+"it has a freq cap and is already in another chain",3);return false;}
if(!Liftium.e(LiftiumOptions.exclude_tags)&&Liftium.in_array(t.tag_id,LiftiumOptions.exclude_tags)){Liftium.d(rejmsg+"in LiftiumOptions excluded tags list",2);return false;}
if(!Liftium.e(t.freq_cap)){var a=Liftium.getTagStat(t.tag_id,"a");if(a>=parseInt(t.freq_cap,10)){Liftium.d(rejmsg+a+"attempts is >= freq_cap of "+t.freq_cap,5);return false;}}
if(!Liftium.e(t.rej_time)){var elapsedMinutes=Liftium.getMinutesSinceReject(t.tag_id);if(elapsedMinutes!==null){Liftium.d(" rej_time = "+t.rej_time+" elapsed = "+elapsedMinutes,8);if(elapsedMinutes<parseInt(t.rej_time,10)){Liftium.d(rejmsg+"tag was rejected sooner than rej_time of "+t.rej_time,5);return false;}}}
if(!Liftium.e(t.criteria)){for(var key in t.criteria){switch(key){case'country':if(!Liftium.isValidCountry(t.criteria.country)){Liftium.d(rejmsg+"Invalid country",6);return false;}
break;case'browser':if(!Liftium.isValidBrowser(t.criteria.browser[0])){Liftium.d(rejmsg+"Invalid browser",6);return false;}
break;case'domain':LiftiumOptions.domain=LiftiumOptions.domain||document.domain;if(t.criteria.domain[0]!=LiftiumOptions.domain){Liftium.d(rejmsg+"Invalid domain",6);return false;}
break;case'placement':if(!Liftium.in_array(Liftium.slotPlacements[slotname],t.criteria.placement)){Liftium.d(rejmsg+"Invalid placement ("+Liftium.slotPlacements[slotname]+")",6,t.criteria.placement);return false;}
break;default:if(key.match(/^kv_/)){if(!Liftium.in_array(LiftiumOptions[key],t.criteria[key])){Liftium.d(rejmsg+"key value "+key+" does not match: "+t.criteria[key],6);return false;}}
break;}}}
if(!XDM.canPostMessage()&&Liftium.e(Liftium.config.xdm_iframe_path)&&t.tag.toString().match(/iframe/i)&&t.always_fill!=1){Liftium.reportError("Iframe called on HTML 4 browser for publisher without a xdm_iframe_path. tagid #"+t.tag_id,"tag");return false;}
if(!Liftium.e(t.pacing)&&!Liftium.isValidPacing(t)){Liftium.d(rejmsg+" - pacing criteria not met ("+t.pacing+")",5);return false;}
Liftium.d("Targeting criteria passed for tag #"+t.tag_id,6);return true;};Liftium.isValidPacing=function(tag){return(Math.random()*100)<tag.pacing;};Liftium.loadScript=function(url,noblock,callback){if(typeof noblock=="undefined"){document.write('<scr'+'ipt type="text/javascript" src="'+url+'"><\/sc'+'ript>');return true;}else{if(typeof jQuery=="undefined"||!callback){var h=document.getElementsByTagName("head").item(0);var s=document.createElement("script");s.src=url;h.appendChild(s);return s;}
else{$.getScript(url,callback);return true;}}};Liftium.markChain=function(slotname){Liftium.d("Marking chain for "+slotname,5);if(Liftium.e(Liftium.chain[slotname])){Liftium.debug("Skipping marking chain for "+slotname+", chain was empty");return false;}
for(var i=0,len=Liftium.chain[slotname].length;i<len;i++){if(i<Liftium.currents[slotname]&&Liftium.chain[slotname][i].started){Liftium.chain[slotname][i].rejected=true;}else if(i==Liftium.currents[slotname]){Liftium.chain[slotname][i].loaded=true;break;}}
return i;};Liftium.markLastAdAsRejected=function(slotname){var i=Liftium.currents[slotname];var tag_id=Liftium.chain[slotname][i].tag_id;Liftium.d("Marking last ad as rejected for "+slotname+" (#"+tag_id+")",3);if(typeof i=="undefined"){Liftium.d("No chain for "+slotname+" found. Bailing out.",1);WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/no_chain','ga_action':slotname},'ga');return;}
Liftium.chain[slotname][i].rejected=true;Liftium.setTagStat(tag_id,"r");var time=Liftium.debugTime()-Liftium.slotTimer2[slotname+"-"+tag_id];Liftium.d("slotTimer2 end for #"+tag_id+" in "+slotname+" after "+time+" ms",3);var net_id=Liftium.chain[slotname][i].network_id;WikiaTracker.trackAdEvent('liftium.hop',{'ga_category':'hop/net '+net_id,'ga_action':'tag '+tag_id,'ga_label':Liftium.formatTrackTime(time,5)},'ga');};Liftium.normalizeColor=function(input){input=input||"";if(input=="transparent"){return"";}else if(input.match(/^#[A-F0-9a-f]{6}/)){return input.toUpperCase().replace(/^#/,"");}else if(input.match(/^#[A-F0-9a-f]{3}$/)){var f=input.substring(1,1);var s=input.substring(2,1);var t=input.substring(3,1);var out=f+f+s+s+t+t;return out.toUpperCase();}else if(input.match(/^rgb/)){var str=input.replace(/[^0-9,]/g,'');var rgb=str.split(",");return Liftium.dec2hex(rgb[0])+
Liftium.dec2hex(rgb[1])+
Liftium.dec2hex(rgb[2]);}else{return input.replace(/"/g,"");}};Liftium.onLoadHandler=function(){Liftium.pageLoaded=true;if(Liftium.iframesLoaded()){Liftium.sendBeacon();}else if(Liftium.loadDelay<Liftium.maxLoadDelay){Liftium.loadDelay+=Liftium.loadDelay;window.setTimeout(Liftium.onLoadHandler,Liftium.loadDelay);}else{Liftium.d("Gave up waiting for ads to load, sending beacon now");WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/gave_up_waiting_for_ads','ga_action':'gave_up_waiting_for_ads'},'ga');Liftium.sendBeacon();}};Liftium.parseQueryString=function(qs){var ret=[];if(typeof qs!="string"||qs===""){return ret;}
if(qs.charAt(0)==='?'){qs=qs.substr(1);}
qs=qs.replace(/\;/g,'&',qs);qs=qs.replace(/\+/g,'%20',qs);var nvpairs=qs.split('&');for(var i=0,intIndex;i<nvpairs.length;i++){if(nvpairs[i].length===0){continue;}
var varName='',varValue='';if((intIndex=nvpairs[i].indexOf('='))!=-1){varName=decodeURIComponent(nvpairs[i].substr(0,intIndex));varValue=decodeURIComponent(nvpairs[i].substr(intIndex+1));}else{varName=nvpairs[i];varValue=true;}
ret[varName]=varValue;}
return ret;};Liftium.pullConfig=function(callback){if(Liftium.config){return;}
var p={"pubid":LiftiumOptions.pubid,"v":1.2,"country":Liftium.getCountry()};if(!Liftium.e(LiftiumOptions.config_delay)){p.config_delay=LiftiumOptions.config_delay;p.cb=Math.random();}
if(window.location.hostname.indexOf(".dev.liftium.com")>-1){Liftium.baseUrl='/';}
var u=Liftium.baseUrl+'config?'+Liftium.buildQueryString(p);Liftium.d("Loading config from "+u,2);if(callback){Liftium.loadScript(u,true,callback);}
else{Liftium.loadScript(u);}};Liftium.pullGeo=function(){if(Liftium.geo){return;}
Liftium.d("Loading geo data from cookie",3);var cookie=decodeURIComponent(Liftium.cookie("Geo"));if(!Liftium.e(cookie)){Liftium.geo=eval("("+cookie+")");Liftium.d("Geo data loaded:",7,Liftium.geo);return;}
Liftium.d("Loading geo data from "+Liftium.geoUrl,3);Liftium.loadScript(Liftium.geoUrl);};Liftium.print_r=function(data,level){if(data===null){return"*null*";}
level=level||0;if(level>6){return false;}
var padding='';for(var j=1;j<level+1;j++){padding+=" ";}
switch(typeof data){case"string":return data===""?"*empty string*":data;case"undefined":return"*undefined*";case"boolean":return data===true?"*boolean true*":"*boolean false*";case"function":return"*function*";case"object":var out=[];for(var item in data){if(typeof data[item]=='object'){out.push(padding+"'"+item+"' ..."+"\n");out.push(Liftium.print_r(data[item],level+1));}else{out.push(padding+"'"+item+"' => \""+
Liftium.print_r(data[item])+"\"\n");}}
if(Liftium.e(out)){return"*empty object*";}else{return out.join("");}
default:return data.toString();}};Liftium.recordEvents=function(slotname){var e='';for(var i=0,l=Liftium.chain[slotname].length;i<l;i++){var t=Liftium.chain[slotname][i];if(Liftium.e(t.started)){continue;}
var loads=Liftium.getTagStat(t.tag_id,"l");if(!Liftium.e(Liftium.chain[slotname][i].loaded)){Liftium.d("Recording Load for "+t.network_name+", #"+t.tag_id+" in "+slotname,4);Liftium.setTagStat(t.tag_id,"l");e+=',l'+t.tag_id+'pl'+loads;}else if(!Liftium.e(t.rejected)){e+=',r'+t.tag_id+'pl'+loads;Liftium.d("Recording Reject for "+t.network_name+", #"+t.tag_id+" in "+slotname,5);continue;}}
return e.replace(/^,/,'');};Liftium.reportError=function(msg,type){try{Liftium.d("Liftium ERROR: "+msg);if(Liftium.getBrowserLang()!="en"){}
if(typeof Liftium.errorCount!="undefined"){Liftium.errorCount++;}else{Liftium.errorCount=1;}
if(Liftium.errorCount>5){return;}
var ignores=["Error loading script","Script error.","GA_googleFillSlot is not defined","translate.google","COMSCORE","quantserve","urchin","greasemonkey","Permission denied","Unexpected token ILLEGAL","Access is denied"];for(var i=0;i<ignores.length;i++){if(msg.indexOf(ignores[i])>=0){return;}}
if(type=='onerror'){WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/js','ga_action':msg},'ga');}else{var p={'msg':msg.substr(0,512),'type':type||"general",'pubid':LiftiumOptions.pubid,'lang':"en"};if(type=="tag"){p.tag_id=Liftium.lastTag.tag_id;}
Liftium.beaconCall(Liftium.baseUrl+"error?"+Liftium.buildQueryString(p));}}catch(e){Liftium.d("Yikes. Liftium.reportError has an error");}};Liftium.errorMessage=function(e){if(typeof e=="object"){return Liftium.print_r(e);}else{return e;}};Liftium.sendBeacon=function(){if(!Liftium.e(Liftium.beacon)){return true;}
var throttle;if(Liftium.e(Liftium.config)||throttle===undefined||throttle===null){Liftium.d("No throttle defined, using 1.0");throttle=1.0;}else{throttle=Liftium.config.throttle;}
if(Math.random()>throttle){Liftium.d("Beacon throttled at "+throttle);return true;}
var events='',numSlots=0;for(var slotname in Liftium.chain){if(typeof Liftium.chain[slotname]=="function"){continue;}
numSlots++;Liftium.markChain(slotname);events+=','+Liftium.recordEvents(slotname);}
events=events.replace(/^,/,'');Liftium.storeTagStats();var b={};b.numSlots=numSlots;b.events=events;b.country=Liftium.getCountry();if(Liftium.slotTimeouts>0){b.slotTimeouts=Liftium.slotTimeouts;}
Liftium.d("Beacon: ",7,b);var p;if(!window.JSON){p={"events":b.events};}else{p={"beacon":window.JSON.stringify(b)};}
Liftium.beacon=p;Liftium.beaconCall(Liftium.baseUrl+'beacon?'+Liftium.buildQueryString(p));Liftium.d("Liftium done, beacon sent");WikiaTracker.trackAdEvent('liftium.init',{'ga_category':'init/beacon','ga_action':'beacon'},'ga');if(window.LiftiumTest&&typeof window.LiftiumTest.afterBeacon=="function"){window.LiftiumTest.afterBeacon();}
return true;};Liftium.setAdjustedValues=function(tags){var attempts,reducer=0.05,avalue;for(var i=0;i<tags.length;i++){if(tags[i].adjusted_value){continue;}
avalue=tags[i].value;if(tags[i].pay_type=="CPC"){reducer+=0.20;}
if(parseFloat(tags[i].floor,10)){avalue=avalue*1.01;}
if(tags[i].pay_type=="CPC"&&!Liftium.e(Liftium.getReferringKeywords())){avalue=avalue*1.25;reducer=0;}
attempts=Liftium.getTagStat(tags[i].tag_id,"a");for(var j=0;j<attempts;j++){avalue=avalue-(avalue*reducer);}
if(avalue<tags[i].value*0.15){tags[i].adjusted_value=tags[i].value*0.15;}else{tags[i].adjusted_value=avalue;}}
return tags;};Liftium.setPageVar=function(name,value){LiftiumOptions['kv_'+name]=value;};Liftium.setTagStat=function(tag_id,type){Liftium.d("Setting a "+type+" stat for "+tag_id,6);var pieces=Liftium.tagStats.split(','),holder=[];if(pieces.length>Liftium.statMax){pieces.shift();}
var loads=Liftium.getTagStat(tag_id,"l");var rejects=Liftium.getTagStat(tag_id,"r");var rejectMinutes=0;if(type==="l"){loads++;rejectMinutes=Liftium.getTagStat(tag_id,"m")||0;}else if(type==="r"){rejects++;rejectMinutes=Liftium.getMinutesSinceMidnight();}
var piece=Liftium.now.getDay()+'_'+tag_id+"l"+loads;if(rejects>0){piece=piece+"r"+rejects;piece=piece+"m"+rejectMinutes;}
var ts=Liftium.tagStats.replace(Liftium.getStatRegExp(tag_id),piece);if(ts===Liftium.tagStats){Liftium.tagStats=Liftium.tagStats+','+piece;}else{Liftium.tagStats=ts;}
Liftium.tagStats=Liftium.tagStats.replace(/^,/,'');Liftium.d("Tag Stats After Set = "+Liftium.tagStats,6);Liftium.storeTagStats();};Liftium.storeTagStats=function(){Liftium.d("Stored Tag Stats = "+Liftium.tagStats,6);Liftium.cookie("LTS",Liftium.tagStats,{domain:Liftium.getCookieDomain(),path:"/",expires:86400*1000});};Liftium.trackEvent=function(page,profile){if(typeof page=="object"){page=page.join("/");}
Liftium.d("Track event: "+page,1);var n=window.navigator;Liftium.sessionid=Liftium.sessionid||Math.round(Math.random()*2147483647);page='/'+LiftiumOptions.pubid+'/'+page;var c="__utma="+Liftium.cookie("__utma")+';+__utmz='+Liftium.cookie("__utmz")+';';var p={utmwv:"4.6.5",utmn:Math.round(Math.random()*2147483647),utmhn:"liftium.wikia.com",utmcs:"UTF-8",utmsr:"1024x768",utmsc:"24-bit",utmul:(n.language||n.systemLanguage||n.browserLanguage||n.userLanguage||"").toLowerCase(),utmje:"1",utmfl:"10.0 r32",utmdt:document.title,utmhid:Liftium.sessionid,utmr:"0",utmp:page,utmcc:c};if(typeof profile!="undefined"){p.utmac=profile;Liftium.d("Tracking is using custom profile: "+profile,7);}else{p.utmac="UA-17475676-10";}
var url="https:"==window.location.protocol?"https://ssl.":"http://www.";url+="google-analytics.com/__utm.gif?"+Liftium.buildQueryString(p);Liftium.beaconCall(url,false);};Liftium.buildTrackUrl=function(data){return data.join("/")+"/"+
[Liftium.getPageVar("Hub","unknown"),Liftium.langForTracking(Liftium.getPageVar("cont_lang","unknown")),Liftium.dbnameForTracking(Liftium.getPageVar("wgDBname","unknown")),Liftium.geoForTracking(Liftium.getCountry())].join("/");};Liftium.langForTracking=function(lang){if(!Liftium.in_array(lang,["en","es","de","fr"])){Liftium.d("Wiki lang "+lang+" changed to 'other' for tracking",7);lang="other";}
return lang;};Liftium.dbnameForTracking=function(dbname){if(wgWikiFactoryTagIds!="undefined"&&!Liftium.e(wgWikiFactoryTagIds)&&wgWikiFactoryTagIds.length>4){return dbname;}
Liftium.d("Wiki dbname "+dbname+" changed to 'other' for tracking",7);return"other";};Liftium.geoForTracking=function(country){if(!Liftium.in_array(country,["unknown","us","uk","ca"])){Liftium.d("Country "+country+" changed to 'other' for tracking",7);country="other";}
return country;};Liftium.trackQcseg=function(){c=Liftium.cookie("qcseg");Liftium.d("Quantcast cookie: "+c,5);if(Liftium.e(c)){return;}
if((c.search(/"[DT]"/)!=-1)&&(c.search(/"[0-9]{4}"/)==-1)){return;}
try{qcseg=eval("("+c+")");Liftium.d("Quantcast cookie parsed:",7,qcseg);if(Liftium.e(qcseg.segments)){return;}
var empty=true;for(var i in qcseg.segments){if(typeof qcseg.segments[i]!="object")continue;if(Liftium.e(qcseg.segments[i])){continue;}
if(Liftium.e(qcseg.segments[i].id)){continue;}
Liftium.d("Quantcast segment: "+qcseg.segments[i].id,5);empty=false;}
if(empty){return;}}catch(e){Liftium.d("Quantcast cookie parse error:",7,e);return;}};Liftium.throwError=function(){return window.LiftiumthrowError.UndefinedVar;};var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"";this.OS=this.searchString(this.dataOS)||"";},searchString:function(data){for(var i=0,l=data.length;i<l;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1){return data[i].identity;}}else if(dataProp){return data[i].identity;}}
return null;},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1){return null;}
return parseFloat(dataString.substring(index+this.versionSearchString.length+1));},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();Liftium.loadInspector=function(){var d=Liftium._("LiftiumInspectorScript");if(Liftium.e(d)){var s=Liftium.loadScript(Liftium.baseUrl+"js/Inspector.js?r="+Math.random().toString().substring(2,8),true);s.id="LiftiumInspectorScript";}};var XDM={allowedMethods:[],debugOn:false,iframeUrl:"/liftium_iframe.html",postMessageEnabled:true};XDM.send=function(destWin,method,args){XDM.debug("XDM.send called from "+document.location.hostname);if(typeof method!="string"){XDM.debug("Bad argument for XDM.send, 'method' is not a string, ("+typeof method+")");return false;}
if(typeof args=="undefined"){args=[];}
if(XDM.canPostMessage()){return XDM._postMessage(destWin,method,args);}else{return XDM._postMessageWithIframe(destWin,method,args);}};XDM.getDestinationDomain=function(destWin){if(destWin==top){if(document.referrer.toString()!==''){var m=document.referrer.toString().match(/https*:\/\/([^\/]+)/);XDM.debug("Hostname for destWin set to "+m[1]+" using referrer");return m[1];}else{return false;}}else{return destWin.location.hostname;}};XDM._postMessage=function(destWin,method,args){XDM.debug("Sending message using postMessage()");var d=XDM.getDestinationDomain(destWin),targetOrigin;if(d===false){targetOrigin='*';}else{targetOrigin='http://'+d;}
var msg=XDM.serializeMessage(method,args);if(destWin.postMessage){return destWin.postMessage(msg,targetOrigin);}else if(destWin.document.postMessage){return destWin.document.postMessage(msg,targetOrigin);}else{throw("No supported way of using postMessage");}};XDM._postMessageWithIframe=function(destWin,method,args){XDM.debug("Sending message using iframe");if(XDM.iframeUrl===null){XDM.debug("Iframe method called, but no html file is specified");return false;}
var d=XDM.getDestinationDomain(destWin),targetOrigin;if(d===false){return false;}else{targetOrigin='http://'+d;}
var iframeUrl=targetOrigin+XDM.iframeUrl+'?'+XDM.serializeMessage(method,args);XDM.debug("Calling iframe dispatch url: "+iframeUrl);if(typeof XDM.iframe=="undefined"){XDM.iframe=document.createElement("iframe");XDM.iframe.style.display="none";XDM.iframe.width=0;XDM.iframe.height=0;if(document.body===null){document.firstChild.appendChild(document.createElement("body"));}
document.body.appendChild(XDM.iframe);}
XDM.iframe.src=iframeUrl;return false;};XDM.serializeMessage=function(method,args){var out='method='+escape(method.toString());var x;for(var i=0;i<args.length;i++){x=i+1;out+=';arg'+x+'='+escape(args[i]);}
XDM.debug("Serialized message: "+out);return out;};XDM.canPostMessage=function(){if(XDM.postMessageEnabled===false){return false;}else if(window.postMessage||window.document.postMessage){return true;}else{return false;}};XDM.debug=function(msg){if(XDM.debugOn&&typeof console!="undefined"&&typeof console.log!="undefined"){console.log("XDM debug: "+msg);}};XDM.listenForMessages=function(handler){if(XDM.canPostMessage()){if(window.addEventListener){return window.addEventListener("message",handler,false);}else if(window.attachEvent){return window.attachEvent("onmessage",handler);}else{return false;}}else{return true;}};XDM.isAllowedMethod=function(method){if(typeof method=="undefined"){return false;}
var found=false;for(var i=0;i<XDM.allowedMethods.length;i++){if(method.toString()===XDM.allowedMethods[i]){found=true;break;}}
return found;};XDM.executeMessage=function(serializedMessage){var nvpairs=XDM.parseQueryString(serializedMessage);if(XDM.isAllowedMethod(nvpairs["method"])){var functionArgs=[],code=nvpairs["method"];for(var prop in nvpairs){if(prop.substring(0,3)=="arg"){functionArgs.push(nvpairs[prop].replace(/"/g,'\\"'));}}
if(functionArgs.length>0){code+='("'+functionArgs.join('","')+'");';}else{code+="();";}
if(top!=self){nvpairs.destWin=nvpairs.destWin||"top";code=nvpairs.destWin+"."+code;}
XDM.debug("Evaluating "+code);return eval(code);}else{XDM.debug("Invalid method from XDM: "+nvpairs["method"]);return false;}};XDM.parseQueryString=function(qs){var ret=[];if(typeof qs!="string"){return ret;}
if(qs.charAt(0)==='?'){qs=qs.substr(1);}
qs=qs.replace(/\;/g,'&',qs);var nvpairs=qs.split('&');for(var i=0,intIndex;i<nvpairs.length;i++){if(nvpairs[i].length===0){continue;}
var varName='',varValue='';if((intIndex=nvpairs[i].indexOf('='))!=-1){varName=decodeURIComponent(nvpairs[i].substr(0,intIndex));varValue=decodeURIComponent(nvpairs[i].substr(intIndex+1));}else{varName=nvpairs[i];varValue=true;}
ret[varName]=varValue;}
return ret;};Liftium.now=new Date();if(typeof wgNow!="undefined"){Liftium.now=wgNow;Liftium.d("Using monaco time:",7,wgNow);}
Liftium.startTime=Liftium.now.getTime();Liftium.debugLevel=Liftium.getRequestVal('liftium_debug',0)||Liftium.cookie("liftium_debug");Liftium.maxHopTime=Liftium.getRequestVal('liftium_timeout',0)||Liftium.cookie("liftium_timeout")||1800000;LiftiumOptions.error_beacon=!Liftium.debugLevel&&!Liftium.getRequestVal('liftium_onerror',0)&&!Liftium.cookie("liftium_onerror");if(LiftiumOptions.error_beacon!==false){window.onerror=Liftium.catchError;}}
if(Liftium.empty(LiftiumOptions.offline)&&LiftiumOptions.autoInit!=false){Liftium.init();}
if(LiftiumOptions.callAd){Liftium.callAd(LiftiumOptions.callAd);};window.Athena=window.Athena||(function(Liftium){'use strict';var date=new Date();return{now:date,definedInsideWikiajs:true,getMinuteTargeting:function(){return this.now.getMinutes()%15;},getPageVar:Liftium.getPageVar,setPageVar:Liftium.setPageVar};}(window.Liftium));;window.LiftiumDART=(function(window,$,WikiaTracker,Athena,AdEngine,AdConfig,Liftium,LiftiumOptions,undef){'use strict';var wgPageName=window.wgPageName,wgIsMainpage=window.wgIsMainpage||window.top.wgIsMainpage||false,hasprefooters,width,height,random=Math.round(Math.random()*23456787654),sites={'Auto':'wka.auto','Creative':'wka.crea','Education':'wka.edu','Entertainment':'wka.ent','Finance':'wka.fin','Gaming':'wka.gaming','Green':'wka.green','Humor':'wka.humor','Lifestyle':'wka.life','Music':'wka.music','Philosophy':'wka.phil','Politics':'wka.poli','Science':'wka.sci','Sports':'wka.sports','Technology':'wka.tech','Test Site':'wka.test','Toys':'wka.toys','Travel':'wka.travel'},slotconfig={'TOP_RIGHT_BOXAD':{'tile':1,'loc':"top"},'TOP_LEADERBOARD':{'tile':2,'loc':"top",'dcopt':"ist"},'DOCKED_LEADERBOARD':{'tile':8,'loc':"bottom"},'LEFT_SKYSCRAPER_1':{'tile':3,'loc':"top"},'LEFT_SKYSCRAPER_2':{'tile':3,'loc':"middle"},'LEFT_SKYSCRAPER_3':{'tile':6,'loc':"middle"},'FOOTER_BOXAD':{'tile':5,'loc':"footer"},'PREFOOTER_LEFT_BOXAD':{'tile':5,'loc':"footer"},'PREFOOTER_RIGHT_BOXAD':{'tile':5,'loc':"footer"},'PREFOOTER_BIG':{'tile':5,'loc':"footer"},'HOME_TOP_RIGHT_BOXAD':{'tile':1,'loc':"top"},'HOME_TOP_LEADERBOARD':{'tile':2,'loc':"top",'dcopt':"ist"},'HOME_LEFT_SKYSCRAPER_1':{'tile':3,'loc':"top"},'HOME_LEFT_SKYSCRAPER_2':{'tile':3,'loc':"middle"},'INCONTENT_BOXAD_1':{'tile':4,'loc':"middle"},'INCONTENT_BOXAD_2':{'tile':5,'loc':"middle"},'INCONTENT_BOXAD_3':{'tile':6,'loc':"middle"},'INCONTENT_BOXAD_4':{'tile':7,'loc':"middle"},'INCONTENT_BOXAD_5':{'tile':8,'loc':"middle"},'INCONTENT_LEADERBOARD_1':{'tile':4,'loc':"middle"},'INCONTENT_LEADERBOARD_2':{'tile':5,'loc':"middle"},'INCONTENT_LEADERBOARD_3':{'tile':6,'loc':"middle"},'INCONTENT_LEADERBOARD_4':{'tile':7,'loc':"middle"},'INCONTENT_LEADERBOARD_5':{'tile':8,'loc':"middle"},'EXIT_STITIAL_INVISIBLE':{'tile':1,'loc':"exit",'dcopt':"ist"},'EXIT_STITIAL_BOXAD_1':{'tile':2,'loc':"exit"},'EXIT_STITIAL_BOXAD_2':{'tile':3,'loc':"exit"},'INVISIBLE_1':{'tile':10,'loc':"invisible"},'INVISIBLE_2':{'tile':11,'loc':"invisible"},'HOME_INVISIBLE_TOP':{'tile':12,'loc':"invisible"},'INVISIBLE_TOP':{'tile':13,'loc':"invisible"},'TEST_TOP_RIGHT_BOXAD':{'tile':1,'loc':"top"},'TEST_HOME_TOP_RIGHT_BOXAD':{'tile':1,'loc':"top"}},sizeconfig={'300x250':'300x250','600x250':'600x250,300x250','728x90':'728x90,468x60','160x600':'160x600,120x600','0x0':'1x1','300x53':'300x53'};return{getUrl:function(slotname,size,network_options,iframe){var url2=AdConfig.DART.getUrl(slotname,size,true,'Liftium'),sz=url2.match(/;sz=[0-9x,]+;/),sz2;if(sz){sz2=sz[0].match(/[0-9]+x[0-9]+/);url2=url2.replace(/;sz=[0-9x,]+;/,';sz='+sz2[0]+';');}
Liftium.d("Dart URL2= "+url2,4);return url2;},callAd:function(slotname,size,network_options){var url;if(Liftium.e(slotconfig[slotname])){Liftium.d("Notice: LiftiumDART not configured for "+slotname);}
url=this.getUrl(slotname,size,network_options,false);return'<scr'+'ipt type="text/javascript" src="'+url+'"><\/sc'+'ript>';},getSubdomain:function(){var subdomain='ad';if(!Liftium.e(Liftium.geo.continent)){switch(Liftium.geo.continent){case'AF':case'EU':subdomain='ad-emea';break;case'AS':Liftium.d('country: '+Liftium.getCountry().toUpperCase(),4);switch(Liftium.getCountry().toUpperCase()){case'AE':case'CY':case'BH':case'IL':case'IQ':case'IR':case'JO':case'KW':case'LB':case'OM':case'PS':case'QA':case'SA':case'SY':case'TR':case'YE':subdomain='ad-emea';break;default:subdomain='ad-apac';}
break;case'OC':subdomain='ad-apac';break;default:subdomain='ad';}}
return subdomain;},getAdType:function(iframe){if(iframe){return'adi';}
return'adj';},getDARTSite:function(hub){return sites[hub]||'wka.wikia';},getZone1:function(dbname){if(Liftium.e(dbname)){return'_wikia';}
return'_'+dbname.replace('/[^0-9A-Z_a-z]/','_');},getZone2:function(){if(!Liftium.e(Liftium.getPageVar('page_type'))){return Liftium.getPageVar('page_type');}
return'article';},getTileKV:function(slotname){if(!Liftium.e(slotconfig[slotname])&&slotconfig[slotname].tile){return'tile='+slotconfig[slotname].tile+';';}
return'';},getDcoptKV:function(slotname){if(!Liftium.e(slotconfig[slotname])&&slotconfig[slotname].dcopt){return'dcopt='+slotconfig[slotname].dcopt+';';}
return'';},getLocKv:function(slotname){if(!Liftium.e(slotconfig[slotname])&&slotconfig[slotname].loc){return'loc='+slotconfig[slotname].loc+';';}
return'';},getArticleKV:function(){if(!Liftium.e(Liftium.getPageVar('article_id'))){return"artid="+Liftium.getPageVar('article_id')+';';}
return'';},getTitle:function(){if(!Liftium.e(wgPageName)){return"wpage="+wgPageName+";";}
return"";},getDomainKV:function(hostname){var sld='',lhost=hostname.toLowerCase(),pieces=lhost.split("."),np=pieces.length;if(pieces[np-2]==='co'){sld=pieces[np-3]+'.'+pieces[np-2]+'.'+pieces[np-1];}else{sld=pieces[np-2]+'.'+pieces[np-1];}
if(sld!==''){return'dmn='+sld.replace(/\./g,'')+';';}
return'';},getImpressionCount:function(slotname){var adDriverNumAllCallStorageName='adDriverNumAllCall',storage='',cookieStorage='',i;if(Liftium.e(Liftium.adDriverNumCall)){if(window.wgAdDriverUseExpiryStorage){Liftium.d('Loading AdDriver data from expiry storage');storage=$.expiryStorage.get(adDriverNumAllCallStorageName);}
if(window.wgAdDriverUseCookie){Liftium.d('Loading AdDriver data from cookie');cookieStorage=Liftium.cookie('adDriverNumAllCall');if(Liftium.e(window.wgAdDriverUseExpiryStorage)){storage=cookieStorage;}}
if(!Liftium.e(storage)){try{Liftium.adDriverNumCall=JSON.parse(storage);Liftium.d('AdDriver data loaded:',7,Liftium.AdDriverNumCall);}catch(e){Liftium.d('AdDriver data load failed',1);WikiaTracker.track([LiftiumOptions.pubid,'error','impctparse',slotname],'liftium.errors');}}
if(window.wgAdDriverUseExpiryStorage&&window.wgAdDriverUseCookie){if(storage!==cookieStorage){WikiaTracker.track([LiftiumOptions.pubid,"error","impctoutofsync",slotname],'liftium.errors');}}}
if(!Liftium.e(Liftium.adDriverNumCall)){for(i=0;i<Liftium.adDriverNumCall.length;i+=1){if(Liftium.adDriverNumCall[i].slotname===slotname){if(parseInt(Liftium.adDriverNumCall[i].ts,10)+window.wgAdDriverCookieLifetime*3600000>Liftium.now.getTime()){return'impct='+parseInt(Liftium.adDriverNumCall[i].num,10)+';';}}}}
return'';},getResolution:function(){if(Liftium.e(width)||Liftium.e(height)){width=document.documentElement.clientWidth||document.body.clientWidth;height=document.documentElement.clientHeight||document.body.clientHeight;Liftium.d("resolution: "+width+"x"+height,7);}
if(width>1024){return'dis=large;';}
return'';},getPrefooterStatus:function(){if(Liftium.e(hasprefooters)){if(AdEngine===undef){if(AdEngine.isSlotDisplayableOnCurrentPage("PREFOOTER_LEFT_BOXAD")){hasprefooters="yes";}else{hasprefooters="no";}}else{hasprefooters="unknown";}}
Liftium.d("has prefooters: "+hasprefooters,7);return"hasp="+hasprefooters+";";},getAllDartKeyvalues:function(slotname){var d=Liftium.getPageVar('dart',''),out='s0='+this.getDARTSite(Liftium.getPageVar('Hub')).replace(/wka\./,'')+';'+'s1='+this.getZone1(Liftium.getPageVar('wgDBname'))+';'+'s2='+this.getZone2()+';'+'@@WIKIA_PROVIDER_VALUES@@'+
this.getLocKv(slotname)+
this.getArticleKV()+
this.getDomainKV(Liftium.getPageVar('domain'))+'pos='+slotname+';';out=out.replace(/@@WIKIA_AQ@@/,Athena.getMinuteTargeting());if(!Liftium.e(d)){out=out.replace(/@@WIKIA_PROVIDER_VALUES@@/,d+';');}
return out;}};}(window,window.jQuery,window.WikiaTracker,window.Athena,window.AdEngine,window.AdConfig,window.Liftium,window.LiftiumOptions));;window.AQ=window.AQ||(function(window,Athena,undef){'use strict';var inIframe=(window.top!==window),AQ=this;return{eventUrls:[],chain:{},allTags:{},cwpid:504082,priceFloor:0,tries:0,next:function(slotgroup){Athena.d("AQ.next called with "+slotgroup,3);Athena.d("AQ.chain for "+slotgroup+": "+Athena.print_r(AQ.chain[slotgroup]),5);var i,nexti=0;for(i=AQ.chain[slotgroup].length-1;i>=0;i-=1){if(!Athena.e(AQ.chain[slotgroup][i].skipped)){nexti=i+1;break;}else if(!Athena.e(AQ.chain[slotgroup][i].attempt)){AQ.beacon(AQ.chain[slotgroup][i].id,'reject');AQ.chain[slotgroup][i].reject=true;Athena.d("AQ tag #"+AQ.chain[slotgroup][i].id+" rejected in "+slotgroup,3);nexti=i+1;break;}}
if(nexti>AQ.chain[slotgroup].length-1){Athena.d("AQ: End of ContextWeb chain",5);if(inIframe){Athena.iframeHop(AQ.win.location);}else{Athena.hop();}}else{Athena.debug("AQ.next calling tag #"+AQ.chain[slotgroup][nexti].id+" with a value of "+AQ.chain[slotgroup][nexti].fValue,3);AQ.tag(slotgroup,AQ.chain[slotgroup][nexti].id);}},beacon:function(cwtagid,action){if(Athena.rand<0.5){return;}
var url=Athena.baseUrl+'event/set?event=contextWebBeacon&cwtagid='+cwtagid+'&action='+action;Athena.d("AQ event beacon url: "+url,3);AQ.eventUrls.push(url);Athena.beaconCall(url);},checkForLoad:function(slotgroup){var i,recall;Athena.d("AQ.checkForLoad called for "+slotgroup,4);if(Athena.e(window.strCreative)){if(AQ.tries<100){recall="AQ.checkForLoad('"+slotgroup+"');";Athena.d("AQ: Recalling "+recall+" in 100 ms",6);window.setTimeout(recall,100);AQ.tries+=1;}else{Athena.d("Giving up after 100 tries in AQ.checkForLoad");}
return;}
for(i=AQ.chain[slotgroup].length-1;i>=0;i-=1){if(!Athena.e(AQ.chain[slotgroup][i].attempt)){if(Athena.e(AQ.chain[slotgroup][i].reject)){AQ.beacon(AQ.chain[slotgroup][i].id,'load');AQ.chain[slotgroup][i].load=true;Athena.d("AQ tag #"+AQ.chain[slotgroup][i].id+" loaded in "+slotgroup,3);}
break;}}},randomTag:function(slotgroup,win){var i,j,found,r,oldChain,chooseFrom=[];AQ.randomTagCalled=true;for(i=0;i<AQ.allTags[slotgroup].length;i+=1){found=false;for(j=0;j<AQ.chain[slotgroup].length;j+=1){if(AQ.allTags[slotgroup][i].id===AQ.chain[slotgroup][j].id){found=true;break;}}
if(!found){chooseFrom.push(Athena.clone(AQ.allTags[slotgroup][i]));}}
if(Athena.e(chooseFrom)){AQ.tag(slotgroup,AQ.chain[slotgroup][0].id,win);return;}
r=Math.floor(Math.random()*chooseFrom.length);Athena.d("AQ.randomTag calling tag "+r+" in the chain for "+slotgroup,2);oldChain=AQ.chain[slotgroup];AQ.chain[slotgroup]=[];AQ.chain[slotgroup].push(Athena.clone(chooseFrom[r]));AQ.chain[slotgroup][0].random=true;AQ.chain[slotgroup].push(Athena.clone(oldChain[0]));AQ.chain[slotgroup].push(Athena.clone(oldChain[1]));AQ.tag(slotgroup,AQ.chain[slotgroup][0].id,win);},tag:function(slotgroup,cwtagid,win){var i,currenti,size,w,h,cwurl,cwpage,cwp;if(win===undef){AQ.win=win;}
Athena.d("AQ.tag called for "+slotgroup+" with tag #"+cwtagid,3);AQ.lastTag=cwtagid;for(i=0;i<AQ.chain[slotgroup].length;i+=1){if(AQ.chain[slotgroup][i].id===cwtagid){currenti=i;break;}}
switch(slotgroup){case'MR':size="300x250";w=300;h=250;break;case'LB':size="728x90";w=728;h=90;break;case'WS':size="160x600";w=160;h=600;break;default:document.write('<!-- Invalid slotgroup for AQ.tag -->');return false;}
try{cwpage="http://"+Athena.getPageVar("hostname")+Athena.getPageVar("request");}catch(e){if(inIframe&&!Athena.e(document.referrer)){cwpage=document.referrer;}}
cwurl='http://tag.contextweb.com/TAGPUBLISH/getad.aspx';cwp={"tagver":1,"if":0,"ca":"VIEWAD","cp":AQ.cwpid,"ct":cwtagid,"cf":size,"cn":1,"cr":200,"cw":w,"ch":h,"cads":0,"rq":1,"cwu":cwpage,"mrnd":Athena.rand};cwurl+='?'+Athena.buildQueryString(cwp,'&');AQ.beacon(cwtagid,'attempt');AQ.chain[slotgroup][currenti].attempt=true;if(currenti===0){window.setTimeout(function(){AQ.checkForLoad(slotgroup);},750*AQ.chain[slotgroup].length);}
AQ.win.document.write('<script type="text/javascript" src="'+cwurl+'"><\/scr'+'ipt>');AQ.win.document.write('<script><\/script>');return true;}};}(window,window.top.Athena));window.AQNext=window.AQ.next;;window.meerkat=(function($){'use strict';return function(options){this.settings={close:'none',dontShow:'none',meerkatPosition:'bottom',animationSpeed:'slow',height:'auto',background:'none'};if(options){$.extend(this.settings,options);}
var settings=this.settings;$('html, body').css({'margin':'0','padding':'0','height':'100%'});$('#meerkat').show();$('#meerkat-wrap').css({'position':'fixed','width':'100%','height':settings.height,'left':0,'z-index':1000}).css(settings.meerkatPosition,'0');$('#meerkat-container').css({'background':settings.background,'height':settings.height});$(settings.close+','+settings.dontShow).css({'cursor':'pointer'});$('#meerkat-wrap').hide().slideDown(settings.animationSpeed);$(settings.close).click(function(){$('#meerkat-wrap').slideUp();});$(settings.dontShow).click(function(){$("#meerkat-wrap").slideUp();});};}(window.jQuery));;window.ve_alternate=(function(Athena){'use strict';return function(div){div.style.display="none";Athena.hop();};}(window.Athena));;var AIC2={$placeHolder:$('#WikiaAdInContentPlaceHolder'),fingerprint:'b',called:false,startPosition:0,stopPosition:0,magicNumber:800,isRightToLeft:false,visible:false};AIC2.init=function(){var $window=$(window);Liftium.d("AIC2: init",5);if($('body').hasClass('rtl')){Liftium.d("AIC2: rtl wiki",7);WikiaTracker.trackAdEvent('liftium.varia',{'ga_category':'varia/AIC2','ga_action':'rtl'},'ga');AIC2.isRightToLeft=true;}
if($window.width()<1010){Liftium.d("AIC2: window too narrow, bailing out",3);WikiaTracker.trackAdEvent('liftium.varia',{'ga_category':'varia/AIC2','ga_action':'too narrow'},'ga');return;}
if(!AIC2.checkStartStopPosition()){return;}
if(AIC2.startPosition+AIC2.magicNumber<AIC2.stopPosition){Liftium.d("AIC2: page long enough",7);AIC2.$placeHolder.append('<div id="INCONTENT_BOXAD_1" class="noprint" style="height: 250px; width: 300px; position: relative;"><div id="Liftium_300x250_99"><iframe width="300" height="250" id="INCONTENT_BOXAD_1_iframe" class="" noresize="true" scrolling="no" frameborder="0" marginheight="0" marginwidth="0" style="border:none" target="_blank"></iframe></div></div><!-- END SLOTNAME: INCONTENT_BOXAD_1 -->');$window.bind("scroll.AIC2",AIC2.onScroll);$window.bind("resize.AIC2",AIC2.onScroll);}else{Liftium.d("AIC2: page too short",3);WikiaTracker.trackAdEvent('liftium.varia',{'ga_category':'varia/AIC2','ga_action':'too short'},'ga');}};AIC2.checkStartStopPosition=function(){var startPosition,stopPosition,adHeight,$footer=$('#WikiaFooter'),$leftSkyScraper=$('#LEFT_SKYSCRAPER_3'),$incontentBoxAd=$('#INCONTENT_BOXAD_1');Liftium.d("AIC2: check start/stop position",7);if(!AIC2.$placeHolder.length){Liftium.d("AIC2: no rail",3);WikiaTracker.trackAdEvent('liftium.varia',{'ga_category':'varia/AIC2','ga_action':'no rail'},'ga');return false;}
try{adHeight=parseInt($incontentBoxAd.height(),10)||0;startPosition=parseInt(AIC2.$placeHolder.offset().top,10);stopPosition=parseInt($footer.offset().top,10)-10-adHeight;if($leftSkyScraper.length&&$leftSkyScraper.height()>50){Liftium.d("AIC2: sky3 found",3);stopPosition=parseInt($leftSkyScraper.offset().top,10)-20-adHeight;}}catch(e){Liftium.d("AIC2: catched in start/stop:",1,e);WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/AIC2','ga_action':'try-catch'},'ga');return false;}
Liftium.d("AIC2: start/stop old/new",7,[AIC2.startPosition,AIC2.stopPosition,startPosition,stopPosition]);if(!AIC2.startPosition&&!AIC2.stopPosition){AIC2.startPosition=startPosition;AIC2.stopPosition=stopPosition;Liftium.d("AIC2: start/stop position set up",7);return true;}
if(AIC2.isAlmostEqual(AIC2.startPosition,startPosition)&&AIC2.isAlmostEqual(AIC2.stopPosition,stopPosition)){Liftium.d("AIC2: start/stop position correct",7);return true;}
AIC2.startPosition=startPosition;AIC2.stopPosition=stopPosition;Liftium.d("AIC2: start/stop position fixed",5);return false;};AIC2.isAlmostEqual=function(a,b){return Math.abs(a-b)<3;};AIC2.onScroll=function(){var $window=$(window);Liftium.d("AIC2: onScroll",9);if(($window.scrollTop()>AIC2.startPosition)&&($window.scrollTop()<AIC2.stopPosition)){if(!AIC2.visible){Liftium.d("AIC2.showAd",5);if(!AIC2.checkStartStopPosition()){return;}
if($('#INCONTENT_BOXAD_1').hasClass('wikia-ad')==false){LiftiumOptions.placement="INCONTENT_BOXAD_1";Liftium.callInjectedIframeAd("300x250",document.getElementById("INCONTENT_BOXAD_1_iframe"));$('#INCONTENT_BOXAD_1').addClass('wikia-ad');}
$('#INCONTENT_BOXAD_1').css({'position':'fixed','top':'10px'});$('#INCONTENT_BOXAD_1').css('visibility','visible');AIC2.visible=true;}}else{if(AIC2.visible){Liftium.d("AIC2.hideAd",5);$('#INCONTENT_BOXAD_1').css('visibility','hidden');AIC2.glueAd();AIC2.visible=false;}}};AIC2.glueAd=function(){Liftium.d("AIC2: glueAd",9);var adPosition=parseInt($('#INCONTENT_BOXAD_1').offset().top);if(adPosition>AIC2.stopPosition){Liftium.d("AIC2: glue at the bottom",7);var bigSpace=parseInt(AIC2.stopPosition-AIC2.startPosition+10);$('#INCONTENT_BOXAD_1').css({'position':'relative','top':bigSpace+'px'});}else{Liftium.d("AIC2: glue at the top",7);$('#INCONTENT_BOXAD_1').css({'position':'relative','top':'10px'});}
$('#INCONTENT_BOXAD_1').css('visibility','visible');};AIC2.checkFooterAd=function(){Liftium.d("AIC2: footer ad detection",7);if($(".wikia_anchor_ad").length){Liftium.d("AIC2: footer ad detected, bailing out",3);$(window).unbind("scroll.AIC2");return true;}
Liftium.d("AIC2: footer ad not detected, proceeding",7);return false;};if(window.top===window.self&&window.wgEnableAdsInContent&&!window.wgIsMainpage&&(window.wgIsContentNamespace||window.adLogicPageType==='search')){wgAfterContentAndJS.push(function(){if(!AIC2.called){AIC2.called=true;AIC2.init();}});};var AdProviderAdEngine2=my.Class({name:'AdProviderAdEngine2',fillInSlot:function(slot){this.log('fillInSlot',5,slot);WikiaTracker.trackAdEvent('liftium.slot2',{'ga_category':'slot2/'+slot[1],'ga_action':slot[0],'ga_label':'adengine2'},'ga');this.log('error, AdProviderAdEngine2.fillInSlot method should be overwritten',1);},log:function(msg,level,obj){Wikia.log(msg,level,this.name);if(typeof obj!='undefined'){Wikia.log(obj,level,this.name);}}});;var AdProviderGamePro=my.Class(AdProviderAdEngine2,{name:'AdProviderGamePro',fillInSlot:function(slot){this.log('fillInSlot',5,slot);WikiaTracker.trackAdEvent('liftium.slot2',{'ga_category':'slot2/'+slot[1],'ga_action':slot[0],'ga_label':'gamepro'},'ga');var url=this.getUrl(slot[0],slot[1]);var self=this;ghostwriter(document.getElementById(slot[0]),{insertType:"append",script:{src:url},done:function(){self.log('ghostwriter done',5,[slot[0],url]);ghostwriter.flushloadhandlers();}});},ord:Math.round(Math.random()*23456787654),slotMap:{'HOME_TOP_LEADERBOARD':{'tile':1,'pos':"leadfull",'dcopt':"ist"},'HOME_TOP_RIGHT_BOXAD':{'tile':3,'pos':"mpu"},'LEFT_SKYSCRAPER_2':{'tile':2,'pos':"sky"},'PREFOOTER_LEFT_BOXAD':{'tile':4,'pos':"mpu2"},'TOP_LEADERBOARD':{'tile':1,'pos':"leadfull",'dcopt':"ist"},'TOP_RIGHT_BOXAD':{'tile':3,'pos':"mpu"}},getUrl:function(slotname,size){this.log('getUrl',5,[slotname,size]);var url='http://'+'ad-emea'+'.doubleclick.net/'+'adj'+'/'+'ow-wikia.com'+'/'+'wka.'+window.cityShort+';'+'s1='+'_'+window.wgDBname+';'+'pos='+this.slotMap[slotname].pos+';'+
(window.wgDartCustomKeyValues?this.rebuildKV(window.wgDartCustomKeyValues)+';':'')+'tile='+this.slotMap[slotname].tile+';'+
(this.slotMap[slotname].dcopt?'dcopt='+this.slotMap[slotname].dcopt+';':'')+'sz='+size+';'+'ord='+this.ord+'?';this.log(url,7);return url;},rebuildKV:function(kv){this.log('rebuildKV',5,kv);if(kv.indexOf(';')===-1){return kv;}
kv=kv.split(';');kv.sort();var out='',last_k='';for(var i=0;i<kv.length;i++){var k_v=kv[i].split('=');if(k_v[0]==last_k){out=out+','+k_v[1];}else{out=out+';'+k_v[0]+'='+k_v[1];last_k=k_v[0];}}
out=out.substring(1);this.log(out,7);return out;}});var adProviderGamePro=new AdProviderGamePro;;var AdProviderEvolve=my.Class(AdProviderAdEngine2,{name:'AdProviderEvolve',fillInSlot:function(slot){this.log('fillInSlot',5,slot);WikiaTracker.trackAdEvent('liftium.slot2',{'ga_category':'slot2/'+slot[1],'ga_action':slot[0],'ga_label':'evolve'},'ga');var url=this.getUrl(slot[0],slot[1]);var self=this;ghostwriter(document.getElementById(slot[0]),{insertType:"append",script:{src:url},done:function(){self.log('(fillInSlot) ghostwriter done',5,[slot[0],url]);ghostwriter.flushloadhandlers();}});},ord:Math.round(Math.random()*23456787654),slotMap:{'HOME_TOP_LEADERBOARD':{'tile':1,'size':'728x90','dcopt':'ist'},'HOME_TOP_RIGHT_BOXAD':{'tile':2,'size':'300x250'},'LEFT_SKYSCRAPER_2':{'tile':3,'size':'160x600'},'TOP_LEADERBOARD':{'tile':1,'size':'728x90','dcopt':'ist'},'TOP_RIGHT_BOXAD':{'tile':2,'size':'300x250'}},getUrl:function(slotname,size){this.log('getUrl',5,[slotname,size]);var url='http://'+'n4403ad'+'.doubleclick.net/'+'adj'+'/'+'gn.wikia4.com'+'/'+'home;'+'sect='+'home'+';'+'mtfInline=true;'+'pos='+slotname+';'+'sz='+size+';'+
(this.slotMap[slotname].dcopt?'dcopt='+this.slotMap[slotname].dcopt+';':'')+'type=pop;type=int;'+'tile='+this.slotMap[slotname].tile+';'+'ord='+this.ord+'?';this.log(url,7);return url;},getDevboxUrl:function(slotname,size){this.log('getUrl',5,[slotname,size]);var url='http://ad.doubleclick.net/adj/wka.gaming/_starcraft/article;s0=gaming;s1=_starcraft;dmn=wikia-devcom;'+'pos='+slotname+';'+'src=evolve;'+'ord='+this.ord+'?';this.log(url,7);return url;},hop:function(slotname){this.log('hop',5,slotname);slotname=this.sanitizeSlotname(slotname);var size=this.slotMap[slotname].size||'0x0';this.log('hop in:',7,[slotname,size]);WikiaTracker.trackAdEvent('liftium.hop2',{'ga_category':'hop2/evolve','ga_action':'slot '+slotname,'ga_label':'9.9'},'ga');var script=this.getLiftiumCallScript(slotname,size);var self=this;ghostwriter(document.getElementById(slotname),{insertType:"append",script:{text:script},done:function(){self.log('(hop) ghostwriter done',5,[slotname,script]);ghostwriter.flushloadhandlers();AdDriver.adjustSlotDisplay(slotname);}});},sanitizeSlotname:function(slotname){this.log('sanitizeSlotname',5,slotname);var re=new RegExp('[A-Z1-9_]+');var out=re.exec(slotname);this.log(out);if(typeof this.slotMap[out]=='undefined'){this.log('error, unknown slotname',1);out='';}
this.log(out,7);return out;},getLiftiumCallScript:function(slotname,size){this.log('getLiftiumCallScript',5,[slotname,size]);var dims=size.split('x');var script='';script+="document.write('<div id=\"Liftium_"+size+"_"+(++AdDriverDelayedLoader.adNum)+"\"><iframe width=\""+dims[0]+"\" height=\""+dims[1]+"\" id=\""+slotname+"_iframe\" noresize=\"true\" scrolling=\"no\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\" style=\"border:none;\" target=\"_blank\"></iframe><div>');";script+='LiftiumOptions.placement = "'+slotname+'";';script+='Liftium.callInjectedIframeAd("'+size+'", document.getElementById("'+slotname+'_iframe"));';this.log(script,7);return script;}});var adProviderEvolve=new AdProviderEvolve;function evolve_hop(slotname){window.adProviderEvolve.hop(slotname);};var AdProviderAdDriver2=my.Class(AdProviderAdEngine2,{name:'AdProviderAdDriver2',fillInSlot:function(slot){this.log('fillInSlot',5,slot);if(!window.adslots){window.adslots=[];}
window.adslots.push([slot[0],slot[1],'DART',slot[3]]);if(window.wgLoadAdDriverOnLiftiumInit||true){if(window.adDriverCanInit){AdDriverDelayedLoader.prepareSlots(AdDriverDelayedLoader.highLoadPriorityFloor);}}}});var adProviderAdDriver2=new AdProviderAdDriver2;;var AdEngine2={_cache_geo:null,log:function(msg,level,obj){Wikia.log(msg,level,'AdEngine2');if(typeof obj!='undefined'){Wikia.log(obj,level,'AdEngine2');}},init:function(){this.log('init',5);this.moveQueue();},fillInSlot:function(slot){this.log('fillInSlot',5,slot);var provider=this.getProvider(slot);this.log('calling '+provider+' for '+slot[0],3);slot[2]=provider;window['adProvider'+provider].fillInSlot(slot);},moveQueue:function(){this.log('moveQueue',5);var slots=window.adslots2||[],slot;this.log('queue',7,slots);while((slot=slots.shift())!==undefined){this.fillInSlot(slot);}
slots.push=this.proxy(this.fillInSlot,this);this.log('queue moved',6);},proxy:function(fn,scope){return function(){return fn.apply(scope,arguments);}},getProvider:function(slot){this.log('getProvider',5,slot);var providers={'GamePro':true,'Evolve':true,'AdDriver2':true}
if(slot[2]!='AdEngine2'&&typeof providers[slot[2]]!='undefined'){return slot[2];}
if(this.isSlotGamePro(slot[0],window.wgContentLanguage)){return'GamePro';}
if(this.isSlotEvolve(slot[0],this.getCountry())){return'Evolve';}
return'AdDriver2';},isSlotGamePro:function(slotname,city_lang){this.log('isSlotGamePro',5,[slotname,city_lang]);var slotMap={'HOME_TOP_LEADERBOARD':true,'HOME_TOP_RIGHT_BOXAD':true,'LEFT_SKYSCRAPER_2':true,'PREFOOTER_LEFT_BOXAD':true,'TOP_LEADERBOARD':true,'TOP_RIGHT_BOXAD':true};if(city_lang=='de'&&typeof slotMap[slotname]!='undefined'){return true;}
return false;},isSlotEvolve:function(slotname,country){this.log('isSlotEvolve',5,[slotname,country]);var slotMap={'HOME_TOP_LEADERBOARD':true,'HOME_TOP_RIGHT_BOXAD':true,'LEFT_SKYSCRAPER_2':true,'TOP_LEADERBOARD':true,'TOP_RIGHT_BOXAD':true};if((country=='AU'||country=='CA')&&typeof slotMap[slotname]!='undefined'){return true;}
return false;},getCountry:function(){if(this._cache_geo){return this._cache_geo.country;}
var qs=new Wikia.Querystring;var country=qs.getVal('usegeo',null);if(country){this._cache_geo={country:country};return country;}
var cookie=decodeURIComponent(Wikia.Cookies.get('Geo'));if(typeof cookie!='undefined'&&cookie){try{this._cache_geo=JSON.parse(cookie);}catch(e){this._cache_geo={country:'error'};}}
return this._cache_geo.country;}};if(!window.wgInsideUnitTest){AdEngine2.init();};var AdDriver={adProviderAdDriver:'AdDriver',adProviderDart:'DART',adProviderLiftium:'Liftium',classNameDefaultHeight:'default-height',storageNameNumAllCall:'adDriverNumAllCall',storageNameNumDARTCall:'adDriverNumDARTCall',storageNameLastDARTCallNoAd:'adDriverLastDARTCallNoAd',country:'',debug:false,minNumDARTCall:3,paramLiftiumTag:'liftium_tag',standardLeaderboardMinHeight:90,standardLeaderboardMaxHeight:95,standardTopButtonMinHeight:100,getMinNumDARTCall:function(country){country=country.toUpperCase();if(window.wgHighValueCountries&&window.wgHighValueCountries[country]){return window.wgHighValueCountries[country];}
return AdDriver.minNumDARTCall;},init:function(){window.adDriverLastDARTCallNoAds=[];window.adDriverAdCallComplete=[];AdDriver.debug=parseInt($.getUrlVar('debug'));},log:function(msg){if(AdDriver.debug){$().log('AdDriver: '+msg);}}};AdDriver.getAdProviderForSpecialCase=function(slotname){switch(wgDBname){case'geekfeminism':case'kinkontap':case'lostpedia':case'sexpositive':case'wswiki':return AdDriver.adProviderLiftium;case'cookbook_import':break;default:}
if(window.wgEnableWikiAnswers){return AdDriver.adProviderLiftium;}
switch(slotname){case'MIDDLE_RIGHT_BOXAD':if(typeof window.partnerKeywords=='undefined'||!window.partnerKeywords){return'NO-AD';}
break;default:}
return'';};AdDriver.isHighValue=function(slotname){if(AdConfig.isHighValueSlot(slotname)){if(Liftium.geo){AdDriver.country=Liftium.geo.country;}else if(AdConfig.geo){AdDriver.country=AdConfig.geo.country;}
if(AdDriver.country){return AdConfig.isHighValueCountry(AdDriver.country);}
WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/addriver_no_geo','ga_action':'addriver_no_geo'},'ga');}
return false;};AdDriver.getNumDARTCall=function(slotname){var num=0;num=AdDriver.getNumCall(AdDriver.storageNameNumDARTCall,slotname);AdDriver.log(slotname+' has '+num+' DART calls');return num;};AdDriver.getNumAllCall=function(slotname){var num=0;num=AdDriver.getNumCall(AdDriver.storageNameNumAllCall,slotname);return num;};AdDriver.getNumCall=function(storageName,slotname){var storageNum=0,cookieNum=0,numCallStorage;try{if(window.wgAdDriverUseExpiryStorage){numCallStorage=$.expiryStorage.get(storageName);storageNum=AdDriver.getNumCallFromStorageContents(numCallStorage,slotname);}
if(window.wgAdDriverUseCookie){numCallStorage=$.cookies.get(storageName);cookieNum=AdDriver.getNumCallFromStorageContents(numCallStorage,slotname);}
if(window.wgAdDriverUseExpiryStorage&&window.wgAdDriverUseCookie){if(storageNum!=cookieNum){WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/numcalloutofsync','ga_action':slotname,'ga_label':'storage '+storageName+', num '+storageNum+', cookie '+cookieNum},'ga');AdDriver.log('Cookie and ExpiryStorage for '+storageName+':'+slotname+' are out of sync!');AdDriver.log('Cookie contents: '+cookieNum);AdDriver.log('ExpiryStogage contents: '+storageNum);}}}
catch(e){AdDriver.log(e.message);}
return window.wgAdDriverUseExpiryStorage?storageNum:cookieNum;};AdDriver.getNumCallFromStorageContents=function(numCallStorage,slotname){var num=0;if(typeof(numCallStorage)!='undefined'&&numCallStorage){var slotnameObjs=JSON.parse(numCallStorage);for(var i=0;i<slotnameObjs.length;i++){if(slotnameObjs[i].slotname==slotname){if(parseInt(slotnameObjs[i].ts)+window.wgAdDriverCookieLifetime*3600000>window.wgNow.getTime()){num=parseInt(slotnameObjs[i].num);break;}}}}
return num;};AdDriver.incrementNumDARTCall=function(slotname){return AdDriver.incrementNumCall(AdDriver.storageNameNumDARTCall,slotname);};AdDriver.incrementNumAllCall=function(slotname){return AdDriver.incrementNumCall(AdDriver.storageNameNumAllCall,slotname);};AdDriver.incrementNumCall=function(storageName,slotname){var newSlotnameObjs=new Array();var numInStorage=0;var numInCookie=0;var timestamp=window.wgNow.getTime();var slotnameInStorage=false;if(window.wgAdDriverUseExpiryStorage){try{var numCallStorage=$.expiryStorage.get(storageName);var incrementResult=AdDriver.incrementStorageContents(numCallStorage,slotname);slotnameInStorage=incrementResult.slotnameInStorage;numInStorage=incrementResult.num;newSlotnameObjs=incrementResult.newSlotnameObjs;}
catch(e){AdDriver.log(e.message);}
if(!slotnameInStorage){newSlotnameObjs.push({slotname:slotname,num:++numInStorage,ts:timestamp});}
$.expiryStorage.set(storageName,JSON.stringify(newSlotnameObjs),window.wgAdDriverCookieLifetime*3600000);}
if(window.wgAdDriverUseCookie){newSlotnameObjs=new Array();slotnameInStorage=false;try{var numCallStorage=$.cookies.get(storageName);var incrementResult=AdDriver.incrementStorageContents(numCallStorage,slotname);slotnameInStorage=incrementResult.slotnameInStorage;numInCookie=incrementResult.num;newSlotnameObjs=incrementResult.newSlotnameObjs;}
catch(e){AdDriver.log(e.message);}
if(!slotnameInStorage){newSlotnameObjs.push({slotname:slotname,num:++numInCookie,ts:timestamp});}
var cookieOptions={hoursToLive:window.wgAdDriverCookieLifetime,path:wgCookiePath};$.cookies.set(storageName,JSON.stringify(newSlotnameObjs),cookieOptions);}
return window.wgAdDriverUseExpiryStorage?numInStorage:numInCookie;};AdDriver.incrementStorageContents=function(numCallStorage,slotname){var newSlotnameObjs=new Array();var num=0;var slotnameInStorage=false;var timestamp=window.wgNow.getTime();if(typeof(numCallStorage)!='undefined'&&numCallStorage){var slotnameObjs=JSON.parse(numCallStorage);for(var i=0;i<slotnameObjs.length;i++){if(slotnameObjs[i].slotname==slotname){slotnameInStorage=true;if(parseInt(slotnameObjs[i].ts)+window.wgAdDriverCookieLifetime*3600000>window.wgNow.getTime()){num=parseInt(slotnameObjs[i].num);timestamp=parseInt(slotnameObjs[i].ts);}
newSlotnameObjs.push({slotname:slotname,num:++num,ts:timestamp});}
else{newSlotnameObjs.push(slotnameObjs[i]);}}}
var retObj=new Object();retObj.newSlotnameObjs=newSlotnameObjs;retObj.num=num;retObj.slotnameInStorage=slotnameInStorage;return retObj;};AdDriver.isLastDARTCallNoAd=function(slotname){var storageValue=false;var cookieValue=false;try{if(window.wgAdDriverUseExpiryStorage){var lastDARTCallNoAdStorage=$.expiryStorage.get(AdDriver.storageNameLastDARTCallNoAd);storageValue=AdDriver.getLastDARTCallNoAdFromStorageContents(lastDARTCallNoAdStorage,slotname);}
if(window.wgAdDriverUseCookie){var lastDARTCallNoAdCookie=$.cookies.get(AdDriver.storageNameLastDARTCallNoAd);cookieValue=AdDriver.getLastDARTCallNoAdFromStorageContents(lastDARTCallNoAdCookie,slotname);}
if(window.wgAdDriverUseExpiryStorage&&window.wgAdDriverUseCookie){if(storageValue!=cookieValue){WikiaTracker.trackAdEvent('liftium.errors',{'ga_category':'errors/lastdartcallnoadoutofsync','ga_action':slotname},'ga');}}}
catch(e){AdDriver.log(e.message);}
AdDriver.log(slotname+' last DART call had no ad? '+(window.wgAdDriverUseExpiryStorage?storageValue:cookieValue));return window.wgAdDriverUseExpiryStorage?storageValue:cookieValue;};AdDriver.getLastDARTCallNoAdFromStorageContents=function(lastDARTCallNoAdStorage,slotname){var value=false;if(typeof(lastDARTCallNoAdStorage)!='undefined'&&lastDARTCallNoAdStorage){var slotnameTimestamps=JSON.parse(lastDARTCallNoAdStorage);for(var i=0;i<slotnameTimestamps.length;i++){if(slotnameTimestamps[i].slotname==slotname){if(parseInt(slotnameTimestamps[i].ts)+window.wgAdDriverCookieLifetime*3600000>window.wgNow.getTime()){value=true;}
break;}}}
return value;};AdDriver.setLastDARTCallNoAd=function(slotname,value){var newSlotnameTimestamps=new Array();var slotnameInStorage=false;if(window.wgAdDriverUseExpiryStorage){try{var lastDARTCallNoAdStorage=$.expiryStorage.get(AdDriver.storageNameLastDARTCallNoAd);var setResult=AdDriver.setLastDARTCallNoAdInStorageContents(lastDARTCallNoAdStorage,slotname,value);newSlotnameTimestamps=setResult.newSlotnameTimestamps;slotnameInStorage=setResult.slotnameInStorage;}
catch(e){AdDriver.log(e.message);}
if(value&&!slotnameInStorage){newSlotnameTimestamps.push({slotname:slotname,ts:value});}
if(newSlotnameTimestamps.length){$.expiryStorage.set(AdDriver.storageNameLastDARTCallNoAd,JSON.stringify(newSlotnameTimestamps),window.wgAdDriverCookieLifetime*3600000);}}
if(window.wgAdDriverUseCookie){var newSlotnameTimestamps=new Array();var slotnameInStorage=false;try{var lastDARTCallNoAdCookie=$.cookies.get(AdDriver.storageNameLastDARTCallNoAd);var setResult=AdDriver.setLastDARTCallNoAdInStorageContents(lastDARTCallNoAdCookie,slotname,value);newSlotnameTimestamps=setResult.newSlotnameTimestamps;slotnameInStorage=setResult.slotnameInStorage;}
catch(e){AdDriver.log(e.message);}
if(value&&!slotnameInStorage){newSlotnameTimestamps.push({slotname:slotname,ts:value});}
if(newSlotnameTimestamps.length){var cookieOptions={hoursToLive:window.wgAdDriverCookieLifetime,path:wgCookiePath};$.cookies.set(AdDriver.storageNameLastDARTCallNoAd,JSON.stringify(newSlotnameTimestamps),cookieOptions);}}
return value;};AdDriver.setLastDARTCallNoAdInStorageContents=function(lastDARTCallNoAdStorage,slotname,value){var slotnameInStorage=false;var newSlotnameTimestamps=new Array();if(typeof(lastDARTCallNoAdStorage)!='undefined'&&lastDARTCallNoAdStorage){var slotnameTimestamps=JSON.parse(lastDARTCallNoAdStorage);for(var i=0;i<slotnameTimestamps.length;i++){if(slotnameTimestamps[i].slotname==slotname){slotnameInStorage=true;if(value){newSlotnameTimestamps.push({slotname:slotname,ts:value});}}
else{newSlotnameTimestamps.push(slotnameTimestamps[i]);}}}
var retObj=new Object();retObj.slotnameInStorage=slotnameInStorage;retObj.newSlotnameTimestamps=newSlotnameTimestamps;return retObj;};AdDriver.adjustSlotDisplay=function(slotname){var $slot=$('#'+slotname);switch(slotname){case'CORP_TOP_LEADERBOARD':case'HOME_TOP_LEADERBOARD':case'HUB_TOP_LEADERBOARD':case'TOP_LEADERBOARD':$slot.removeClass(AdDriver.classNameDefaultHeight);if(($slot.height()>=0&&$slot.height()<AdDriver.standardLeaderboardMinHeight)||$slot.height()>AdDriver.standardLeaderboardMaxHeight){$slot.addClass('jumbo-leaderboard');$('#WikiaTopAds').removeClass('WikiaTopButtonLeft WikiaTopButtonRight');AdDriverDelayedLoader.removeItemsBySlotname('TOP_BUTTON');}
return true;break;case'CORP_TOP_RIGHT_BOXAD':case'HOME_TOP_RIGHT_BOXAD':case'TEST_HOME_TOP_RIGHT_BOXAD':case'TEST_TOP_RIGHT_BOXAD':case'TOP_RIGHT_BOXAD':case'PREFOOTER_LEFT_BOXAD':case'PREFOOTER_RIGHT_BOXAD':$slot.removeClass(AdDriver.classNameDefaultHeight);return true;break;case'HOME_TOP_RIGHT_BUTTON':if($slot.height()>=AdDriver.standardTopButtonMinHeight){$slot.addClass('home-top-right-button-visible');}
break;}
return false;};AdDriver.canCallLiftium=function(slotname){switch(slotname){case'HOME_INVISIBLE_TOP':case'HUB_TOP_LEADERBOARD':case'INVISIBLE_MODAL':case'INVISIBLE_TOP':case'MIDDLE_RIGHT_BOXAD':case'MODAL_VERTICAL_BANNER':return false;break;}
return true;};AdDriver.doesUrlParameterExist=function(param){if($.getUrlVar(param)!=null){return true;}
return false;};AdDriver.isForceLiftium=function(){var forceLiftiumParams=new Array(AdDriver.paramLiftiumTag);for(var i=0;i<forceLiftiumParams.length;i++){if(AdDriver.doesUrlParameterExist(forceLiftiumParams[i])){return true;}}
return false;};AdDriver.getAdProvider=function(slotname,size,defaultAdProvider){if(AdDriver.isForceLiftium()){return AdDriver.adProviderLiftium;}
var specialCaseAdProvider=AdDriver.getAdProviderForSpecialCase(slotname);if(specialCaseAdProvider){return specialCaseAdProvider;}
if(defaultAdProvider==AdDriver.adProviderLiftium){return AdDriver.adProviderLiftium;}
if(AdDriver.isHighValue(slotname)){if(AdDriver.getNumDARTCall(slotname)<AdDriver.getMinNumDARTCall(AdDriver.country)||!AdDriver.isLastDARTCallNoAd(slotname)){return AdDriver.adProviderDart;}}
return AdDriver.adProviderLiftium;};AdDriver.init();var AdDriverDelayedLoaderItem=function(slotname,size,defaultAdProvider){this.clientWidth=0;this.clientHeight=0;this.hasPrefooters=null;this.slotname=slotname;this.size=size;this.defaultAdProvider=defaultAdProvider;this.dartUrl=null;this.getDARTUrl=function(){if(!this.dartUrl){this.dartUrl=AdConfig.DART.getUrl(slotname,size,false,AdDriver.adProviderAdDriver);}
return this.dartUrl;};};var AdDriverDelayedLoader={adDriverItems:null,adNum:0,currentAd:null,currentSlot:null,highLoadPriorityFloor:11,runFinalize:false,started:false,init:function(adDriverItems){AdDriverDelayedLoader.adDriverItems=adDriverItems?adDriverItems:new Array();AdDriverDelayedLoader.adNum=0;AdDriverDelayedLoader.currentAd=null;AdDriverDelayedLoader.currentSlot=null;AdDriverDelayedLoader.runFinalize=false;AdDriverDelayedLoader.started=false;}};AdDriverDelayedLoader.init();AdDriverDelayedLoader.appendItem=function(adDriverItem){AdDriverDelayedLoader.adDriverItems.push(adDriverItem);};AdDriverDelayedLoader.prependItem=function(adDriverItem){AdDriverDelayedLoader.adDriverItems.unshift(adDriverItem);};AdDriverDelayedLoader.removeItemsBySlotname=function(slotname){var itemIdxs=[];for(var i=0;i<AdDriverDelayedLoader.adDriverItems.length;i++){if(slotname==AdDriverDelayedLoader.adDriverItems[i].slotname){itemIdxs.unshift(i);}}
for(var i=0;i<itemIdxs.length;i++){AdDriverDelayedLoader.adDriverItems.splice(itemIdxs[i],1);}};AdDriverDelayedLoader.callDART=function(){WikiaTracker.trackAdEvent('liftium.slot2',{'ga_category':'slot2/'+AdDriverDelayedLoader.currentAd.size,'ga_action':AdDriverDelayedLoader.currentAd.slotname,'ga_label':'addriver'},'ga');AdDriver.log(AdDriverDelayedLoader.currentAd.slotname+': calling DART...');AdDriver.incrementNumDARTCall(AdDriverDelayedLoader.currentAd.slotname);AdDriver.setLastDARTCallNoAd(AdDriverDelayedLoader.currentAd.slotname,null);var slot=document.getElementById(AdDriverDelayedLoader.currentAd.slotname);ghostwriter(slot,{insertType:"append",script:{src:AdDriverDelayedLoader.currentAd.getDARTUrl()},done:function(){ghostwriter.flushloadhandlers();var nextAdProvider=null;if(typeof(window.adDriverLastDARTCallNoAds[AdDriverDelayedLoader.currentAd.slotname])=='undefined'||!window.adDriverLastDARTCallNoAds[AdDriverDelayedLoader.currentAd.slotname]){AdDriver.log(AdDriverDelayedLoader.currentAd.slotname+' was filled by DART');AdDriver.adjustSlotDisplay(AdDriverDelayedLoader.currentAd.slotname);}
else{AdDriver.log(AdDriverDelayedLoader.currentAd.slotname+' was not filled by DART');AdDriver.setLastDARTCallNoAd(AdDriverDelayedLoader.currentAd.slotname,window.wgNow.getTime());if(AdDriver.canCallLiftium(AdDriverDelayedLoader.currentAd.slotname)){nextAdProvider=AdDriver.adProviderLiftium;}}
if(nextAdProvider==AdDriver.adProviderLiftium){WikiaTracker.trackAdEvent('liftium.hop2',{'ga_category':'hop2/addriver','ga_action':'slot '+AdDriverDelayedLoader.currentAd.slotname,'ga_label':'9.9'},'ga');var liftiumItem=new AdDriverDelayedLoaderItem(AdDriverDelayedLoader.currentAd.slotname,AdDriverDelayedLoader.currentAd.size,AdDriver.adProviderLiftium);AdDriverDelayedLoader.prependItem(liftiumItem);}
else{}
AdDriverDelayedLoader.loadNext();}});};AdDriverDelayedLoader.getPlaceHolderIframeScript=function(slotname,size){var dims=size.split('x');return"document.write('<div id=\"Liftium_"+size+"_"+(++AdDriverDelayedLoader.adNum)+"\"><iframe width=\""+dims[0]+"\" height=\""+dims[1]+"\" id=\""+escape(slotname)+"_iframe\" noresize=\"true\" scrolling=\"no\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\" style=\"border:none;\" target=\"_blank\"></iframe><div>');";};AdDriverDelayedLoader.getLiftiumCallScript=function(slotname,size){var script='';if(slotname in AdConfig.adSlotsRequiringJSInvocation){script='Liftium.callAd("'+size+'");';}
else{script=AdDriverDelayedLoader.getPlaceHolderIframeScript(slotname,size);script+='Liftium.callInjectedIframeAd("'+size+'", document.getElementById("'+escape(slotname)+'_iframe"));';}
return script;};AdDriverDelayedLoader.callLiftium=function(){var slotname=AdDriverDelayedLoader.currentAd.slotname;if(!AdDriver.canCallLiftium(slotname)){AdDriverDelayedLoader.loadNext();return;}
AdDriver.log(slotname+': calling Liftium...');var size=AdDriverDelayedLoader.currentAd.size;LiftiumOptions.placement=slotname;try{var script=AdDriverDelayedLoader.getLiftiumCallScript(slotname,size);var slot=document.getElementById(slotname);ghostwriter(slot,{insertType:"append",script:{text:script},done:function(){ghostwriter.flushloadhandlers();AdDriver.adjustSlotDisplay(slotname);AdDriverDelayedLoader.loadNext();}});}
catch(e){AdDriver.log(e.message);AdDriverDelayedLoader.loadNext();}};AdDriverDelayedLoader.loadNext=function(){if(AdDriverDelayedLoader.adDriverItems.length){AdDriverDelayedLoader.currentAd=AdDriverDelayedLoader.adDriverItems.shift();if(AdEngine.isSlotDisplayableOnCurrentPage(AdDriverDelayedLoader.currentAd.slotname)){var adProvider=AdDriver.getAdProvider(AdDriverDelayedLoader.currentAd.slotname,AdDriverDelayedLoader.currentAd.size,AdDriverDelayedLoader.currentAd.defaultAdProvider);if(adProvider==AdDriver.adProviderDart||adProvider==AdDriver.adProviderLiftium){if(AdDriverDelayedLoader.currentSlot!=AdDriverDelayedLoader.currentAd.slotname){AdDriver.incrementNumAllCall(AdDriverDelayedLoader.currentAd.slotname);AdDriverDelayedLoader.currentSlot=AdDriverDelayedLoader.currentAd.slotname;}}
if(adProvider==AdDriver.adProviderDart){AdDriverDelayedLoader.callDART();}
else if(adProvider==AdDriver.adProviderLiftium){AdDriverDelayedLoader.callLiftium();}
else{AdDriverDelayedLoader.loadNext();}}
else{$('#'+AdDriverDelayedLoader.currentAd.slotname).hide();AdDriverDelayedLoader.loadNext();}}
else if(typeof EXP_AD_LOAD_TIMING!="undefined"){if(window.getTreatmentGroup&&(window.wgLoadAdDriverOnLiftiumInit||getTreatmentGroup(EXP_AD_LOAD_TIMING)==TG_AS_WRAPPERS_ARE_RENDERED)){if(AdDriverDelayedLoader.runFinalize){AdDriverDelayedLoader.finalize();}}
else{AdDriverDelayedLoader.finalize();}}
if(!AdDriverDelayedLoader.adDriverItems.length&&typeof Liftium!='undefined'&&Liftium){Liftium.hasMoreCalls=0;}};AdDriverDelayedLoader.reorderItems=function(){var highPriorityItems=['TOP_LEADERBOARD','TOP_RIGHT_BOXAD'];var tmpItems=[];for(var i=0;i<AdDriverDelayedLoader.adDriverItems.length;i++){var foundHighPriorityItem=false;for(var j=0;j<highPriorityItems.length;j++){if(AdDriverDelayedLoader.adDriverItems[i].slotname.indexOf(highPriorityItems[j])>-1){if(tmpItems.length&&tmpItems[0].slotname.indexOf('TOP_LEADERBOARD')>-1){tmpItems.splice(1,0,AdDriverDelayedLoader.adDriverItems[i]);}
else{tmpItems.unshift(AdDriverDelayedLoader.adDriverItems[i]);}
foundHighPriorityItem=true;break;}}
if(!foundHighPriorityItem){tmpItems.push(AdDriverDelayedLoader.adDriverItems[i]);}}
AdDriverDelayedLoader.adDriverItems=tmpItems;};AdDriverDelayedLoader.prepareSlots=function(loadPriorityFloor){if(!AdDriverDelayedLoader.isRunning()){AdDriverDelayedLoader.reset();}
var slots;while(slots=AdDriverDelayedLoader.getNextSlotFromBuffer(loadPriorityFloor)){var slot=slots[0];AdDriverDelayedLoader.appendItem(new AdDriverDelayedLoaderItem(slot[0],slot[1],slot[2]));}
if(!AdDriverDelayedLoader.started){AdDriverDelayedLoader.load();}};AdDriverDelayedLoader.getNextSlotFromBuffer=function(loadPriorityFloor){var highestPriority=-1;var highestPriorityIndex=-1;for(var i=0;i<window.adslots.length;i++){if(window.adslots[i][3]>=loadPriorityFloor){if(window.adslots[i][3]>highestPriority){highestPriority=window.adslots[i][3];highestPriorityIndex=i;}}}
if(highestPriorityIndex>=0){return window.adslots.splice(highestPriorityIndex,1);}
return null;};AdDriverDelayedLoader.startCalled=false;AdDriverDelayedLoader.load=function(){AdDriverDelayedLoader.started=true;if((typeof EXP_AD_LOAD_TIMING!="undefined")&&(typeof abBeingTracked!="undefined")&&(typeof abBeingTracked[EXP_AD_LOAD_TIMING]!="undefined")&&abBeingTracked[EXP_AD_LOAD_TIMING]){if(AdDriverDelayedLoader.startCalled===false){AdDriverDelayedLoader.startCalled=true;WikiaTracker.trackEvent('AdDriver',{pos:'start'},'internal');}}
if(typeof wgNow!='undefined'&&AdDriverDelayedLoader.adDriverItems.length){var loadTime=(new Date()).getTime()-wgNow.getTime();$().log('AdDriver started loading after '+loadTime+' ms');}
AdDriverDelayedLoader.reorderItems();AdDriverDelayedLoader.loadNext();};AdDriverDelayedLoader.reset=function(){AdDriverDelayedLoader.init();};AdDriverDelayedLoader.isRunning=function(){return AdDriverDelayedLoader.started&&AdDriverDelayedLoader.adDriverItems.length;};AdDriverDelayedLoader.finalize=function(){if((typeof EXP_AD_LOAD_TIMING!="undefined")&&(typeof abBeingTracked!="undefined")&&(typeof abBeingTracked[EXP_AD_LOAD_TIMING]!="undefined")&&abBeingTracked[EXP_AD_LOAD_TIMING]){WikiaTracker.trackEvent('AdDriver',{pos:'stop'},'internal');}
if(window.wgEnableKruxTargeting){AdDriver.log('loading krux');Krux.load(window.wgKruxCategoryId);}
var loadTime=(new Date()).getTime()-wgNow.getTime();$().log('AdDriver finished at '+loadTime+' ms');};if(window.wgEnableKruxTargeting){window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]);Krux.load=function(confid){var k=document.createElement('script');k.type='text/javascript';k.async=true;var m,src=(m=location.href.match(/\bkxsrc=([^&]+)\b/))&&decodeURIComponent(m[1]);k.src=src||(location.protocol==='https:'?'https:':'http:')+'//cdn.krxd.net/controltag?confid='+confid;var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s);};window.Krux||((Krux=function(){Krux.q.push(arguments);}).q=[]);(function(){function retrieve(n){var m,k='kx'+n;if(window.localStorage){return window.localStorage[k]||"";}else if(navigator.cookieEnabled){m=document.cookie.match(k+'=([^;]*)');return(m&&unescape(m[1]))||"";}else{return'';}}
var kvs=[];Krux.user=retrieve('user');if(Krux.user){kvs.push('u='+Krux.user);}
Krux.segments=retrieve('segs')&&retrieve('segs').split(',')||[];for(var i=0;i<Krux.segments.length;i++){kvs.push('ksgmnt='+Krux.segments[i]);}
Krux.dartKeyValues=kvs.length?kvs.join(';')+';':'';})();}
if(!window.adslots){window.adslots=[];}
if(window.getTreatmentGroup){var tgId=getTreatmentGroup(EXP_AD_LOAD_TIMING);if(!window.wgLoadAdDriverOnLiftiumInit&&tgId!=TG_AS_WRAPPERS_ARE_RENDERED){for(var i=0;i<window.adslots.length;i++){AdDriverDelayedLoader.appendItem(new AdDriverDelayedLoaderItem(window.adslots[i][0],window.adslots[i][1],window.adslots[i][2]));}}
if(!window.wgLoadAdDriverOnLiftiumInit&&tgId==TG_ONLOAD){$(window).load(function(){AdDriverDelayedLoader.load();});}
else{var adDriverFuncsToExecute=[];if(window.wgLoadAdDriverOnLiftiumInit||tgId==TG_AS_WRAPPERS_ARE_RENDERED){adDriverFuncsToExecute.push(function(){window.adDriverCanInit=true;AdDriverDelayedLoader.prepareSlots(AdDriverDelayedLoader.highLoadPriorityFloor);});var prepareLowPrioritySlots=function(){AdDriverDelayedLoader.prepareSlots(0);if(!AdDriverDelayedLoader.isRunning()){AdDriverDelayedLoader.finalize();}
else{AdDriverDelayedLoader.runFinalize=true;}}
$(document).ready(function(){if(window.adDriverCanInit==false){adDriverFuncsToExecute.push(prepareLowPrioritySlots);}
else{prepareLowPrioritySlots();}});}
else{adDriverFuncsToExecute.push(function(){AdDriverDelayedLoader.load();});}
Liftium.init(function(){for(var i=0;i<adDriverFuncsToExecute.length;i++){adDriverFuncsToExecute[i]();}});}};var AdDriverGP={ord:Math.round(Math.random()*23456787654),slotMap:{'HOME_TOP_LEADERBOARD':{'tile':1,'pos':"leadfull",'dcopt':"ist"},'HOME_TOP_RIGHT_BOXAD':{'tile':3,'pos':"mpu"},'LEFT_SKYSCRAPER_2':{'tile':2,'pos':"sky"},'PREFOOTER_LEFT_BOXAD':{'tile':4,'pos':"mpu2"},'TOP_LEADERBOARD':{'tile':1,'pos':"leadfull",'dcopt':"ist"},'TOP_RIGHT_BOXAD':{'tile':3,'pos':"mpu"}},debug:false,getUrl:function(slotname,size){this.log('getUrl',[slotname,size]);var url='http://'+'ad-emea'+'.doubleclick.net/'+'adj'+'/'+'ow-wikia.com'+'/'+'wka.'+window.cityShort+';'+'s1='+'_'+window.wgDBname+';'+'pos='+AdDriverGP.slotMap[slotname].pos+';'+
(window.wgDartCustomKeyValues?this.rebuildKV(window.wgDartCustomKeyValues)+';':'')+'tile='+AdDriverGP.slotMap[slotname].tile+';'+
(AdDriverGP.slotMap[slotname].dcopt?'dcopt='+AdDriverGP.slotMap[slotname].dcopt+';':'')+'sz='+size+';'+'ord='+AdDriverGP.ord+'?';this.log(url);return url;},rebuildKV:function(kv){this.log('rebuildKV',kv);if(kv.indexOf(';')===-1){return kv;}
kv=kv.split(';');kv.sort();var out='',last_k='';for(var i=0;i<kv.length;i++){var k_v=kv[i].split('=');if(k_v[0]==last_k){out=out+','+k_v[1];}else{out=out+';'+k_v[0]+'='+k_v[1];last_k=k_v[0];}}
out=out.substring(1);this.log(out);return out;},log:function(msg,obj){if(typeof console=='undefined')return;if(!this.debug)return;console.log('AdDriverGP: '+msg);if(typeof obj!='undefined'){console.log(obj);}},init:function(){this.log('init');this.moveQueue();},moveQueueSimple:function(){this.log('moveQueueSimple');if(!window.gpslots){window.gpslots=[];}
for(var i=0;i<window.gpslots.length;i++){var s=window.gpslots[i];this.log('slot',s);this.fillInSlot(s);}},fillInSlot:function(s){this.log('fillInSlot',s);WikiaTracker.trackAdEvent('liftium.slot2',{'ga_category':'slot2/'+s[1],'ga_action':s[0],'ga_label':'gamepro'},'ga');var url=this.getUrl(s[0],s[1]);ghostwriter(document.getElementById(s[0]),{insertType:"append",script:{src:url},done:function(){AdDriverGP.log('ghostwriter done',[s[0],url]);ghostwriter.flushloadhandlers();}});},moveQueue:function(){this.log('moveQueue');var slots=window.gpslots||[],s;while((s=slots.shift())!==undefined){this.fillInSlot(s);}
slots.push=this.proxy(this.fillInSlot,this);},proxy:function(fn,scope){return function(){return fn.apply(scope,arguments);}}};if(!window.wgInsideUnitTest){AdDriverGP.init();};var VideoHandlers={init:function(){if($.browser.msie&&$.browser.version=="8.0"){$('#WikiaArticle').find('.info-overlay-title').each(function(){var $this=$(this),width=$this.css('max-width');$this.css('width',width);});}}}
VideoHandlers.init();;RelatedPages={module:false,log:function(msg){$().log(msg,'RelatedPages');},init:function(){$(window).unbind('scroll',RelatedPages.updateScroll);this.module=$('.RelatedPagesModule').first();if(!this.module.exists()){return;}
this.module.find('.articleSnippet').css('cursor','pointer').bind('click',function(ev){var target=$(this),href=target.next('.more').attr('href');if(href){window.location=href;}});var content=$('#WikiaArticle');var contentWidth=content.width();var addAfter=parseInt(this.module.attr('data-add-after-section'));if(!addAfter){return;}
var sections=content.find('.mw-headline').parent().filter('h2');var sectionMatch=false;sections.slice(addAfter).each(function(){var node=$(this);if(node.width()>contentWidth-10){sectionMatch=node;return false;}});if(sectionMatch){var sectionId=sections.index(sectionMatch)+1;this.log('moving before #'+sectionId+' section ('+sectionMatch.children().first().text()+')');this.module.insertBefore(sectionMatch.prev());}
else if(sections.length>addAfter){this.log('collision detected');}
else{this.log('article is too short (less than '+addAfter+' sections)');}},scroll_threshold:300,attachLazyLoaderEvents:function(){if(RelatedPages.module.exists()){$(window).bind('scroll',RelatedPages.updateScroll);RelatedPages.updateScroll();}},updateScroll:function(){var fold=$(window).height()+$(window).scrollTop();var topVal=RelatedPages.module.offset().top;if(topVal>0&&topVal<(fold+RelatedPages.scroll_threshold)){RelatedPages.lazyLoadImages();}},lazyLoadImages:function(){RelatedPages.log('loading RelatedPages images');var images=RelatedPages.module.find('img').filter('[data-src]');images.each(function(){var image=$(this);image.attr('src',image.attr('data-src')).removeAttr('data-src');});$(window).unbind('scroll',RelatedPages.updateScroll);}};$(function(){RelatedPages.init();RelatedPages.attachLazyLoaderEvents();});;var CreatePage={pageLayout:null,options:{},loading:false,checkTitle:function(title,enterWasHit){$.getJSON(wgScript,{action:'ajax',rs:'wfCreatePageAjaxCheckTitle',title:title},function(response){if(response.result=='ok'){location.href=CreatePage.options[CreatePage.pageLayout]['submitUrl'].replace('$1',encodeURIComponent(title));}
else{CreatePage.displayError(response.msg);}});},openDialog:function(e,titleText){if((!!window.WikiaEnableNewCreatepage)===false){return;}
if(e&&e.which==2){return;}
if(e&&e.preventDefault){e.preventDefault();}
if(false===CreatePage.loading){CreatePage.loading=true;$.getJSON(wgScript,{action:'ajax',rs:'wfCreatePageAjaxGetDialog'},function(data){$.showModal(data.title,data.html,{width:data.width,id:'CreatePageDialog',callback:function(){CreatePage.loading=false;for(var name in CreatePage.options){var idToken=name.charAt(0).toUpperCase()+name.substring(1);var elm=$('#CreatePageDialog'+idToken+'Container');elm.data('optionName',name);elm.click(function(){CreatePage.setPageLayout($(this).data('optionName'));});}
if(titleText!=null){$('#wpCreatePageDialogTitle').val(decodeURIComponent(titleText));}
CreatePage.setPageLayout(data.defaultOption);$('#wpCreatePageDialogTitle').focus();$('#CreatePageDialogButton .createpage').click(function(e){e.preventDefault();CreatePage.submitDialog(false);});}});});}},submitDialog:function(enterWasHit){CreatePage.checkTitle($('#wpCreatePageDialogTitle').val(),enterWasHit);},displayError:function(errorMsg){var box=$('#CreatePageDialogTitleErrorMsg');box.html('<span id="createPageErrorMsg">'+errorMsg+'</span>');box.removeClass('hiddenStructure');},setPageLayout:function(layout){CreatePage.pageLayout=layout;var idToken=layout.charAt(0).toUpperCase()+layout.substring(1);$('#CreatePageDialog'+idToken).attr('checked','checked');$('#CreatePageDialogChoices').children('li').removeClass('accent');$('#CreatePageDialog'+idToken+'Container').addClass('accent');},getTitleFromUrl:function(url){var vars=[],i,hash,hashes=url.slice(url.indexOf('?')+1).split('&');for(i=0;i<hashes.length;i++){hash=hashes[i].split('=');vars.push(hash[0]);vars[hash[0]]=hash[1];}
return vars['title'].replace(/_/g,' ');},redLinkClick:function(e,titleText){var title=titleText.split(':'),isContentNamespace=false;if(window.ContentNamespacesText&&(title.length>1)){for(var i in window.ContentNamespacesText){if(title[0]==window.ContentNamespacesText[i]){isContentNamespace=true;}}}
else{isContentNamespace=true;}
if(isContentNamespace){CreatePage.openDialog(e,titleText);}
else{return false;}},init:function(){if(window.WikiaEnableNewCreatepage){$().log('init','CreatePage');if(!window.WikiaDisableDynamicLinkCreatePagePopup){$('#dynamic-links-write-article-link, #dynamic-links-write-article-icon').click(function(e){CreatePage.openDialog(e,null);});$('.noarticletext a').click(function(e){CreatePage.openDialog(e,wgPageName);return false;});}
$('.createpage').click(CreatePage.openDialog);var addRecipeTab=$('#add_recipe_tab');if(addRecipeTab.exists()){var addRecipeLink=addRecipeTab.find('a');if(addRecipeLink.attr('href').match(/CreatePage$/)){addRecipeLink.click(CreatePage.openDialog);}}
$("a.new").bind('click',function(e){CreatePage.redLinkClick(e,CreatePage.getTitleFromUrl(this.href));});$(".createboxButton").bind('click',function(e){var form=$(e.target).parent();if(form.attr('class')=='createboxForm'){var field=form.children('.createboxInput');var preloadField=form.children("input[name='preload']");if((typeof preloadField.val()==undefined)||(preloadField.val()=='')){CreatePage.openDialog(e,field.val());}
else{return true;}}});}}};jQuery(function($){CreatePage.init()});;var ImageLightbox={target:false,afterLoadOpened:false,videoThumbWidthThreshold:320,wikiAddress:false,showEmbedCodeInstantly:true,log:function(msg){$().log(msg,'ImageLightbox');},init:function(){var self=this,article;if(!window.wgEnableImageLightboxExt){this.log('disabled');return;}
if(window.skin=='oasis'){article=$('#WikiaArticle, .LatestPhotosModule, #article-comments');}
else{article=$('#bodyContent');}
this.log('init');article.unbind('.lightbox').bind('click.lightbox',function(ev){self.onClick.call(self,ev);});$('#RelatedVideosRL').unbind('.lightbox').bind('click.lightbox',function(ev){self.onClick.call(self,ev);});},getCaption:function(target){var caption=false;if(target.hasClass('slideshow')){caption=target.prev('label').html();}
else if(target.hasClass('lightbox')){caption=target.closest('.thumb').next('.lightbox-caption').html();}
else if(target.hasClass('image')){caption=target.nextAll('.thumbcaption').html();}
return caption;},onClick:function(ev){var target=$(ev.target);this.wikiAddress=false;if(target.is('span')||target.is('img')){if(target.hasClass('Wikia-video-play-button')||target.hasClass('Wikia-video-thumb')){target=target.parent();target.addClass('image');}else{target=target.parent();}}
if(target.is('div')&&target.hasClass('playButton')){target=target.parent();}
if(!target.is('a')){return;}
if(!target.hasClass('lightbox')&&!target.hasClass('image')){return;}
if(target.hasClass('link-internal')){return;}
if(target.hasClass('wikia-slideshow-image')&&!target.parent().hasClass('wikia-slideshow-from-feed')){return;}
if(ev.ctrlKey){return;}
this.target=target;var caption=this.getCaption(target);if(target.attr('data-shared-help')){var self=this,imageSrc=target.attr('href'),img=new Image();this.log('loading shared help image: '+imageSrc);img.onload=function(){var html='<div id="lightbox-image" style="text-align: center"><img src="'+imageSrc+'" alt="" /></div>'+'<div id="lightbox-caption-content"></div>';self.showLightbox(target.attr('data-image-name'),html,caption);};img.src=imageSrc;ev.preventDefault();return;}
if(target.hasClass('link-external')){var image=target.children('img'),html='<div id="lightbox-image" style="text-align: center"><img src="'+image.attr('src')+'" alt="" /></div>'+'<div id="lightbox-caption-content"></div>';this.showLightbox(target.closest('.wikia-gallery').attr('data-feed-title'),html,caption);ev.preventDefault();return;}
var imageName=false;if(target.attr('data-image-name')){imageName='File:'+target.attr('data-image-name');}
else if(target.attr('ref')){imageName=target.attr('ref');}
else{var re=wgArticlePath.replace(/\$1/,'(.*)');var matches=target.attr('href').match(re);if(matches){imageName=matches.pop();}}
var targetChildImg=target.find('img').eq(0);if(targetChildImg.length>0&&targetChildImg.hasClass('Wikia-video-thumb')){if(target.attr('data-video-name')){imageName='File:'+target.attr('data-video-name');}else if(targetChildImg.length>0&&targetChildImg.attr('data-video')){imageName='File:'+targetChildImg.attr('data-video');}
if(imageName&&targetChildImg.width()>=this.videoThumbWidthThreshold){this.displayInlineVideo(targetChildImg,imageName);ev.preventDefault();return false;}}
if(target.hasClass('video-hubs-video')){var wikiData=target.data('wiki');if(wikiData){this.wikiAddress=wikiData;this.showEmbedCodeInstantly=true;}}
if(imageName!=false){imageName=decodeURIComponent(imageName);var timestamp=target.attr("data-timestamp");var showShareTools=target.hasParent('#WikiaArticle')?1:0;this.fetchLightbox(imageName,caption,showShareTools,timestamp);ev.preventDefault();var eventValue=0;var rvModule=target.closest('.RelatedVideosModule');if(rvModule&&rvModule.length){var localItem=target.closest('.item');var localGroup=localItem.closest('.group');var container=localGroup.closest('.container');var allGroups=container.children();var localAllItems=localGroup.children();var localItemIndex=localAllItems.index(localItem);var localGroupIndex=allGroups.index(localGroup);var clickedIndex=(localGroupIndex*RelatedVideos.videosPerPage)+localItemIndex;eventValue=clickedIndex+1;WikiaTracker.trackEvent('trackingevent',{'ga_category':RelatedVideos.gaCat,'ga_action':WikiaTracker.ACTIONS.PLAY_VIDEO,'ga_label':(target.hasClass('video-thumbnail')?'thumbnail':'title'),'ga_value':eventValue,'video_title':imageName},'both');}}},displayInlineVideo:function(targetImage,imageName){var parentTag=targetImage.parent();if(!parentTag.is('a')){return;}
parentTag.wrap('<span class="wikiaVideoPlaceholder" />');var wrapperTag=parentTag.parent('span.wikiaVideoPlaceholder');var imageWidth=targetImage.width();var imageHeight=targetImage.height();$.getJSON(wgScript+'?action=ajax&rs=ImageLightboxAjax',{'maxheight':imageHeight,'maxwidth':imageWidth,'method':'ajax','pageName':wgPageName,'share':0,'title':imageName,'videoInline':1},function(res){jQuery(parentTag).siblings('span.Wikia-video-title-bar').eq(0).remove();if(res&&(res.html||res.jsonData)){if(res.asset){$.getScript(res.asset,function(){wrapperTag.find('a').hide();wrapperTag.append('<div id="'+res.jsonData.id+'" style="width:'+imageWidth+'px; height:'+imageHeight+'px; display: inline-block;" class="Wikia-video-enabledEmbedCode"></div>');$('body').append('<script>'+res.jsonData.script+' loadJWPlayer(); </script>');});}else{wrapperTag.find('a').hide();wrapperTag.append('<div  class="Wikia-video-enabledEmbedCode">'+res.html+'</div>');}}});},restoreInlineThumbnails:function(){jQuery(".Wikia-video-enabledEmbedCode").remove();jQuery('span.wikiaVideoPlaceholder a').show();},setTopPosition:function(){var lightbox=$('#lightbox');if(window.skin=='oasis'){lightbox.css('top',lightbox.getModalTopOffset());}},fetchLightbox:function(imageName,caption,showShareTools,timestamp){var self=this;this.log(imageName);if(this.lock){this.log('lock detected: another lightbox is loading');return;}
this.lock=true;this.imageName=imageName;var maxWidth=$(window).width();var maxHeight=$(window).height();if(window.skin=='oasis'){maxHeight-=75;maxWidth=850;}
$.getJSON(wgScript+'?action=ajax&rs=ImageLightboxAjax',{'maxheight':maxHeight,'maxwidth':maxWidth,'method':'ajax','pageName':wgPageName,'share':showShareTools,'title':imageName,'t':timestamp,'showEmbedCodeInstantly':this.showEmbedCodeInstantly,'wikiAddress':this.wikiAddress},function(res){if(res&&(res.html||res.jsonData)){if(res.asset){$.getScript(res.asset,function(){self.showLightbox(res.title,'<div id="'+res.jsonData.id+'"></div>'+res.html,caption,res.width,function(){if(typeof(res.jsonData.events)=="undefined"||typeof(res.jsonData.events.onReady)=="undefined"){res.jsonData.events={onReady:function(){self.setTopPosition();}};}
$('body').append('<script>'+res.jsonData.script+' loadJWPlayer(); </script>');self.setTopPosition();});});}else{self.showLightbox(res.title,res.html,caption,res.width);self.setTopPosition();}}else{delete self.lock;}});},showLightbox:function(title,content,caption,width,secondCallBack){var self=this;caption=caption||'';$.showModal(title,content,{'id':'lightbox','width':width||'auto','callback':function(){var lightbox=$('#lightbox');$('#lightbox-share-buttons').find('a').click(function(){var source=$(this).attr('data-func');if(source=="email"){if(window.wgUserName===null){if(window.wgComboAjaxLogin){showComboAjaxForPlaceHolder(false,"",function(){AjaxLogin.doSuccess=function(){window.location=$('#lightbox-image-link').val();}});}
else{UserLoginModal.show({callback:function(){window.location=$('#lightbox-image-link').val();}});}
return false;}}
$(this).closest('#lightbox-share').find('.lightbox-share-area').each(function(){if(source==$(this).attr('data-func')){$(this).slideDown();}else{$(this).slideUp();}});if(source=='embed'){$('#lightbox-share-embed-standard').select();}});$('#lightbox-share-email-button').click(function(){var addresses=$('#lightbox-share-email-text').val();var throbber=$(this).next('.throbber');throbber.show();$.postJSON(wgScript+'?action=ajax&rs=ImageLightboxAjax',{'addresses':addresses,'method':'sendMail','pageName':wgPageName,'title':self.imageName},function(res){throbber.hide();$.showModal(res['info-caption'],res['info-content']);});});$('#lightbox-caption-content').html(caption);var lightboxSubtitle=$('#lightbox-subtitle');if(lightboxSubtitle.text()!=''){lightboxSubtitle.show();}
lightbox.resizeModal(lightbox.width());if(typeof FB!='undefined'){FB.XFBML.parse(lightbox.get(0));}
self.setTopPosition();self.restoreInlineThumbnails();if(self.target){self.target.trigger('lightbox',[lightbox]);self.target=false;}
if(!self.afterLoadOpened&&$.getUrlVar('open')=='email'){self.afterLoadOpened=true;$('#lightbox-share-buttons').find('a[data-func$="email"]').click();$('#lightbox-share-email-text').focus();}
if(typeof secondCallBack=='function'){$.proxy(secondCallBack,this)();}
delete self.lock;}});}};if((typeof window.skin!='undefined')&&(window.skin=='monaco'||window.skin=='oasis')){$(function(){ImageLightbox.init.call(ImageLightbox);var image=$('#'+$.getUrlVar('image'));if(image.exists()){$(window).scrollTop(image.offset().top+image.height()/2-$(window).height()/2);image.find('img').click();}});};var LightboxLoader={cache:{articleMedia:[],relatedVideos:[],latestPhotos:[],wikiPhotos:[],details:{},share:{},to:0},inlineVideos:$(),inlineVideoLinks:$(),lightboxLoading:false,inlineVideoTrackingTimeout:0,pageAds:$('#TOP_RIGHT_BOXAD'),defaults:{id:'LightboxModal',className:'LightboxModal',width:970,noHeadline:true,topOffset:25,height:628,videoHeight:360,onClose:function(){$(window).off('.Lightbox');LightboxLoader.lightboxLoading=false;Lightbox.current.thumbs=[];Lightbox.current.thumbTypesAdded=[];Lightbox.to=LightboxLoader.cache.to;Lightbox.ads.adMediaProgress=[];Lightbox.ads.adWasShown=false;Lightbox.ads.adIsShowing=false;LightboxLoader.pageAds.css('visibility','visible');Lightbox.clearTrackingTimeouts();}},videoThumbWidthThreshold:400,log:function(content){$().log(content,"LightboxLoader");},track:function(action,label,value,data){var ga_params={ga_category:'lightbox',ga_action:action,ga_label:label||'',ga_value:value||0}
var trackParams=$.extend({},data||{},ga_params);WikiaTracker.trackEvent(null,trackParams,'internal');},init:function(){var article;article=$('#WikiaArticle, .LatestPhotosModule, #article-comments, #RelatedVideosRL');article.unbind('.lightbox').bind('click.lightbox',function(e){LightboxLoader.handleClick(e,$(this));});},handleClick:function(ev,parent){if(LightboxLoader.lightboxLoading){ev.preventDefault();return;}
var target=$(ev.target);if(target.hasClass('wikia-slideshow-popout')){var currentSlideMediaTitle=target.parents('.wikia-slideshow-toolbar').siblings('.wikia-slideshow-images-wrapper').find('li:visible').attr('data-image-name');LightboxLoader.loadLightbox(currentSlideMediaTitle);return;}
if(target.is('span')||target.is('img')){var next=target.next();if(next.is('.wikia-slideshow-image')){target=next;}else{target=target.parent();if(target.hasClass('Wikia-video-play-button')||target.hasClass('Wikia-video-thumb')){target.addClass('image');}}}
if(target.is('div')&&target.hasClass('playButton')){target=target.parent();}
if(!target.is('a')){return;}
if(!target.hasClass('lightbox')&&!target.hasClass('image')){return;}
if(target.hasClass('link-internal')){return;}
if(ev.ctrlKey){return;}
if(target.attr('data-shared-help')||target.hasClass('link-external')){return false;}
ev.preventDefault();var mediaTitle=false;if(target.attr('data-image-name')){mediaTitle=target.attr('data-image-name');}
else if(target.attr('ref')){mediaTitle=target.attr('ref').replace('File:','');}
else{var re=wgArticlePath.replace(/\$1/,'(.*)');var matches=target.attr('href').match(re);if(matches){mediaTitle=matches.pop().replace('File:','');}}
var targetChildImg=target.find('img').eq(0);if(targetChildImg.length>0&&targetChildImg.hasClass('Wikia-video-thumb')){if(target.data('video-name')){mediaTitle=target.data('video-name');}else if(targetChildImg.data('video')){mediaTitle=targetChildImg.data('video');}
if(mediaTitle&&targetChildImg.width()>=LightboxLoader.videoThumbWidthThreshold){LightboxLoader.displayInlineVideo(target,targetChildImg,mediaTitle);ev.preventDefault();return false;}}
LightboxLoader.parentDiv=parent;if(mediaTitle!=false){LightboxLoader.loadLightbox(mediaTitle);}},loadLightbox:function(mediaTitle){LightboxLoader.removeInlineVideos();LightboxLoader.lightboxLoading=true;LightboxLoader.pageAds.css('visibility','hidden');var openModal=$("<div>").makeModal(LightboxLoader.defaults);openModal.find(".modalContent").startThrobbing();var lightboxParams={'title':mediaTitle,'modal':openModal,'parent':LightboxLoader.parentDiv};var deferredList=[];if(!LightboxLoader.assetsLoaded){deferredList.push($.loadMustache());deferredList.push($.getResources([$.getSassCommonURL('/extensions/wikia/Lightbox/css/Lightbox.scss')]));deferredList.push($.getResources([window.wgExtensionsPath+'/wikia/Lightbox/js/Lightbox.js']));var deferredTemplate=$.Deferred();$.nirvana.sendRequest({controller:'Lightbox',method:'lightboxModalContent',type:'GET',format:'html',data:{lightboxVersion:1},callback:function(html){LightboxLoader.templateHtml=html;deferredTemplate.resolve();}});deferredList.push(deferredTemplate);}
deferredList.push(LightboxLoader.getMediaDetailDeferred({fileTitle:mediaTitle}));$.when.apply(this,deferredList).done(function(){LightboxLoader.assetsLoaded=true;Lightbox.initialFileDetail=arguments[arguments.length-1];Lightbox.makeLightbox(lightboxParams);});},displayInlineVideo:function(target,targetChildImg,mediaTitle){LightboxLoader.getMediaDetail({fileTitle:mediaTitle,height:targetChildImg.height(),width:targetChildImg.width()},function(json){var embedCode=json['videoEmbedCode'];target.hide().after(embedCode);var videoReference=target.next();if(json.playerScript){$('body').append('<script>'+json.playerScript+'</script>');}
LightboxLoader.inlineVideoLinks=target.add(LightboxLoader.inlineVideoLinks);LightboxLoader.inlineVideos=videoReference.add(LightboxLoader.inlineVideos);LightboxLoader.inlineVideoTrackingTimeout=setTimeout(function(){LightboxLoader.track(WikiaTracker.ACTIONS.VIEW,'video-inline',null,{title:json.fileTitle,provider:json.providerName});},5000);});},removeInlineVideos:function(){clearTimeout(LightboxLoader.inlineVideoTrackingTimeout);LightboxLoader.inlineVideos.remove();LightboxLoader.inlineVideoLinks.show();},getMediaDetail:function(mediaParams,callback){var title=mediaParams['fileTitle'];if(LightboxLoader.cache.details[title]){callback(LightboxLoader.cache.details[title]);}else{$.nirvana.sendRequest({controller:'Lightbox',method:'getMediaDetail',type:'get',format:'json',data:mediaParams,callback:function(json){LightboxLoader.normalizeMediaDetail(json,function(json){LightboxLoader.cache.details[title]=json;callback(json);});}});}},getMediaDetailDeferred:function(mediaParams){var deferred=$.Deferred();LightboxLoader.getMediaDetail(mediaParams,function(json){deferred.resolve(json);});return deferred;},normalizeMediaDetail:function(json,callback){var embedCode=json['videoEmbedCode'];if(typeof embedCode==='object'){var playerJson=embedCode;$.getScript(json['playerAsset'],function(){json['videoEmbedCode']='<div id="'+playerJson['id']+'"></div>';json['playerScript']=playerJson['script']+' loadJWPlayer();';callback(json);});}else{callback(json);}}};$(function(){if(!window.wgEnableLightboxExt){return;}
LightboxLoader.init();var fileTitle=$.getUrlVar('file');if(fileTitle){var file=$('#WikiaArticle .image[data-image-name="'+fileTitle+'"]');if(file.exists()){var localWindow=$(window);localWindow.scrollTop(file.offset().top+file.height()/2-localWindow.height()/2);file.find('img').click();}else{LightboxLoader.parentDiv=$('#WikiaArticle');LightboxLoader.loadLightbox(fileTitle);}}});;$(function(){var ImgLzy={cache:[],timestats:0,lastScrollTop:0,init:function(){var self=this;self.createCache();self.checkAndLoad();var throttled=$.throttle(250,$.proxy(self.checkAndLoad,self));$(window).on('scroll',throttled);},createCache:function(){var self=this;self.cache=[];$('img.lzy').each(function(idx){var cacheItem=[];var $el=$(this);var top=$el.offset().top;cacheItem.push(this);cacheItem.push($el);cacheItem.push(top);cacheItem.push($el.height()+top);self.cache[idx]=cacheItem;});},verifyCache:function(){if(this.cache.length==0){return;}
var lastidx=this.cache.length-1;var randidx=Math.floor(Math.random()*lastidx);var checkidx=[lastidx,randidx];var changed=false;for(var i in checkidx){var idx=checkidx[i];if(idx in this.cache){var pos=this.cache[idx][1].offset().top;var diff=Math.abs(pos-this.cache[idx][2]);if(diff>5){changed=true;break;}}}
if(changed){this.createCache();}},load:function(image){var $img=$(image);image.onload='';image.src=$img.data('src');$img.removeClass('lzy').removeClass('lzyPlcHld');},checkAndLoad:function(){this.verifyCache();var scrollTop=$(window).scrollTop();var scrollSpeed=Math.abs(scrollTop-this.lastScrollTop);scrollSpeed=Math.min(scrollSpeed,2000)*3+500;this.lastScrollTop=scrollTop;var scrollBottom=scrollTop+$(window).height()+scrollSpeed;scrollTop=scrollTop-scrollSpeed;var onload=function(){this.setAttribute('class',this.getAttribute('class')+" lzyLoaded");};for(var idx in this.cache){var cacheEl=this.cache[idx];var el=cacheEl[0];var $el=cacheEl[1];var elTop=cacheEl[2];var elBottom=cacheEl[3];if((scrollTop<elTop&&scrollBottom>elTop)||(scrollTop<elBottom&&scrollBottom>elBottom)){$el.addClass('lzyTrns');el.onload=onload;el.src=$el.data('src');$el.removeClass('lzy');delete this.cache[idx];}}}}
ImgLzy.init();window.ImgLzy=ImgLzy;});;function openLogin(event){if((typeof wgComboAjaxLogin=='undefined')||(!wgComboAjaxLogin)){return true;}else{showComboAjaxForPlaceHolder(false,"");event.preventDefault();}}
function openLoginAndConnect(event){if((typeof wgComboAjaxLogin=='undefined')||(!wgComboAjaxLogin)){return true;}else{if(typeof AjaxLogin=='undefined'){$.getScript(window.wgScript+'?action=ajax&rs=getRegisterJS&uselang='+window.wgUserLanguage+'&cb='+wgMWrevId+'-'+wgStyleVersion,function(){openLoginAndConnect();});}else{showComboAjaxForPlaceHolder(false,"",AjaxLogin.slideToLoginAndConnect);}
event.preventDefault();}}
function openRegister(event){if((typeof wgComboAjaxLogin=='undefined')||(!wgComboAjaxLogin)){return true;}else{showComboAjaxForPlaceHolder(false,"","",true);event.preventDefault();}}
function showComboAjaxForPlaceHolder(element,isPlaceholder,callback,showRegisterTabFirst,showLoginRequiredMessage){if(typeof showComboAjaxForPlaceHolder.statusAjaxLogin=='undefined'){showComboAjaxForPlaceHolder.statusAjaxLogin=false;}
if((wgUserName!==null)||(typeof wgComboAjaxLogin=='undefined')||(!wgComboAjaxLogin)){return false;}
if((typeof AjaxLogin!='undefined')&&AjaxLogin.showComboFromDOM()){if(isPlaceholder){AjaxLogin.setPlaceHolder(element);}
if((typeof showRegisterTabFirst!='undefined')&&showRegisterTabFirst){AjaxLogin.showRegister($('#wpGoRegister'));}else{AjaxLogin.showLogin($('#wpGoLogin'));}
return true;}
if(showComboAjaxForPlaceHolder.statusAjaxLogin){return true;}
showComboAjaxForPlaceHolder.statusAjaxLogin=true;window.scrollTo(0,0);$.getMessages('ComboAjaxLogin',function(){$().getModal(window.wgScript+'?action=ajax&rs=GetComboAjaxLogin&uselang='+window.wgUserLanguage+"&returnto="+wgPageName+"&returntoquery="+wgPageQuery+'&cb='+wgMWrevId+'-'+wgStyleVersion,false,{callback:function(){$.getScript(window.wgScript+'?action=ajax&rs=getRegisterJS&uselang='+window.wgUserLanguage+'&cb='+wgMWrevId+'-'+wgStyleVersion,function(){if(isPlaceholder){AjaxLogin.setPlaceHolder(element);}
AjaxLogin.init($('#AjaxLoginLoginForm form:first'));AjaxLogin.show();showComboAjaxForPlaceHolder.statusAjaxLogin=false;if((typeof showRegisterTabFirst!='undefined')&&showRegisterTabFirst){AjaxLogin.showRegister($('#wpGoRegister'));}else{AjaxLogin.showLogin($('#wpGoLogin'));}
if(typeof FB!='undefined'){FB.XFBML.parse();}
if((typeof showLoginRequiredMessage!='undefined')&&(showLoginRequiredMessage)){if(showLoginRequiredMessage==true){$('#comboajaxlogin-actionmsg').show();}
else if(showLoginRequiredMessage=='protected'){$('#comboajaxlogin-actionmsg-protected').show();}}
if(typeof callback=='function'){callback();}});}});});return true;}
$(function(){if((typeof wgComboAjaxLogin!='undefined')&&wgComboAjaxLogin){if(wgUserName!==null){if(window.location.href.indexOf("placeholder=")>0){element=window.location.href.split("placeholder=")[1].split("&")[0];if($("#"+element).parent().parent().hasClass("wikiaPlaceholder")){$("#"+element).trigger("click");}}}}});$(function(){$('.ajaxLogin').click(openLogin);$('.ajaxRegister').click(openRegister);if(wgUserName===null&&window.wgComboAjaxLogin){$(".wikiaPlaceholder .wikia-button").removeAttr("onclick");$(".wikiaPlaceholder .wikia-button").click(function(e){if(e.target.nodeName=="SPAN"){showComboAjaxForPlaceHolder($(e.target.parentNode).attr('id'),true);}
else
{showComboAjaxForPlaceHolder($(e.target).attr('id'),true);}
return false;});var editpromptable=$("#ca-viewsource").add("#te-editanon").add('.loginToEditProtectedPage').add(".upphotoslogin");if((typeof wgDisableAnonymousEditig!=='undefined')&&(wgDisableAnonymousEditig)){editpromptable=editpromptable.add(".editsection");}
editpromptable.click(function(e){var message=true;if($(e.target).is(".loginToEditProtectedPage")){message='protected';}else if($(e.target).is(".upphotoslogin")){message='reload';}
showComboAjaxForPlaceHolder(false,"",function(){AjaxLogin.doSuccess=function(){if(message=='protected'){AjaxLogin.doReload('action=edit');}else if(message=='reload'){AjaxLogin.doReload('');}else{var target=$(e.target);if(target.is('a')){window.location.href=target.attr('href');}else{if(target.parent().is('a')){window.location.href=target.parent().attr('href');}else{window.location.href=target.closest('nav').find('a').attr('href');}}}}},false,message);return false;});$(".wikiaComboAjaxLogin").click(function(e){showComboAjaxForPlaceHolder(false,"",function(){AjaxLogin.doSuccess=function(){CreatePage.openDialog(e,null);}});return false;});$('.require-login').click(function(e){$().log('login required for this action');if(showComboAjaxForPlaceHolder('',false,function(){AjaxLogin.doSuccess=function(){var href=$(e.target).attr('href');if(href){window.location.href=href;}};},false,true)){e.preventDefault();}});}
var clickAfterLogin=$.storage.get('AjaxLoginClickAfterLogin');if(typeof clickAfterLogin=='string'){$().log('clicking '+clickAfterLogin,'AjaxLogin');$(clickAfterLogin).click();$.storage.del('AjaxLoginClickAfterLogin');}});;var UserLoginAjaxForm=function(el,options){this.el=$(el);this.options=options||{};this.init();};UserLoginAjaxForm.prototype.init=function(){this.form=this.el.find("form");this.wikiaForm=new WikiaForm(this.form);this.inputs={username:this.form.find('input[name=username]'),password:this.form.find('input[name=password]'),keeploggedin:this.form.find('input[name=keeploggedin]'),logintoken:this.form.find('input[name=loginToken]'),returnto:this.form.find('input[name=returnto]')};this.submitButton=this.form.find('input[type=submit]');this.forgotPasswordLink=this.form.find('.forgot-password');this.retrieveLoginToken();this.inputs['returnto'].val(wgPageName);this.form.submit($.proxy(this.submitLogin,this));this.forgotPasswordLink.click($.proxy(this.mailPassword,this));this.inputs['username'].focus();};UserLoginAjaxForm.prototype.submitLogin=function(e){this.submitButton.attr('disabled','disabled');if(this.options['ajaxLogin']){e.preventDefault();this.ajaxLogin();}};UserLoginAjaxForm.prototype.ajaxLogin=function(){$.post(wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'login',format:'json',loginToken:this.loginToken,username:this.inputs['username'].val(),password:this.inputs['password'].val(),keeploggedin:this.inputs['keeploggedin'].is(':checked')},$.proxy(this.submitLoginHandler,this));};UserLoginAjaxForm.prototype.submitLoginHandler=function(json){$().log(json);$('.error-msg').remove();this.form.find('.input-group').removeClass('error');var result=json['result'],callback;if(result==='ok'){window.wgUserName=json['wgUserName'];callback=this.options['callback']||'';if(callback&&typeof callback==='function'){callback(json);}else{this.reloadPage();}}else if(result==='resetpass'){callback=this.options['resetpasscallback']||'';if(callback&&typeof callback==='function'){callback(json);}else{$.post(wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'changePassword',format:'html',username:this.inputs['username'].val(),password:this.inputs['password'].val(),returnto:this.inputs['returnto'].val(),fakeGet:1},$.proxy(this.retrieveTemplateHandler,this));}}else if(result==='unconfirm'){$.post(wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'getUnconfirmedUserRedirectUrl',format:'json',username:this.inputs['username'].val()},function(json){window.location=json['redirectUrl'];});}else{this.submitButton.removeAttr('disabled');this.errorValidation(json);}};UserLoginAjaxForm.prototype.retrieveTemplateHandler=function(html){var content=$('<div style="display:none" />').append(html);var heading=content.find('h1');var form=this.form;this.form.slideUp(400,function(){form.replaceWith(content);content.slideDown(400);});};UserLoginAjaxForm.prototype.reloadPage=function(){var location=window.location.href;var delim="?";if(location.indexOf("?")>0){delim="&";}
window.location.href=location.split("#")[0]+delim+"cb="+Math.floor(Math.random()*10000);};UserLoginAjaxForm.prototype.errorValidation=function(json){if(json['errParam']){this.wikiaForm.showInputError(json['errParam'],json['msg']);}else{this.wikiaForm.showGenericError(json['msg']);}};UserLoginAjaxForm.prototype.retrieveLoginToken=function(params){params=params||{};if(!this.loginToken||params['clearCache']){this.loginToken='retrieving';$.post(wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'retrieveLoginToken',format:'json'},$.proxy(function(res){this.loginToken=res.loginToken;this.inputs['logintoken'].val(res.loginToken);},this));}};UserLoginAjaxForm.prototype.mailPassword=function(e){e.preventDefault();$('.error-msg').remove();this.form.find('.input-group').removeClass('error');this.form.find('.error-msg').remove();$().log('mailing password');$.post(wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'mailPassword',format:'json',username:this.inputs['username'].val()},$.proxy(this.mailPasswordHandler,this));};UserLoginAjaxForm.prototype.mailPasswordHandler=function(json){$().log(json);if(json['result']==='ok'){this.errorValidation(json);}else if(json['result']==='error'){this.errorValidation(json);}};;var UserSignupAjaxForm=function(wikiaForm,inputsToValidate,submitButton){this.wikiaForm=wikiaForm;this.inputsToValidate=inputsToValidate||[];this.submitButton=$(submitButton);};UserSignupAjaxForm.prototype.validateInput=function(e){var el=$(e.target);var paramName=el.attr('name');var params={controller:'UserSignupSpecial',method:'formValidation',format:'json',field:paramName};params[paramName]=el.val();var proxyObj={'paramName':paramName,'form':this};$.post(wgScriptPath+'/wikia.php',params,$.proxy(this.validationHandler,proxyObj));};UserSignupAjaxForm.prototype.validationHandler=function(res){var paramName=this.paramName;var form=this.form;if(res['result']==='ok'){form.wikiaForm.clearInputError(this.paramName);}else{form.wikiaForm.showInputError(this.paramName,res['msg']);}
var isInvalid=false;var inputsToValidate=form.inputsToValidate;for(var i=0;i<inputsToValidate.length;i++){if(form.wikiaForm.getInputGroup(inputsToValidate[i]).hasClass('error')){isInvalid=true;break;}}
if(isInvalid){form.submitButton.attr('disabled','disabled');}else{form.submitButton.removeAttr('disabled');}};;var UserLoginModal={loginAjaxForm:false,show:function(options){if(!window.wgComboAjaxLogin&&window.wgEnableUserLoginExt){options=options||{};$.get(wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'modal',format:'html',uselang:window.wgUserLanguage},function(res){UserLoginModal.dialog=$(res).makeModal({width:350});UserLoginModal.loginAjaxForm=new UserLoginAjaxForm(UserLoginModal.dialog,{ajaxLogin:true,callback:function(res){var callback=options['callback'];if(callback&&typeof callback==='function'){if(!options['persistModal']){UserLoginModal.dialog.closeModal();}
callback();}else{UserLoginModal.loginAjaxForm.reloadPage();}},resetpasscallback:function(res){$.post(wgScriptPath+'/wikia.php',{controller:'UserLoginSpecial',method:'changePassword',format:'html',username:UserLoginModal.loginAjaxForm.inputs['username'].val(),password:UserLoginModal.loginAjaxForm.inputs['password'].val(),returnto:UserLoginModal.loginAjaxForm.inputs['returnto'].val(),fakeGet:1},function(html){var content=$('<div style="display:none" />').append(html);var heading=content.find('h1');UserLoginModal.dialog.find('h1').text(heading.text());heading.remove();var contentBlock=UserLoginModal.dialog.find('.UserLoginModal');contentBlock.slideUp(400,function(){contentBlock.html('').html(content);content.show();contentBlock.slideDown(400);});});}});UserLoginFacebook.init();});$.getResources([$.getSassCommonURL('/extensions/wikia/UserLogin/css/UserLoginModal.scss')]);return true;}else if(window.wgComboAjaxLogin){showComboAjaxForPlaceHolder(false,false,function(){if(options['callback']){AjaxLogin.doSuccess=options['callback'];}},false,true);return true;}
return false;},isPreventingForceLogin:function(element){if(!(element.closest('span').hasClass('drop'))&&!(element.closest('ul').hasClass('WikiaMenuElement'))){return false;}
return true;},init:function(){var editpromptable=$("#ca-viewsource, #te-editanon, .loginToEditProtectedPage, .upphotoslogin");if(window.wgDisableAnonymousEditing){editpromptable=editpromptable.add(".editsection");}
editpromptable.click($.proxy(function(ev){ev.stopPropagation();if(!this.isPreventingForceLogin($(ev.target))&&UserLogin.isForceLogIn()){ev.preventDefault();}},this));$('body').delegate('.ajaxLogin','click',function(e){UserLoginModal.show();e.preventDefault();});}};$(function(){if((typeof window.wgEnableUserLoginExt!='undefined')&&wgEnableUserLoginExt){UserLoginModal.init();}});;(function(window,$,undefined){if(window.wgIsEditPage){return;}
var MiniEditor={assetsLoaded:false,loadingAssets:false,wrapperSelector:'.MiniEditorWrapper',initTime:0,initTimer:null,loadTime:0,loadTimer:null,ckeditorEnabled:false,editorSuite:'mweditorsuite',editorIsLoading:false,config:{animations:{},isMiniEditor:true,mode:'source',toolbars:{tabs:[],toolbar:['FormatMiniEditorSource','InsertMiniEditor'],rail:[]}},plugins:['MiniEditor','loadingstatus'],configure:function(){if(!this.assetsLoaded){return;}
if(typeof RTE!='undefined'){this.ckeditorEnabled=true;this.editorSuite='ckeditorsuite';this.config.mode=window.RTEInitMode||'wysiwyg';this.config.toolbars.toolbar=['ModeSwitch','FormatMiniEditor'].concat(this.config.toolbars.toolbar);RTE.config.contentsCss.push($.getSassLocalURL('extensions/wikia/MiniEditor/css/core/content.scss'));RTE.overlayNode.bind('click.MiniEditor',function(){RTE.overlayNode.data('wikiaEditor').setAsActiveInstance();});}
this.plugins.unshift(this.editorSuite);this.config.uiElements=window.wgEditorExtraButtons||{};GlobalTriggers.fire('MiniEditorReady');},loadAssets:function(callback){var self=this;if(this.loadingAssets||this.assetsLoaded){if($.isFunction(callback)){callback();}
return;}
this.loadTimer=new Date();$().log('Start resource loading','MiniEditor');this.loadingAssets=true;$.nirvana.sendRequest({controller:'MiniEditorController',method:'makeGlobalVariables',type:'POST',callback:function(data){var assets=window.wgMiniEditorAssets;for(var v in data){window[v]=data[v];}
if(typeof assets!='undefined'&&$.isArray(assets)){$.each(assets,function(i,path){assets[i]=window.wgResourceBasePath+path;});assets=window.wgMiniEditorAssets=data.wgMiniEditorAssets.concat(assets);}
$.getResources(assets,$.proxy(function(){this.loadTime=(new Date().getTime()-this.loadTimer.getTime());$().log('End resource loading ('+this.loadTime+'ms)','MiniEditor');this.assetsLoaded=true;this.loadingAssets=false;this.configure();if($.isFunction(callback)){callback();}},self),function(jqXHR,status,error){$().log(arguments,'MiniEditor');});}});},loading:function(element,preloading){$(element).closest(this.wrapperSelector).addClass(preloading?'preloading':'loading');this.editorIsLoading=true;},initEditor:function(element,options,event){var $element=$(element),$wrapper=$element.closest(this.wrapperSelector),preloading=event&&event.target&&event.target!=$element.get(0);if(this.loadingAssets){return;}
if(!this.assetsLoaded){this.loading($element,preloading);return this.loadAssets($.proxy(function(){this.initEditor(element,options);},this));}
var wikiaEditor=$element.data('wikiaEditor');if(wikiaEditor&&wikiaEditor.ready){wikiaEditor.fire('editorActivated',(wikiaEditor.event=event));}else if((wikiaEditor||(wikiaEditor=WikiaEditor.getInstance()))&&!wikiaEditor.ready){this.loading($element,preloading);wikiaEditor.fire('editorBeforeReady',(wikiaEditor.event=event));}else{this.initTimer=new Date();$().log('Start initialization','MiniEditor');options=$.extend(true,{},$.fn.miniEditor.options,options);var self=this,events=$.extend({},options.events);this.loading($element,preloading);events.editorReady=function(){self.editorIsLoading=false;if($.isFunction(options.events.editorReady)){options.events.editorReady.apply(self,arguments);}}
$element.bind(events);if(options.content!==undefined){$element.html(options.content);}
wikiaEditor=WikiaEditor.create(this.plugins,$.extend(true,{},this.config,{body:$element,element:$wrapper.addClass(this.editorSuite),minHeight:$element.data('min-height')||200,mode:$.isArray(options.edgeCases)&&options.edgeCases.length?'source':this.config.mode,maxHeight:$element.data('max-height')||400,startupFocus:!preloading},options.config),event);$element.addClass('wikiaEditor').triggerHandler('editorInit',[wikiaEditor,event]);}},getStartupMode:function(element){var $element=$(element);if($element.length){var wikiaEditor=$element.data('wikiaEditor');if(wikiaEditor){return wikiaEditor.mode;}}
return this.config.mode;},getLoadConversionFormat:function(element){return WikiaEditor.modeToFormat(this.getStartupMode(element))=='richtext'?'richtext':'';},getSaveConversionFormat:function(element){return this.getLoadConversionFormat(element)=='richtext'?'wikitext':'';}};$.fn.miniEditor=function(options,event){return this.each(function(){MiniEditor.initEditor(this,options,event);});};$.fn.miniEditor.options={config:{},events:{}};$(function(){if(!window.wgMiniEditorLoadOnDemand){MiniEditor.assetsLoaded=true;MiniEditor.configure();}});window.MiniEditor=MiniEditor;})(this,jQuery);;(function(window,$){if(!window.wgIsArticle){return;}
var $window=$(window);var ArticleComments={animations:{},processing:false,mostRecentCount:0,messagesLoaded:false,miniEditorEnabled:typeof window.wgEnableMiniEditorExt!='undefined'&&skin=='oasis',loadOnDemand:typeof window.wgArticleCommentsLoadOnDemand!='undefined',initCompleted:false,init:function(){var $articleComments=$('#article-comments');var $articleCommFbMonit=$('#article-comm-fbMonit');var $fbCommentMessage=$('#fbCommentMessage')
if(ArticleComments.miniEditorEnabled){var newcomment=$('#article-comm');newcomment.bind('focus',function(e){ArticleComments.editorInit(this);});if(newcomment.is(':focus')){ArticleComments.editorInit(newcomment);}}
$articleComments.on('click','.article-comm-edit',ArticleComments.actionProxy(ArticleComments.edit));$articleComments.on('click','.article-comm-reply',ArticleComments.actionProxy(ArticleComments.reply));$('#article-comm-submit').bind('click',{source:'#article-comm'},ArticleComments.actionProxy(ArticleComments.postComment));$articleCommFbMonit.mouseenter(function(){$fbCommentMessage.fadeIn('slow');});$articleCommFbMonit.mouseleave(function(){$fbCommentMessage.fadeOut('slow');});ArticleComments.addHover();ArticleComments.showEditLink();ArticleComments.initCompleted=true;},actionProxy:function(callback){return function(e){e.preventDefault();if(ArticleComments.miniEditorEnabled&&MiniEditor.editorIsLoading){$().log('Event cancelled because editor is loading: ',e);return true;}
callback.apply(this,arguments);};},showEditLink:function(){if(wgUserName){$('#article-comments-ul details').find('a:contains("'+wgUserName+'")').closest('details').find('.edit-link').show();}},edit:function(e){e.preventDefault();if(ArticleComments.processing){return;}
if(ArticleComments.miniEditorEnabled&&!MiniEditor.assetsLoaded){MiniEditor.loadAssets(makeRequest);}else{makeRequest();}
function makeRequest(){var commentId=e.target.id.replace(/^comment/,''),textfield=$('#article-comm-textfield-'+commentId);$.getJSON(wgScript,{action:'ajax',article:wgArticleId,convertToFormat:ArticleComments.getLoadConversionFormat(textfield),id:commentId,method:'axEdit',rs:'ArticleCommentsAjax'},function(json){if(!json.error){var buttons=$(e.target).closest('.buttons'),divFormSelector='#article-comm-div-form-'+json.id,textfieldSelector='#article-comm-textfield-'+json.id,commentTextDiv=$('#comm-text-'+json.id).hide(),editDivForm=$(divFormSelector),blockquote=commentTextDiv.parent(),editTemplate=$(json.text).hide(),content=editTemplate.find(textfieldSelector).val();if(!editDivForm.length){blockquote.append(editTemplate.attr('id',divFormSelector.substr(1)));editDivForm=$(divFormSelector);}
var textfield=$(textfieldSelector);if(ArticleComments.miniEditorEnabled){ArticleComments.editorInit(textfield,content,json.edgeCases);}else{textfield.val(content);}
editDivForm.show();buttons.hide();$('#article-comm-submit-'+json.id).bind('click',{id:json.id,emptyMsg:json.emptyMsg},ArticleComments.actionProxy(ArticleComments.saveEdit));$('#article-comm-edit-cancel-'+json.id).bind('click',{id:json.id,target:e.target,text:json.text},ArticleComments.actionProxy(ArticleComments.cancelEdit));}
ArticleComments.processing=false;});}
ArticleComments.processing=true;},cancelEdit:function(e){var commentId=e.data.id;e.preventDefault();if(ArticleComments.miniEditorEnabled){$('#article-comm-textfield-'+commentId).data('wikiaEditor').fire('editorDeactivated');}
$('#article-comm-div-form-'+commentId).hide();$(e.data.target).closest('.buttons').show();$('#comm-text-'+commentId).show();},saveEdit:function(e){e.preventDefault();if(ArticleComments.processing){return;}
var commentId=e.data.id,commentFormDiv=$('#article-comm-form-'+commentId);if(commentFormDiv.length){var throbber=$(e.target).siblings('.throbber'),submitButton=$('#article-comm-submit-'+commentId),textfield=$('#article-comm-textfield-'+commentId),content=ArticleComments.getContent(textfield);submitButton.parent().find('.info').remove();if($.trim(content)==''){submitButton.after($('<span>').addClass('info').html(e.data.emptyMsg));return;}
$('#article-comm-info').html('');throbber.css('visibility','visible');textfield.attr('readonly','readonly');$.postJSON(wgScript,{action:'ajax',article:wgArticleId,convertToFormat:ArticleComments.getSaveConversionFormat(textfield),id:commentId,method:'axSave',rs:'ArticleCommentsAjax',title:wgPageName,wpArticleComment:content},function(json){throbber.css('visibility','hidden');if(!json.error){if(json.commentId&&json.commentId!=0){var comment=$('#comm-'+json.commentId),saveTemplate=$(json.text);$('#article-comm-div-form-'+json.commentId).hide();if(ArticleComments.miniEditorEnabled){textfield.data('wikiaEditor').fire('editorReset');}
comment.find('.article-comm-text').html(saveTemplate.find('.article-comm-text').html()).show();comment.find('.edited-by').html(saveTemplate.find('.edited-by').html());}}else{$('#article-comm-info').html(json.msg);}
textfield.removeAttr('readonly');ArticleComments.processing=false;});ArticleComments.processing=true;}},reply:function(e){e.preventDefault();if(ArticleComments.processing){return;}
$.getJSON(wgScript,{action:'ajax',article:wgArticleId,id:$(this).closest('li').attr('id').replace(/^comm-/,''),method:'axReply',rs:'ArticleCommentsAjax',title:wgPageName},function(json){var comment=$('#comm-'+json.id),blockquote=$('#comm-text-'+json.id).parent(),editbox=blockquote.find('.article-comm-edit-box'),buttons=blockquote.find('.buttons').hide();blockquote.find('.info').remove();if(editbox.length){editbox.show();}else if(!json.error){blockquote.append(json.html);$('#article-comm-reply-submit-'+json.id).bind('click',{source:'#article-comm-reply-textfield-'+json.id,parentId:json.id},ArticleComments.actionProxy(ArticleComments.postComment));}else if(json.error==2){blockquote.find('.tools').after($('<span>').addClass('info').html(json.msg));}else{$.showModal('',json.msg);}
var textfield=$('#article-comm-reply-textfield-'+json.id);if(ArticleComments.miniEditorEnabled){ArticleComments.editorInit(textfield,{editorActivated:function(event,wikiaEditor){blockquote.find('.article-comm-edit-box').show();},editorDeactivated:function(event,wikiaEditor){if(!wikiaEditor.getContent()){blockquote.find('.article-comm-edit-box').hide();buttons.show();}}});}else{textfield.focus();}
ArticleComments.processing=false;});ArticleComments.processing=true;},postComment:function(e){e.preventDefault();if(ArticleComments.processing){return;}
var source=$(e.data.source),target=$(e.target),throbber=target.siblings('.throbber'),content=ArticleComments.getContent(source),showall=$.getUrlVar('showall');if($.trim(content)==''){return;}
throbber.css('visibility','visible');source.attr('readonly','readonly');target.attr('disabled',true);var data={action:'ajax',article:wgArticleId,convertToFormat:ArticleComments.getSaveConversionFormat(source),method:'axPost',rs:'ArticleCommentsAjax',title:wgPageName,wpArticleComment:content};if(e.data.parentId){data.parentId=e.data.parentId;data.page=$('.article-comments-pagination-link-active').eq(0).attr('page');}
if(showall){data.showall=1;}
function makeRequest(){$.postJSON(wgScript,data,function(json){throbber.css('visibility','hidden');if(ArticleComments.miniEditorEnabled){source.data('wikiaEditor').fire('editorReset');}else{source.val('');}
if(!json.error){var parent,subcomments,parentId=json.parentId,nodes=$(json.text);if(parentId){parent=$('#comm-'+parentId);subcomments=parent.next();if(!subcomments.hasClass('sub-comments')){parent.after(subcomments=$('<ul class="sub-comments"></ul>'));}
subcomments.append(nodes);parent.find('.article-comm-edit-box').hide();parent.find('.buttons').show();}else{nodes.prependTo('#article-comments-ul');}
$('#article-comments-counter-header').html($.msg('oasis-comments-header',json.counter));if(window.skin=='oasis'){$('#WikiaPageHeader').find('.commentsbubble').html(json.counter);if(!parentId){if(!ArticleComments.mostRecentCount){ArticleComments.mostRecentCount=$('#article-comments-ul > li').length;}else{ArticleComments.mostRecentCount++;}
$('#article-comments-counter-recent').html($.msg('oasis-comments-showing-most-recent',ArticleComments.mostRecentCount));}}
ArticleComments.addHover();ArticleComments.showEditLink();$('#article-comm-info').html('');}else{$('#article-comm-info').html(json.msg);}
source.removeAttr('readonly');$(e.target).removeAttr('disabled');ArticleComments.processing=false;});ArticleComments.processing=true;}
if(!ArticleComments.messagesLoaded){$.getMessages('ArticleCommentsCounter',function(){ArticleComments.messagesLoaded=true;makeRequest();});}else{makeRequest();}},setPage:function(e){e.preventDefault();var page=parseInt($(this).attr('page'));var $commentsList=$('#article-comments-ul').addClass('loading');$.getJSON(wgScript+'?action=ajax&rs=ArticleCommentsAjax&method=axGetComments&article='+wgArticleId,{page:page,order:$('#article-comm-order').attr('value')},function(json){$commentsList.removeClass('loading');if(!json.error){$commentsList.html(json.text);var $articleCommentsPagination=$('.article-comments-pagination');if($articleCommentsPagination.exists()){$articleCommentsPagination.html(json.pagination);}
ArticleComments.addHover();}
ArticleComments.processing=false;});},addHover:function(){$('.article-comments-pagination-link').bind('click',ArticleComments.setPage).not('.article-comments-pagination-link-active, #article-comments-pagination-link-prev, #article-comments-pagination-link-next').hover(function(){$(this).addClass('accent');},function(){$(this).removeClass('accent');});},editorInit:function(element,events,content,edgeCases){var $element=$(element),wikiaEditor=$element.data('wikiaEditor');if(typeof events==='string'){edgeCases=content;content=events;events={};}
var hasEdgeCases=$.isArray(edgeCases)&&edgeCases.length;if(wikiaEditor){wikiaEditor.fire('editorActivated');if(content!==undefined){if(hasEdgeCases){wikiaEditor.ck.setMode('source');}
wikiaEditor.setContent(content);}}else{var actionButtons=$('#WikiaArticleComments .actionButton').addClass('disabled').attr('disabled',true);if(content!==undefined){$element.val(content);}
function initEditor(){events=events||{};var editorActivated=events.editorActivated;events.editorActivated=function(event,wikiaEditor){actionButtons.removeClass('disabled').removeAttr('disabled');if($.isFunction(editorActivated)){editorActivated.apply(this,arguments);}};$element.miniEditor({config:{animations:MiniEditor.Wall.Animations,mode:hasEdgeCases?'source':MiniEditor.config.mode},events:events});}
if(!MiniEditor.assetsLoaded){MiniEditor.loading($element);MiniEditor.loadAssets(initEditor);}else{initEditor();}}},getContent:function(element){return ArticleComments.miniEditorEnabled?element.data('wikiaEditor').getContent():element.val();},getLoadConversionFormat:function(element){return ArticleComments.miniEditorEnabled?MiniEditor.getLoadConversionFormat(element):'';},getSaveConversionFormat:function(element){return ArticleComments.miniEditorEnabled?MiniEditor.getSaveConversionFormat(element):'';},scrollToElement:function(element){var $element=$(element);var docViewTop=$window.scrollTop();var docViewBottom=docViewTop+$window.height();var elementTop=$element.offset().top;if(elementTop<docViewTop||elementTop>docViewBottom){$('html, body').animate({scrollTop:elementTop},1);}}};if(ArticleComments.loadOnDemand){$(function(){var content,hash=window.location.hash,permalink=/^#comm-/.test(hash),styleAssets=[$.getSassCommonURL('skins/oasis/css/core/ArticleComments.scss')],$comments=$('#WikiaArticleComments');var belowTheFold=function(){return $comments.offset().top>=($window.scrollTop()+$window.height());};if(ArticleComments.miniEditorEnabled){styleAssets.push($.getSassCommonURL('extensions/wikia/MiniEditor/css/MiniEditor.scss'));styleAssets.push($.getSassCommonURL('extensions/wikia/MiniEditor/css/ArticleComments/ArticleComments.scss'));}
var loadAssets=function(){$.when($.getResources(styleAssets),$.nirvana.sendRequest({controller:'ArticleCommentsController',method:'Content',format:'html',type:'GET',data:{articleId:window.wgArticleId,page:$comments.data('page'),skin:true},callback:function(response){content=response;}})).then(function(){$comments.removeClass('loading').html(content);ArticleComments.init();if(permalink){ArticleComments.scrollToElement(hash);}});};if(!permalink&&belowTheFold()){$window.on('scrollstop.ArticleCommentsLoadOnDemand',function(event){if(!belowTheFold()){$window.off('scrollstop.ArticleCommentsLoadOnDemand');loadAssets();}});}else{loadAssets();}});}else{wgAfterContentAndJS.push(ArticleComments.init);}
window.ArticleComments=ArticleComments;})(this,jQuery);;window.onFBloaded=function(){var fbAppId=window.fbAppId,channelUrl=window.location.protocol+'//'+
window.location.host+window.wgScriptPath+'/channel.php?lang='+encodeURIComponent(window.fbScriptLangCode);if(typeof fbAppId!='string'){$().log('FB','appId is empty!');return;}
FB.init({appId:fbAppId,oauth:true,status:true,cookie:true,xfbml:window.fbUseMarkup,channelUrl:channelUrl});if(typeof GlobalTriggers!='undefined'){GlobalTriggers.fire('fbinit');}};$(function(){$('#pt-fbconnect,#pt-fblink,#pt-fbconvert').addClass('mw-fblink');$('#pt-fblogout').click(function(){var logout=confirm("You are logging out of both this site and Facebook.");if(logout){FB.logout(function(response){window.location=window.fbLogoutURL;});}});$("#fbconnect a").on('click',function(ev){loginByFBConnect();ev.preventDefault();});if($.getUrlVar('ref')==='fbfeed'){var suffix='',type=$.getUrlVar('fbtype');if(type!==''){suffix='/'+type;}}
if(skin=='oasis'){var timer=null,mouseIn=false,FBbutton=$('#WikiaPageHeader .likes :first-child');var poll=function(){if(FBbutton.children('span').filter(':visible').length>1){}else{if(!mouseIn){clearInterval(timer);}}};$('#WikiaPageHeader .likes').hover(function(){mouseIn=true;timer=setInterval(poll,250);},function(){mouseIn=false;if(FBbutton.children('span').filter(':visible').length<2){clearInterval(timer);}});}});function sendToConnectOnLogin(){sendToConnectOnLoginForSpecificForm("");}
function sendToConnectOnLoginForSpecificForm(formName){FB.getLoginStatus(function(response){if(formName!=""){formName="/"+formName;}
var destUrl=wgServer+wgScript+"?title=Special:Connect"+formName+"&returnto="+encodeURIComponent(window.fbReturnToTitle||wgPageName)+"&returntoquery="+encodeURIComponent(window.wgPageQuery||'');if(formName=="/ConnectExisting"){window.location.href=destUrl;return;}
$('#fbConnectModalWrapper').remove();$.postJSON(window.wgScript+'?action=ajax&rs=SpecialConnect::checkCreateAccount&cb='+wgStyleVersion,function(data){if(data.status=="ok"){$().getModal(window.wgScript+'?action=ajax&rs=SpecialConnect::ajaxModalChooseName&returnto='+encodeURIComponent(wgPageName)+'&returntoquery='+encodeURIComponent(window.wgPageQuery||''),"#fbConnectModal",{id:"fbConnectModalWrapper",width:600});}else{window.location.href=destUrl;}});});}
function openFbLogin(){FB.login(sendToConnectOnLogin,{scope:"publish_stream"});}
function loginByFBConnect(){openFbLogin();return false;}
function loginAndConnectExistingUser(){AjaxLogin.action='loginAndConnect';AjaxLogin.form.unbind('submit');AjaxLogin.form=$('#userajaxconnectform');AjaxLogin.form.submit(function(ev){AjaxLogin.formSubmitHandler(ev);return false;});}
window.wgAjaxLoginOnInit=function(){AjaxLogin.slideToNormalLogin=function(el){var firstSliderCell=$("#AjaxLoginSliderNormal");var slideto=0;AjaxLogin.beforeDoSuccess=function(){return true;};$("#AjaxLoginConnectMarketing a.forward").show();$("#AjaxLoginConnectMarketing a.back").hide();firstSliderCell.animate({marginLeft:slideto},function(){$('#fbLoginAndConnect').hide();});};AjaxLogin.slideToLoginAndConnect=function(el){$('#fbLoginAndConnect').show();var firstSliderCell=$("#AjaxLoginSliderNormal");var slideto=-351;$("#AjaxLoginConnectMarketing a.forward").hide();$("#AjaxLoginConnectMarketing a.back").show();AjaxLogin.beforeDoSuccess=function(){FB.getLoginStatus(function(response){if(response.session){sendToConnectOnLoginForSpecificForm("ConnectExisting");}else{var slideto=-354;$('#userloginErrorBox3').hide();$('#fbLoginLastStep').show();$('#AjaxLoginConnectMarketing').animate({marginLeft:slideto},function(){$('#fbLoginAndConnect').animate({marginLeft:slideto});});$('#fbLoginAndConnect').hide();}});return false;}
firstSliderCell.animate({marginLeft:slideto});};AjaxLogin.LoginAndConnectHideBack=function(){$("#AjaxLoginConnectMarketing a.back").hide();};AjaxLogin.slider=function(e){if(typeof e!='undefined'){e.preventDefault();}
if($(this).hasClass("forward")){AjaxLogin.slideToLoginAndConnect(this);}else{AjaxLogin.slideToNormalLogin(this);}};$("#AjaxLoginConnectMarketing a").click(AjaxLogin.slider);}
function fixXFBML(id){if(typeof $.browser.msie!='undefined'&&typeof $.browser.version!='undefined'&&$.browser.version&&$.browser.version.substring(0,$.browser.version.indexOf('.'))<9){GlobalTriggers.bind('fbinit',function(){var node=$('#'+id).parent(),html=node.html();node.html('').append(html);FB.XFBML.parse(node.get(0));});}}
$(function(){if(window.wgCanonicalSpecialPageName==='Connect'){fixXFBML('fbSpecialConnect');}});;var MeeboBar={network:'',init:function(){switch(window.cscoreCat){case'Entertainment':MeeboBar.network='wikia_entertainment';break;case'Gaming':MeeboBar.network='wikia_gaming';break;default:MeeboBar.network='wikia_lifestyles';}
window.Meebo||function(c){function p(){return["<",i,' onload="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='//cim.meebo.com/cim?iv=",a.v,"&",q,"=",c[q],c[l]?"&"+l+"="+c[l]:"",c[e]?"&"+e+"="+c[e]:"","'\"></",i,">"].join("")}var f=window,a=f.Meebo=f.Meebo||function(){(a._=a._||[]).push(arguments)},d=document,i="body",m=d[i],r;if(!m){r=arguments.callee;return setTimeout(function(){r(c)},100)}a.$={0:+new Date};a.T=function(u){a.$[u]=new Date-a.$[0]};a.v=5;var j="appendChild",h="createElement",k="src",l="lang",q="network",e="domain",n=d[h]("div"),v=n[j](d[h]("m")),b=d[h]("iframe"),g="document",o,s=function(){a.T("load");a("load")};f.addEventListener?f.addEventListener("load",s,false):f.attachEvent("onload",s);n.style.display="none";m.insertBefore(n,m.firstChild).id="meebo";b.frameBorder="0";b.name=b.id="meebo-iframe";b.allowTransparency="true";v[j](b);try{b.contentWindow[g].open()}catch(w){c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{var t=b.contentWindow[g];t.write(p());t.close()}catch(x){b[k]=o+'d.write("'+p().replace(/"/g,'\\"')+'");d.close();'}a.T(1)}({network:MeeboBar.network});Meebo.disableSharePageButton=true;Meebo('domReady');Meebo(function(){$('body').trigger('meebo-load').on('click',$('#meebo'),function(){$(this).trigger('meebo-click');setTimeout(MeeboBar.checkVisibility,1000);});MeeboBar.checkVisibility();});},checkVisibility:function(){if($('#meebo').children().eq(0).css('overflow')=='visible'){$('body').trigger('meebo-visible');}else{$('body').trigger('meebo-hidden');}}};if(window.wgEnableMeeboExt&&Wikia.geo.getGeoData().country==='US'){MeeboBar.init();};var GlobalNotification={init:function(){GlobalNotification.dom=$('.global-notification');if(GlobalNotification.dom.length){GlobalNotification.setUpClose();}},createDom:function(){if(!GlobalNotification.dom.length){GlobalNotification.dom=$('<div class="global-notification"><button class="close wikia-chiclet-button"><img src="'+stylepath+'/oasis/images/icon_close.png"></button><div class="msg"></div></div>').hide();GlobalNotification.setUpClose();}
if(GlobalNotification.isModal()){GlobalNotification.modal.prepend(GlobalNotification.dom);}else{if($('.oasis-split-skin').length){$('.WikiaHeader').after(GlobalNotification.dom);}else{$('.WikiaPageContentWrapper').prepend(GlobalNotification.dom);}}
GlobalNotification.msg=GlobalNotification.dom.find('.msg');},show:function(content,type){GlobalNotification.content=content;var callback=function(){GlobalNotification.createDom();GlobalNotification.msg.html(GlobalNotification.content);GlobalNotification.dom.removeClass('confirm, error, notify, warn').addClass(type);if(window.WikiaFooterApp){WikiaFooterApp.addScrollEvent();}
GlobalNotification.dom.fadeIn('slow');};GlobalNotification.hide(callback);},hide:function(callback){if(GlobalNotification.dom.length){GlobalNotification.dom.fadeOut(400,function(){GlobalNotification.dom.remove();GlobalNotification.dom=[];if(jQuery.isFunction(callback)){callback();}});}else{callback();}},isModal:function(){GlobalNotification.modal=$('.modalWrapper');if(GlobalNotification.modal.length>0&&GlobalNotification.modal.is(':visible')){return true;}
return false;},setUpClose:function(){GlobalNotification.dom.find('.close').click(GlobalNotification.hide);},wikiaHeaderHeight:$('#WikiaHeader').height(),onScroll:function(scrollTop){if(GlobalNotification.dom&&GlobalNotification.dom.length){var minTop=GlobalNotification.wikiaHeaderHeight;if(scrollTop>minTop){GlobalNotification.dom.addClass('float');}else{GlobalNotification.dom.removeClass('float');}}}};$(function(){GlobalNotification.init();});if(typeof wgAjaxFailureMsg!='undefined'){$(document).ajaxError(function(evt,request,settings){GlobalNotification.show(wgAjaxFailureMsg,'error');});};var GlobalModal={init:function(){var modal=$.getUrlVar('modal');if(modal){var f=GlobalModal['show'+modal];if(typeof f==='function'){f();}}},showUploadImage:function(){if(!wgUserName){$('.ajaxLogin').trigger('click');}else{$('.upphotos').trigger('click');}},showAddPage:function(){if(!wgUserName){$('.ajaxLogin').trigger('click');}else{$('.createpage').trigger('click');}},showLogin:function(){if(!wgUserName){$('.ajaxLogin').trigger('click');}},showAdopt:function(){$.when($.getResources([$.getSassCommonURL('/extensions/wikia/AutomaticWikiAdoption/css/AutomaticWikiAdoption.scss')]),$.nirvana.sendRequest({controller:'AutomaticWikiAdoption',method:'AdoptWelcomeDialog',format:'html',type:'get',data:{cb:wgCurRevisionId}})).then(function(sass,nirvanaData){var html=nirvanaData[0];$(html).makeModal({width:500,height:400});});}}
$(function(){GlobalModal.init();});;var UserLogin={rteForceLogin:function(){if(!window.wgComboAjaxLogin){window.onbeforeunload=function(){};UserLoginModal.show({persistModal:true,callback:function(){window.WikiaEditor&&WikiaEditor.reloadEditor();}});}else{showComboAjaxForPlaceHolder("",false,"",false,true);}},isForceLogIn:function(){if(wgUserName==null){window.onbeforeunload=function(){};if(!window.wgComboAjaxLogin){UserLoginModal.show();return true;}
else if(showComboAjaxForPlaceHolder("",false,"",false,true)){return true;}}
return false;}};;var LatestActivity={init:function(){LatestActivity.lazyLoadContent();},lazyLoadContent:function(){$.nirvana.sendRequest({controller:'LatestActivity',method:'Index',format:'html',type:'GET',callback:function(html){if($.browser.msie){$("section.WikiaActivityModule:not(.UserProfileRailModule_RecentActivity)").empty().append(html);}
else{$('section.WikiaActivityModule:not(.UserProfileRailModule_RecentActivity)').replaceWith(html);}}});}};$(window).load(function(){LatestActivity.init();});;$(function(){mw.util.toggleToc($('#togglelink'));});;$(window).load(function(){if(window.ExitstitialOutboundScreen){Exitstitial.init();}});var Exitstitial={settings:{destinationURL:'',adUrl:''},init:function(){Exitstitial.attachEventListeners();},attachEventListeners:function(){var externalLinks=$('.WikiaArticle a.external.exitstitial');$(externalLinks).click(function(){Exitstitial.settings.destinationURL=$(this).attr("href");Exitstitial.settings.adUrl=ExitstitialOutboundScreen+"&u="+Exitstitial.settings.destinationURL;Exitstitial.showInfobox();return false;});},showInfobox:function(){var header=wgExitstitialTitle,body="<div id='ExitstitialInfobox'><div class='wikia-ad'></div></div>";$.showModal(header,body,{id:'ExitstitialInfoboxWrapper',width:$(window).width()-250,height:$(window).height()-250});$('#ExitstitialInfoboxWrapper').find(".close").hide();$('#ExitstitialInfoboxWrapper').prepend('<a href="'+Exitstitial.settings.destinationURL+'" class="wikia-button close-exitstitial-ad" id="skip_ad">'+wgExitstitialButton+'</a>');$('#ExitstitialInfoboxWrapper').find("h1:first").after('<p class="exitstitial-intro">'+wgExitstitialRegister+'</p>');$('.exitstitial-intro a').click(function(event){event.preventDefault();$('#ExitstitialInfoboxWrapper').closeModal();if($(this).hasClass("register")){openRegister();}else if($(this).hasClass("login")){openLogin();}});$("#ExitstitialInfobox .wikia-ad").css('visibility','visible');Exitstitial.ajaxLoadAd();},ajaxLoadAd:function(){$.get(Exitstitial.settings.adUrl,function(data){$("#ExitstitialInfobox").html(data);});}};;var UserLoginFacebook={modal:false,form:false,callbacks:{},initialized:false,log:function(msg){$().log(msg,'UserLoginFacebook');},init:function(){if(!this.initialized){this.initialized=true;this.loginSetup();this.setupTooltips();this.log('init');}},setupTooltips:function(){$('.sso-login > a').tooltip();},loginSetup:function(){$('body').undelegate('fb').delegate('.sso-login-facebook','click.fb',$.proxy(function(ev){ev.preventDefault();this.log('FBConnect clicked');FB.login($.proxy(this.loginCallback,this),{scope:'publish_stream,email'});},this));},loginCallback:function(response){if(typeof response==='object'&&response.status){this.log(response);switch(response.status){case'connected':this.log('FB.login successful');$.nirvana.postJson('FacebookSignupController','index',$.proxy(this.checkAccountCallback,this));break;case'unknown':break;}}},checkAccountCallback:function(resp){if(resp.loggedIn){var loginCallback=this.callbacks['login-success']||'';if(loginCallback&&typeof loginCallback==='function'){loginCallback();}else{var form=new UserLoginFacebookForm();form.reloadPage();}}
else{$.showCustomModal(resp.title,resp.modal,{id:'FacebookSignUp',width:710,buttons:[{id:'FacebookSignUpCancel',message:resp.cancelMsg,handler:$.proxy(function(){this.modal.closeModal();},this)}],callback:$.proxy(this.showSignupModal,this)});}},showSignupModal:function(modal){this.modal=modal;var loginCallback=this.callbacks['login-success']||'';this.form=new UserLoginFacebookForm(this.modal,{ajaxLogin:true,callback:function(res){if(loginCallback&&typeof loginCallback==='function'){loginCallback();}else if(res.location){window.location.href=res.location;}}});this.wikiaForm=this.form.wikiaForm;this.modal.find('.FacebookSignupConfigHeader').bind('click',function(ev){ev.preventDefault();$(this).toggleClass('on').next('form').toggle();});this.signupAjaxForm=new UserSignupAjaxForm(this.wikiaForm,['username','password'],this.form.el.find('input[type=submit]'));this.wikiaForm.el.find('input[name=username], input[name=password]').bind('blur.UserLoginFacebook',$.proxy(this.signupAjaxForm.validateInput,this.signupAjaxForm));$.getResources([$.getSassCommonURL('extensions/wikia/UserLogin/css/UserLoginFacebook.scss')]);},closeSignupModal:function(){if(this.modal){this.modal.closeModal();}}};;var UserLoginFacebookForm=$.createClass(UserLoginAjaxForm,{init:function(){UserLoginFacebookForm.superclass.init.call(this);var feedForm=this.form.parent().children('.FacebookSignupConfig');this.feedCheckboxes=feedForm.find('input[type="checkbox"]');},getFeedOptions:function(){var ret=[],feedName,feedOptions=this.feedCheckboxes.serializeArray();for(var i=0,len=feedOptions.length;i<len;i++){feedName=feedOptions[i].name.split('-').pop();ret.push(feedName);}
return ret;},retrieveLoginToken:function(){},ajaxLogin:function(){$.nirvana.postJson('FacebookSignupController','signup',{username:this.inputs.username.val(),password:this.inputs.password.val(),signupToken:this.inputs.logintoken.val(),fbfeedoptions:this.getFeedOptions().join(',')},$.proxy(this.submitLoginHandler,this));}});;